root@DEVELOPER15:/home/elmo/opendnssec_test_engine# sh autotestODS.sh
FILE  : /home/elmo/Downloads/ODS_Test_folder/Run3_04042011/ODS1.2_SIT_CONF.xls
COUNT : 11
AUTHOR: Calc
- Argument: /home/elmo/Downloads/ODS_Test_folder/Run3_04042011/ODS1.2_SIT_CONF.xls
- Argument: ODSC
SHEET: ODSC
---------

2011-04-05 17:09:40.380 00014 Comment: Fill in date of test execution in the field below (format ddmmyy)


2011-04-05 17:09:40.381 00015 Comment: 280311


2011-04-05 17:09:40.381 00017 Comment: Users & ODS versions


2011-04-05 17:09:40.381 00018 Comment: Check if user opendnssec exists on unix. (part of group opendnssec)


2011-04-05 17:09:40.381 00019 Comment: Check if user kaspuser (with password abc123) exists on unix. 


2011-04-05 17:09:40.381 00020 Comment: Check if user gooduser (with password 123abc) exists on unix. 


2011-04-05 17:09:40.381 00021 Comment: Check if the correct ODS version is installed.


2011-04-05 17:09:40.381 00022 Comment: If user is not avaliable you can add them via the command (as root):
- useradd <user>
and then add the correct password via the command.
- passwd <user>


2011-04-05 17:09:40.382 00024 Comment: Copy all the files needed for this script to the directories below


2011-04-05 17:09:40.382 00025 Comment: BEWARE: For all files created in WinOS, use the fromdos application (apt-get install tofromdos) to remove symbols from the xml files (like conf and kasp) to prevent errors.


2011-04-05 17:09:40.382 00026 Comment: Standard folder for all the conf.xml files is /home/ods/ods_testautomation/ods_sit_conf/conf


2011-04-05 17:09:40.382 00027 Comment: Standard folder for all the kasp.xml files is /home/ods/ods_testautomation/ods_sit_conf/kasp


2011-04-05 17:09:40.382 00028 Comment: Standard folder for all the zonelist.xml files is /home/ods/ods_testautomation/ods_sit_conf/zonelist


2011-04-05 17:09:40.382 00029 Comment: Standard folder for all the MySQL files is /home/ods/ods_testautomation/ods_sit_conf/mysql


2011-04-05 17:09:40.383 00030 Comment: Standard folder for all the script files is /home/ods/ods_testautomation/ods_sit_conf/script


2011-04-05 17:09:40.383 00032 Comment: Logfiles


2011-04-05 17:09:40.383 00033 Comment: Make sure that the following folder exists: /home/ods/ods_testautomation/ods_sit_conf/logging


2011-04-05 17:09:40.383 00035 Comment: Specify Download folder for ODS


2011-04-05 17:09:40.383 00036 Comment: /home/elmo/Downloads/opendnssec-1.2.1


2011-04-05 17:09:40.383 00038 Comment: Specific folders


2011-04-05 17:09:40.384 00039 Comment: Make sure that the next folder exists: "var/opendnssec/temporary"


2011-04-05 17:09:40.384 00041 Comment: MySQL settings


2011-04-05 17:09:40.384 00042 Comment: Standard MySQL database name = KASP


2011-04-05 17:09:40.384 00043 Comment: Standard MySQL username = kaspuser


2011-04-05 17:09:40.384 00044 Comment: Standard MySQL password = abc123


2011-04-05 17:09:40.384 00045 Comment: Second MySQL database = KASPTEST


2011-04-05 17:09:40.384 00046 Comment: Second MySQL username = kaspuser


2011-04-05 17:09:40.385 00047 Comment: Second MySQL password = abc123


2011-04-05 17:09:40.385 00048 Comment: Thirth MySQL database = KASPTEST2


2011-04-05 17:09:40.385 00049 Comment: Thirth MySQL username = gooduser


2011-04-05 17:09:40.385 00050 Comment: Thirth MySQL password = 123abc


2011-04-05 17:09:40.385 00051 Comment: If the databases above are not available they can be created via the command:
- mysql -p
- create database <databasename>


2011-04-05 17:09:40.385 00052 Comment: After this the users should be granted for using the database using the following 2 commands:
- grant usage on <databasename>.* to <user>@localhost identified by '<password of user>'
- grant all privileges on <databasename>.* to <user>@localhost identified by '<password of user>'


2011-04-05 17:09:40.386 00054 Comment: Zone file


2011-04-05 17:09:40.386 00055 Comment: Make sure that the zone with name "ods" is available in the test environment in folder /var/opendnssec/unsigned


2011-04-05 17:09:40.386 00057 Comment: Host file


2011-04-05 17:09:40.386 00058 Comment: Make sure that the following line is in the host file in the "/etc" folder:
127.0.0.1 mysqltest


2011-04-05 17:09:40.386 00061 Comment: Make sure that the "ods-notify"-script is in the /home/ods/ods-testautomation/ods_sit_conf/scripts folder


2011-04-05 17:09:40.386 00064 Comment: Check if the application "logger" is available on the test environment (location: /usr/bin/). The logger will put the result of a command, for example "ods-kaspcheck", in the messages logfile (location: /var/log/messages). Example of usage: "command | /usr/bin/logger"

Testcondition - ODSCC10: The configuration of repositories located in conf.xml should operate according to requirements and intentions
-------------------------------------------------------------------------------

-------------------------------------------------------------------------------
Testcase - ODSCC10T10: Configure and sign with one repository (SoftHSM)

2011-04-05 17:09:40.387 00069 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:09:40.387 Requirement: ODSCC10

2011-04-05 17:09:40.387 00071 Stop()
2011-04-05 17:09:40.387 Requirement: ODSCC10
2011-04-05 17:09:40.387 RunCommand(ods-control stop)
2011-04-05 17:09:41.397 - runCommand: Process started, PID: 3070
2011-04-05 17:09:41.397 OUTPUT:	Stopping enforcer...
2011-04-05 17:09:41.397 OUTPUT:	Stopping signer engine..
2011-04-05 17:09:41.397 OUTPUT:	Engine shut down.
2011-04-05 17:09:41.397 RunCommand(ps -e | grep enforcer)
2011-04-05 17:09:41.413 - runCommand: Process started, PID: 3077
2011-04-05 17:09:41.414 ERROR:	return code = 1
2011-04-05 17:09:41.414 RunCommand(ps -e | grep signer)
2011-04-05 17:09:41.430 - runCommand: Process started, PID: 3080
2011-04-05 17:09:41.430 ERROR:	return code = 1

2011-04-05 17:09:41.430 00073 Wait(3)

2011-04-05 17:09:41.431 Requirement: ODSCC10

2011-04-05 17:09:44.431 00075 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:09:44.431 Requirement: ODSCC10

2011-04-05 17:09:44.431 00077 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:09:44.431 Requirement: ODSCC10
2011-04-05 17:09:44.431 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:09:44.437 - runCommand: Process started, PID: 3084

2011-04-05 17:09:44.438 00079 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:09:44.438 Requirement: ODSCC10
2011-04-05 17:09:44.438 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:09:44.442 - runCommand: Process started, PID: 3086

2011-04-05 17:09:44.442 00081 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:09:44.443 Requirement: ODSCC10

2011-04-05 17:09:44.443 00084 PurgeHSM()
2011-04-05 17:09:44.443 Requirement: ODSCC10
2011-04-05 17:09:44.443 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:09:45.221 - runCommand: Process started, PID: 3088
2011-04-05 17:09:45.221 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:09:45.221 OUTPUT:	4 keys found.
2011-04-05 17:09:45.221 OUTPUT:	
2011-04-05 17:09:45.221 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:09:45.221 OUTPUT:	Starting purge...
2011-04-05 17:09:45.221 OUTPUT:	Key remove successful: d089093bd323c786d320fb76708df7c8
2011-04-05 17:09:45.221 OUTPUT:	Key remove successful: 6ef67d320c383afd228c4ff583cfcf8e
2011-04-05 17:09:45.221 OUTPUT:	Key remove successful: b5e40e2c9c9bddeb084565d01f159f0a
2011-04-05 17:09:45.221 OUTPUT:	Key remove successful: 7cdd3a85ee7373a4ff4eb8a902d4fbd8
2011-04-05 17:09:45.221 OUTPUT:	Purge done.

2011-04-05 17:09:45.222 00086 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:09:45.222 Requirement: ODSCC10

2011-04-05 17:09:45.222 00089 LoadConfig()
2011-04-05 17:09:45.222 Requirement: ODSCC10
2011-04-05 17:09:45.222 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T10_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:09:45.236 - runCommand: Process started, PID: 3093

2011-04-05 17:09:45.236 00092 LoadConfig()
2011-04-05 17:09:45.236 Requirement: ODSCC10
2011-04-05 17:09:45.236 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:09:45.240 - runCommand: Process started, PID: 3094

2011-04-05 17:09:45.241 00094 Comment: Setup of ODS database

2011-04-05 17:09:45.241 Requirement: ODSCC10

2011-04-05 17:09:45.241 00096 ODSSetup()
2011-04-05 17:09:45.241 Requirement: ODSCC10
2011-04-05 17:09:45.241 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:09:58.732 - runCommand: Process started, PID: 3095
2011-04-05 17:09:58.733 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:09:58.734 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:09:58.734 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:09:58.734 OUTPUT:	Repository SoftHSM found
2011-04-05 17:09:58.734 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:09:58.734 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:09:58.735 OUTPUT:	Policy default2 found
2011-04-05 17:09:58.735 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:09:58.735 OUTPUT:	Policy default found
2011-04-05 17:09:58.735 OUTPUT:	Zone ods found
2011-04-05 17:09:58.735 OUTPUT:	Policy set to default.
2011-04-05 17:09:58.735 OUTPUT:	Added zone ods to database
2011-04-05 17:09:58.735 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:09:58.736 OUTPUT:	Policy set to default.
2011-04-05 17:09:58.736 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:09:58.736 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:09:58.736 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:09:58.736 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:09:58.740 00098 Wait(5)

2011-04-05 17:09:58.740 Requirement: ODSCC10

2011-04-05 17:10:03.745 00100 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:10:03.745 Requirement: ODSCC10

2011-04-05 17:10:03.749 00102 Start()
2011-04-05 17:10:03.749 Requirement: ODSCC10
2011-04-05 17:10:03.749 RunCommand(ods-control start)
2011-04-05 17:10:03.769 - runCommand: Background process started, PID: 3116
2011-04-05 17:10:03.101 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:10:03.114 - runCommand: Process started, PID: 3129
2011-04-05 17:10:03.114 OUTPUT:	ods-enforcerd
2011-04-05 17:10:03.114 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:10:03.129 - runCommand: Process started, PID: 3134
2011-04-05 17:10:03.129 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:10:03.129 00104 Wait(5)

2011-04-05 17:10:03.129 Requirement: ODSCC10

2011-04-05 17:10:08.129 00106 Comment: Sign the ods zone with the new configs.

2011-04-05 17:10:08.130 Requirement: ODSCC10

2011-04-05 17:10:08.130 00110 Wait(5)

2011-04-05 17:10:08.130 Requirement: ODSCC10

2011-04-05 17:10:13.130 00112 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:10:13.130 Requirement: ODSCC10

2011-04-05 17:10:13.132 00114 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:10:13.132 Requirement: ODSCC10

2011-04-05 17:10:13.132 00116 Stop()
2011-04-05 17:10:13.132 Requirement: ODSCC10
2011-04-05 17:10:13.132 RunCommand(ods-control stop)
2011-04-05 17:10:14.143 - runCommand: Process started, PID: 3185
2011-04-05 17:10:14.143 OUTPUT:	Stopping enforcer...
2011-04-05 17:10:14.143 OUTPUT:	Stopping signer engine..
2011-04-05 17:10:14.143 OUTPUT:	Engine shut down.
2011-04-05 17:10:14.143 RunCommand(ps -e | grep enforcer)
2011-04-05 17:10:14.159 - runCommand: Process started, PID: 3191
2011-04-05 17:10:14.159 ERROR:	return code = 1
2011-04-05 17:10:14.159 RunCommand(ps -e | grep signer)
2011-04-05 17:10:14.172 - runCommand: Process started, PID: 3194
2011-04-05 17:10:14.172 ERROR:	return code = 1

2011-04-05 17:10:14.173 00119 CheckLog()
2011-04-05 17:10:14.173 Requirement: ODSCC10
2011-04-05 17:10:15.740 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:09:40 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0

-------------------------------------------------------------------------------
Testcase - ODSCC10T20: Configure 4 repositories (2x SoftHSM, 2x hardware HSM) and sign using 2 of these different repositories

2011-04-05 17:10:15.740 00127 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:10:15.740 Requirement: ODSCC10

2011-04-05 17:10:15.741 00129 Stop()
2011-04-05 17:10:15.741 Requirement: ODSCC10
2011-04-05 17:10:15.741 RunCommand(ods-control stop)
2011-04-05 17:10:15.745 - runCommand: Process started, PID: 3197
2011-04-05 17:10:15.745 OUTPUT:	Stopping enforcer...
2011-04-05 17:10:15.745 OUTPUT:	Cannot find PID file
2011-04-05 17:10:15.745 OUTPUT:	Stopping signer engine..
2011-04-05 17:10:15.745 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:10:15.745 ERROR:	return code = 1
2011-04-05 17:10:15.745 RunCommand(ps -e | grep enforcer)
2011-04-05 17:10:15.755 - runCommand: Process started, PID: 3200
2011-04-05 17:10:15.755 ERROR:	return code = 1
2011-04-05 17:10:15.755 RunCommand(ps -e | grep signer)
2011-04-05 17:10:15.765 - runCommand: Process started, PID: 3203
2011-04-05 17:10:15.765 ERROR:	return code = 1

2011-04-05 17:10:15.765 00131 Wait(10)

2011-04-05 17:10:15.765 Requirement: ODSCC10

2011-04-05 17:10:25.765 00133 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:10:25.765 Requirement: ODSCC10

2011-04-05 17:10:25.766 00135 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:10:25.766 Requirement: ODSCC10
2011-04-05 17:10:25.766 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:10:25.772 - runCommand: Process started, PID: 3206

2011-04-05 17:10:25.772 00137 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:10:25.772 Requirement: ODSCC10
2011-04-05 17:10:25.772 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:10:25.775 - runCommand: Process started, PID: 3208

2011-04-05 17:10:25.775 00139 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:10:25.775 Requirement: ODSCC10

2011-04-05 17:10:25.776 00142 PurgeHSM()
2011-04-05 17:10:25.776 Requirement: ODSCC10
2011-04-05 17:10:25.776 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:10:26.433 - runCommand: Process started, PID: 3210
2011-04-05 17:10:26.433 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:10:26.433 OUTPUT:	4 keys found.
2011-04-05 17:10:26.433 OUTPUT:	
2011-04-05 17:10:26.433 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:10:26.433 OUTPUT:	Starting purge...
2011-04-05 17:10:26.433 OUTPUT:	Key remove successful: 38caebdaac68067bc9d9ff90fc6cf3e2
2011-04-05 17:10:26.433 OUTPUT:	Key remove successful: c7f30257ca9fd243b5f308e439b73bf4
2011-04-05 17:10:26.434 OUTPUT:	Key remove successful: b8b7439b93ef0b89550b048ec993fc40
2011-04-05 17:10:26.434 OUTPUT:	Key remove successful: 5e24e37ccf379dc43b775a007ec5825c
2011-04-05 17:10:26.434 OUTPUT:	Purge done.

2011-04-05 17:10:26.434 00144 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:10:26.434 Requirement: ODSCC10

2011-04-05 17:10:26.434 00147 LoadConfig()
2011-04-05 17:10:26.434 Requirement: ODSCC10
2011-04-05 17:10:26.434 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T20_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:10:26.449 - runCommand: Process started, PID: 3215

2011-04-05 17:10:26.450 00150 LoadConfig()
2011-04-05 17:10:26.450 Requirement: ODSCC10
2011-04-05 17:10:26.450 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:10:26.454 - runCommand: Process started, PID: 3216

2011-04-05 17:10:26.454 00152 Comment: Update all the configs.

2011-04-05 17:10:26.454 Requirement: ODSCC10

2011-04-05 17:10:26.454 00154 ODSSetup()
2011-04-05 17:10:26.454 Requirement: ODSCC10
2011-04-05 17:10:26.454 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:10:38.303 - runCommand: Process started, PID: 3217
2011-04-05 17:10:38.303 OUTPUT:	ERROR: Module /usr/lib/libCryptoki2_64.so in Repository HSM-HA cannot be found
2011-04-05 17:10:38.303 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:10:38.303 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:10:38.303 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:10:38.303 OUTPUT:	Repository SoftHSM found
2011-04-05 17:10:38.303 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:10:38.303 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:10:38.303 OUTPUT:	Repository SoftHSM2 found
2011-04-05 17:10:38.303 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:10:38.303 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:10:38.303 OUTPUT:	Repository HSM-HA found
2011-04-05 17:10:38.303 OUTPUT:	Capacity set to 35.
2011-04-05 17:10:38.303 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:10:38.303 OUTPUT:	Policy default2 found
2011-04-05 17:10:38.303 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:10:38.303 OUTPUT:	Policy default found
2011-04-05 17:10:38.303 OUTPUT:	Zone ods found
2011-04-05 17:10:38.303 OUTPUT:	Policy set to default.
2011-04-05 17:10:38.303 OUTPUT:	Added zone ods to database
2011-04-05 17:10:38.303 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:10:38.303 OUTPUT:	Policy set to default.
2011-04-05 17:10:38.303 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:10:38.303 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:10:38.303 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:10:38.303 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:10:38.304 00156 Wait(10)

2011-04-05 17:10:38.304 Requirement: ODSCC10

2011-04-05 17:10:48.304 00158 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:10:48.304 Requirement: ODSCC10

2011-04-05 17:10:48.304 00160 Start()
2011-04-05 17:10:48.304 Requirement: ODSCC10
2011-04-05 17:10:48.304 RunCommand(ods-control start)
2011-04-05 17:10:48.306 - runCommand: Background process started, PID: 3230
2011-04-05 17:10:53.340 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:10:53.359 - runCommand: Process started, PID: 3255
2011-04-05 17:10:53.359 ERROR:	return code = 1
2011-04-05 17:10:53.359 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:10:53.374 - runCommand: Process started, PID: 3260

2011-04-05 17:10:53.374 00162 Comment: Sign the ods zone with the new configs.

2011-04-05 17:10:53.374 Requirement: ODSCC10

2011-04-05 17:10:53.374 00166 Wait(15)

2011-04-05 17:10:53.374 Requirement: ODSCC10

2011-04-05 17:11:08.375 00168 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:11:08.375 Requirement: ODSCC10

2011-04-05 17:11:08.375 00170 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:11:08.375 Requirement: ODSCC10

2011-04-05 17:11:08.376 00172 Stop()
2011-04-05 17:11:08.376 Requirement: ODSCC10
2011-04-05 17:11:08.376 RunCommand(ods-control stop)
2011-04-05 17:11:08.382 - runCommand: Process started, PID: 3265
2011-04-05 17:11:08.382 OUTPUT:	Stopping enforcer...
2011-04-05 17:11:08.382 OUTPUT:	Cannot find PID file
2011-04-05 17:11:08.382 OUTPUT:	Stopping signer engine..
2011-04-05 17:11:08.382 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:11:08.382 ERROR:	return code = 1
2011-04-05 17:11:08.382 RunCommand(ps -e | grep enforcer)
2011-04-05 17:11:08.400 - runCommand: Process started, PID: 3268
2011-04-05 17:11:08.400 ERROR:	return code = 1
2011-04-05 17:11:08.400 RunCommand(ps -e | grep signer)
2011-04-05 17:11:08.416 - runCommand: Process started, PID: 3271
2011-04-05 17:11:08.416 ERROR:	return code = 1

2011-04-05 17:11:08.416 00175 CheckLog()
2011-04-05 17:11:08.416 Requirement: ODSCC10
2011-04-05 17:11:09.983 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:10:13 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0

-------------------------------------------------------------------------------
Testcase - ODSCC10T30: Configure no module location and expect failure

2011-04-05 17:11:09.983 00182 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:11:09.983 Requirement: ODSCC10

2011-04-05 17:11:09.984 00184 Stop()
2011-04-05 17:11:09.984 Requirement: ODSCC10
2011-04-05 17:11:09.984 RunCommand(ods-control stop)
2011-04-05 17:11:09.988 - runCommand: Process started, PID: 3274
2011-04-05 17:11:09.988 OUTPUT:	Stopping enforcer...
2011-04-05 17:11:09.988 OUTPUT:	Cannot find PID file
2011-04-05 17:11:09.988 OUTPUT:	Stopping signer engine..
2011-04-05 17:11:09.988 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:11:09.988 ERROR:	return code = 1
2011-04-05 17:11:09.988 RunCommand(ps -e | grep enforcer)
2011-04-05 17:11:09.998 - runCommand: Process started, PID: 3277
2011-04-05 17:11:09.998 ERROR:	return code = 1
2011-04-05 17:11:09.998 RunCommand(ps -e | grep signer)
2011-04-05 17:11:10.883 - runCommand: Process started, PID: 3280
2011-04-05 17:11:10.889 ERROR:	return code = 1

2011-04-05 17:11:10.912 00186 Wait(10)

2011-04-05 17:11:10.914 Requirement: ODSCC10

2011-04-05 17:11:20.958 00188 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:11:20.963 Requirement: ODSCC10

2011-04-05 17:11:20.998 00190 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:11:20.100 Requirement: ODSCC10
2011-04-05 17:11:20.100 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:11:20.156 - runCommand: Process started, PID: 3283
2011-04-05 17:11:20.157 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:11:20.158 ERROR:	return code = 1

2011-04-05 17:11:20.162 00192 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:11:20.162 Requirement: ODSCC10
2011-04-05 17:11:20.162 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:11:20.211 - runCommand: Process started, PID: 3285
2011-04-05 17:11:20.211 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:11:20.212 ERROR:	return code = 1

2011-04-05 17:11:20.216 00194 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:11:20.216 Requirement: ODSCC10

2011-04-05 17:11:20.220 00197 PurgeHSM()
2011-04-05 17:11:20.220 Requirement: ODSCC10
2011-04-05 17:11:20.220 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:11:20.416 - runCommand: Process started, PID: 3287
2011-04-05 17:11:20.417 ERROR:	hsm_session_init(): Incorrect PIN for repository SoftHSM2
2011-04-05 17:11:20.417 ERROR:	return code = 255

2011-04-05 17:11:20.421 00199 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:11:20.421 Requirement: ODSCC10

2011-04-05 17:11:20.425 00202 LoadConfig()
2011-04-05 17:11:20.425 Requirement: ODSCC10
2011-04-05 17:11:20.425 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T30_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:11:20.474 - runCommand: Process started, PID: 3291

2011-04-05 17:11:20.479 00205 LoadConfig()
2011-04-05 17:11:20.479 Requirement: ODSCC10
2011-04-05 17:11:20.479 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:11:20.518 - runCommand: Process started, PID: 3292

2011-04-05 17:11:20.523 00207 Comment: Update all the configs.

2011-04-05 17:11:20.523 Requirement: ODSCC10

2011-04-05 17:11:20.526 00209 ODSSetup()
2011-04-05 17:11:20.527 Requirement: ODSCC10
2011-04-05 17:11:20.527 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:11:31.400 - runCommand: Process started, PID: 3293
2011-04-05 17:11:31.400 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:11:31.400 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:11:31.400 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:11:31.400 OUTPUT:	Repository SoftHSM found
2011-04-05 17:11:31.400 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:11:31.400 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:11:31.400 OUTPUT:	Policy default2 found
2011-04-05 17:11:31.400 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:11:31.400 OUTPUT:	Policy default found
2011-04-05 17:11:31.400 OUTPUT:	Zone ods found
2011-04-05 17:11:31.400 OUTPUT:	Policy set to default.
2011-04-05 17:11:31.400 OUTPUT:	Added zone ods to database
2011-04-05 17:11:31.400 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:11:31.400 OUTPUT:	Policy set to default.
2011-04-05 17:11:31.400 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:11:31.400 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:11:31.400 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:11:31.400 ERROR:	/usr/local/lib/opendnssec/kasp_checker.rb:222:in `check_config_file': undefined method `+' for nil:NilClass (NoMethodError)
2011-04-05 17:11:31.400 ERROR:		from /usr/lib/ruby/1.8/rexml/element.rb:892:in `each'
2011-04-05 17:11:31.400 ERROR:		from /usr/lib/ruby/1.8/rexml/xpath.rb:53:in `each'
2011-04-05 17:11:31.400 ERROR:		from /usr/lib/ruby/1.8/rexml/element.rb:892:in `each'
2011-04-05 17:11:31.400 ERROR:		from /usr/local/lib/opendnssec/kasp_checker.rb:214:in `check_config_file'
2011-04-05 17:11:31.401 ERROR:		from /usr/local/lib/opendnssec/kasp_checker.rb:146:in `open'
2011-04-05 17:11:31.401 ERROR:		from /usr/local/lib/opendnssec/kasp_checker.rb:146:in `check_config_file'
2011-04-05 17:11:31.401 ERROR:		from /usr/local/lib/opendnssec/kasp_checker.rb:55:in `check'
2011-04-05 17:11:31.401 ERROR:		from /usr/local/bin/ods-kaspcheck:110
2011-04-05 17:11:31.401 ERROR:	Couldn't run kaspcheck, will carry on

2011-04-05 17:11:31.401 00211 Wait(10)

2011-04-05 17:11:31.401 Requirement: ODSCC10

2011-04-05 17:11:41.401 00213 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:11:41.402 Requirement: ODSCC10

2011-04-05 17:11:41.402 00215 Start()
2011-04-05 17:11:41.402 Requirement: ODSCC10
2011-04-05 17:11:41.402 RunCommand(ods-control start)
2011-04-05 17:11:41.404 - runCommand: Background process started, PID: 3304
2011-04-05 17:11:46.437 ERROR:	return code = 1
2011-04-05 17:11:46.437 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:11:46.455 - runCommand: Process started, PID: 3325
2011-04-05 17:11:46.455 ERROR:	return code = 1
2011-04-05 17:11:46.455 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:11:46.475 - runCommand: Process started, PID: 3329

2011-04-05 17:11:46.475 00217 Comment: Sign the ods zone with the new configs.

2011-04-05 17:11:46.475 Requirement: ODSCC10

2011-04-05 17:11:46.476 00221 Wait(15)

2011-04-05 17:11:46.476 Requirement: ODSCC10

2011-04-05 17:12:01.476 00223 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:12:01.476 Requirement: ODSCC10

2011-04-05 17:12:01.476 00225 Stop()
2011-04-05 17:12:01.477 Requirement: ODSCC10
2011-04-05 17:12:01.477 RunCommand(ods-control stop)
2011-04-05 17:12:01.483 - runCommand: Process started, PID: 3334
2011-04-05 17:12:01.483 OUTPUT:	Stopping enforcer...
2011-04-05 17:12:01.483 OUTPUT:	Cannot find PID file
2011-04-05 17:12:01.483 OUTPUT:	Stopping signer engine..
2011-04-05 17:12:01.483 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:12:01.483 ERROR:	return code = 1
2011-04-05 17:12:01.483 RunCommand(ps -e | grep enforcer)
2011-04-05 17:12:01.499 - runCommand: Process started, PID: 3337
2011-04-05 17:12:01.499 ERROR:	return code = 1
2011-04-05 17:12:01.499 RunCommand(ps -e | grep signer)
2011-04-05 17:12:01.517 - runCommand: Process started, PID: 3340
2011-04-05 17:12:01.517 ERROR:	return code = 1

2011-04-05 17:12:01.517 00228 Comment: Check if the signing was unsuccesfull. If a "aborting operation" is in the logging, the signing was unsuccesful.

2011-04-05 17:12:01.517 Requirement: ODSCC10

2011-04-05 17:12:01.518 00231 CheckLog()
2011-04-05 17:12:01.518 Requirement: ODSCC10

-------------------------------------------------------------------------------
Testcase - ODSCC10T40: Configure Incorrect module location and expect failure

2011-04-05 17:12:03.947 00237 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:12:03.947 Requirement: ODSCC10

2011-04-05 17:12:03.950 00239 Stop()
2011-04-05 17:12:03.950 Requirement: ODSCC10
2011-04-05 17:12:03.950 RunCommand(ods-control stop)
2011-04-05 17:12:03.991 - runCommand: Process started, PID: 3343
2011-04-05 17:12:03.991 OUTPUT:	Stopping enforcer...
2011-04-05 17:12:03.991 OUTPUT:	Cannot find PID file
2011-04-05 17:12:03.991 OUTPUT:	Stopping signer engine..
2011-04-05 17:12:03.991 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:12:03.992 ERROR:	return code = 1
2011-04-05 17:12:03.992 RunCommand(ps -e | grep enforcer)
2011-04-05 17:12:03.108 - runCommand: Process started, PID: 3346
2011-04-05 17:12:03.108 ERROR:	return code = 1
2011-04-05 17:12:03.108 RunCommand(ps -e | grep signer)
2011-04-05 17:12:03.119 - runCommand: Process started, PID: 3349
2011-04-05 17:12:03.119 ERROR:	return code = 1

2011-04-05 17:12:03.119 00241 Wait(10)

2011-04-05 17:12:03.119 Requirement: ODSCC10

2011-04-05 17:12:13.120 00243 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:12:13.120 Requirement: ODSCC10

2011-04-05 17:12:13.120 00245 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:12:13.120 Requirement: ODSCC10
2011-04-05 17:12:13.120 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:12:13.126 - runCommand: Process started, PID: 3352
2011-04-05 17:12:13.126 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:12:13.126 ERROR:	return code = 1

2011-04-05 17:12:13.126 00247 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:12:13.126 Requirement: ODSCC10
2011-04-05 17:12:13.126 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:12:13.131 - runCommand: Process started, PID: 3354
2011-04-05 17:12:13.131 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:12:13.131 ERROR:	return code = 1

2011-04-05 17:12:13.131 00249 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:12:13.131 Requirement: ODSCC10

2011-04-05 17:12:13.132 00252 PurgeHSM()
2011-04-05 17:12:13.132 Requirement: ODSCC10
2011-04-05 17:12:13.132 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:12:13.139 - runCommand: Process started, PID: 3356
2011-04-05 17:12:13.139 ERROR:	hsm_session_init(): PKCS#11 module load failed: 
2011-04-05 17:12:13.139 ERROR:	return code = 255

2011-04-05 17:12:13.139 00254 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:12:13.139 Requirement: ODSCC10

2011-04-05 17:12:13.140 00257 LoadConfig()
2011-04-05 17:12:13.140 Requirement: ODSCC10
2011-04-05 17:12:13.140 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T40_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:12:13.153 - runCommand: Process started, PID: 3359

2011-04-05 17:12:13.153 00260 LoadConfig()
2011-04-05 17:12:13.153 Requirement: ODSCC10
2011-04-05 17:12:13.153 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:12:13.158 - runCommand: Process started, PID: 3360

2011-04-05 17:12:13.158 00262 Comment: Update all the configs.

2011-04-05 17:12:13.158 Requirement: ODSCC10

2011-04-05 17:12:13.158 00264 ODSSetup()
2011-04-05 17:12:13.158 Requirement: ODSCC10
2011-04-05 17:12:13.158 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:12:24.881 - runCommand: Process started, PID: 3361
2011-04-05 17:12:24.881 OUTPUT:	ERROR: Module /usr/libsofthsm.so in Repository SoftHSM cannot be found
2011-04-05 17:12:24.882 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:12:24.882 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:12:24.882 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:12:24.882 OUTPUT:	Repository SoftHSM found
2011-04-05 17:12:24.882 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:12:24.882 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:12:24.882 OUTPUT:	Policy default2 found
2011-04-05 17:12:24.882 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:12:24.882 OUTPUT:	Policy default found
2011-04-05 17:12:24.882 OUTPUT:	Zone ods found
2011-04-05 17:12:24.882 OUTPUT:	Policy set to default.
2011-04-05 17:12:24.882 OUTPUT:	Added zone ods to database
2011-04-05 17:12:24.882 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:12:24.882 OUTPUT:	Policy set to default.
2011-04-05 17:12:24.882 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:12:24.882 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:12:24.882 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:12:24.882 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:12:24.882 00266 Wait(10)

2011-04-05 17:12:24.882 Requirement: ODSCC10

2011-04-05 17:12:34.883 00268 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:12:34.883 Requirement: ODSCC10

2011-04-05 17:12:34.883 00270 Start()
2011-04-05 17:12:34.883 Requirement: ODSCC10
2011-04-05 17:12:34.883 RunCommand(ods-control start)
2011-04-05 17:12:34.885 - runCommand: Background process started, PID: 3374
2011-04-05 17:12:39.918 ERROR:	return code = 1
2011-04-05 17:12:39.918 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:12:39.935 - runCommand: Process started, PID: 3395
2011-04-05 17:12:39.935 ERROR:	return code = 1
2011-04-05 17:12:39.935 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:12:39.952 - runCommand: Process started, PID: 3399

2011-04-05 17:12:39.953 00272 Comment: Sign the ods zone with the new configs.

2011-04-05 17:12:39.953 Requirement: ODSCC10

2011-04-05 17:12:39.953 00276 Wait(15)

2011-04-05 17:12:39.953 Requirement: ODSCC10

2011-04-05 17:12:54.953 00278 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:12:54.953 Requirement: ODSCC10

2011-04-05 17:12:54.954 00280 Stop()
2011-04-05 17:12:54.954 Requirement: ODSCC10
2011-04-05 17:12:54.954 RunCommand(ods-control stop)
2011-04-05 17:12:54.960 - runCommand: Process started, PID: 3404
2011-04-05 17:12:54.960 OUTPUT:	Stopping enforcer...
2011-04-05 17:12:54.960 OUTPUT:	Cannot find PID file
2011-04-05 17:12:54.960 OUTPUT:	Stopping signer engine..
2011-04-05 17:12:54.960 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:12:54.960 ERROR:	return code = 1
2011-04-05 17:12:54.960 RunCommand(ps -e | grep enforcer)
2011-04-05 17:12:54.977 - runCommand: Process started, PID: 3407
2011-04-05 17:12:54.977 ERROR:	return code = 1
2011-04-05 17:12:54.977 RunCommand(ps -e | grep signer)
2011-04-05 17:12:54.993 - runCommand: Process started, PID: 3410
2011-04-05 17:12:54.993 ERROR:	return code = 1

2011-04-05 17:12:54.993 00283 Comment: Check if the signing was unsuccesfull. If a "aborting operation" is in the logging, the signing was unsuccesful. No SoftHSM has been found.

2011-04-05 17:12:54.993 Requirement: ODSCC10

2011-04-05 17:12:54.994 00286 CheckLog()
2011-04-05 17:12:54.994 Requirement: ODSCC10
2011-04-05 17:12:56.566 FAILED:	(Check for Like) - Expected: SoftHSM: C_DestroyObject: An object has been destroyed Found: 

-------------------------------------------------------------------------------
Testcase - ODSCC10T50: Use a Tokenlabel with 1 character

2011-04-05 17:12:56.566 00292 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:12:56.566 Requirement: ODSCC10

2011-04-05 17:12:56.567 00294 Stop()
2011-04-05 17:12:56.567 Requirement: ODSCC10
2011-04-05 17:12:56.567 RunCommand(ods-control stop)
2011-04-05 17:12:56.571 - runCommand: Process started, PID: 3413
2011-04-05 17:12:56.571 OUTPUT:	Stopping enforcer...
2011-04-05 17:12:56.571 OUTPUT:	Cannot find PID file
2011-04-05 17:12:56.571 OUTPUT:	Stopping signer engine..
2011-04-05 17:12:56.571 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:12:56.571 ERROR:	return code = 1
2011-04-05 17:12:56.571 RunCommand(ps -e | grep enforcer)
2011-04-05 17:12:56.581 - runCommand: Process started, PID: 3416
2011-04-05 17:12:56.581 ERROR:	return code = 1
2011-04-05 17:12:56.581 RunCommand(ps -e | grep signer)
2011-04-05 17:12:56.591 - runCommand: Process started, PID: 3419
2011-04-05 17:12:56.591 ERROR:	return code = 1

2011-04-05 17:12:56.591 00296 Wait(10)

2011-04-05 17:12:56.591 Requirement: ODSCC10

2011-04-05 17:13:06.592 00298 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:13:06.592 Requirement: ODSCC10

2011-04-05 17:13:06.592 00300 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:13:06.592 Requirement: ODSCC10
2011-04-05 17:13:06.592 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:13:06.598 - runCommand: Process started, PID: 3422
2011-04-05 17:13:06.598 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:13:06.598 ERROR:	return code = 1

2011-04-05 17:13:06.598 00302 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:13:06.598 Requirement: ODSCC10
2011-04-05 17:13:06.598 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:13:06.603 - runCommand: Process started, PID: 3424
2011-04-05 17:13:06.603 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:13:06.603 ERROR:	return code = 1

2011-04-05 17:13:06.603 00304 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:13:06.604 Requirement: ODSCC10

2011-04-05 17:13:06.604 00307 PurgeHSM()
2011-04-05 17:13:06.604 Requirement: ODSCC10
2011-04-05 17:13:06.604 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:13:06.611 - runCommand: Process started, PID: 3426
2011-04-05 17:13:06.611 ERROR:	hsm_session_init(): PKCS#11 module load failed: /usr/libsofthsm.so
2011-04-05 17:13:06.611 ERROR:	return code = 255

2011-04-05 17:13:06.611 00309 Comment: Change the tokenlabel of slot1  to "S"

2011-04-05 17:13:06.611 Requirement: ODSCC10

2011-04-05 17:13:06.612 00311 InitRepo()
2011-04-05 17:13:06.612 Requirement: ODSCC10
2011-04-05 17:13:06.612 RunCommand(softhsm --init-token --slot  --label softhsm --init-token --slot 1 --label S --so-pin 4321 --pin 4321 --so-pin  --pin )
2011-04-05 17:13:06.634 - runCommand: Process started, PID: 3429
2011-04-05 17:13:06.634 ERROR:	Error: The given SO PIN does not match the one in the token.

2011-04-05 17:13:06.635 00313 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:13:06.635 Requirement: ODSCC10

2011-04-05 17:13:06.635 00316 LoadConfig()
2011-04-05 17:13:06.635 Requirement: ODSCC10
2011-04-05 17:13:06.635 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T50_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:13:06.651 - runCommand: Process started, PID: 3431

2011-04-05 17:13:06.651 00319 LoadConfig()
2011-04-05 17:13:06.651 Requirement: ODSCC10
2011-04-05 17:13:06.651 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:13:06.655 - runCommand: Process started, PID: 3432

2011-04-05 17:13:06.656 00321 Comment: Update all the configs.

2011-04-05 17:13:06.656 Requirement: ODSCC10

2011-04-05 17:13:06.656 00323 ODSSetup()
2011-04-05 17:13:06.656 Requirement: ODSCC10
2011-04-05 17:13:06.656 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:13:18.612 - runCommand: Process started, PID: 3433
2011-04-05 17:13:18.612 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:13:18.612 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:13:18.612 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:13:18.612 OUTPUT:	Repository SoftHSM found
2011-04-05 17:13:18.612 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:13:18.612 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:13:18.612 OUTPUT:	Repository SoftHSM2 found
2011-04-05 17:13:18.612 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:13:18.612 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:13:18.612 OUTPUT:	Policy default2 found
2011-04-05 17:13:18.612 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:13:18.613 OUTPUT:	Policy default found
2011-04-05 17:13:18.613 OUTPUT:	Zone ods found
2011-04-05 17:13:18.613 OUTPUT:	Policy set to default.
2011-04-05 17:13:18.613 OUTPUT:	Added zone ods to database
2011-04-05 17:13:18.613 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:13:18.613 OUTPUT:	Policy set to default.
2011-04-05 17:13:18.613 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:13:18.613 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:13:18.613 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:13:18.613 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:13:18.613 00325 Wait(10)

2011-04-05 17:13:18.613 Requirement: ODSCC10

2011-04-05 17:13:28.614 00327 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:13:28.614 Requirement: ODSCC10

2011-04-05 17:13:28.614 00329 Start()
2011-04-05 17:13:28.614 Requirement: ODSCC10
2011-04-05 17:13:28.614 RunCommand(ods-control start)
2011-04-05 17:13:28.616 - runCommand: Background process started, PID: 3446
2011-04-05 17:13:33.649 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:13:33.665 - runCommand: Process started, PID: 3469
2011-04-05 17:13:33.665 ERROR:	return code = 1
2011-04-05 17:13:33.665 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:13:33.680 - runCommand: Process started, PID: 3474

2011-04-05 17:13:33.681 00331 Wait(10)

2011-04-05 17:13:33.681 Requirement: ODSCC10

2011-04-05 17:13:43.681 00333 Comment: Sign the ods zone with the new configs.

2011-04-05 17:13:43.681 Requirement: ODSCC10

2011-04-05 17:13:43.681 00337 Wait(15)

2011-04-05 17:13:43.681 Requirement: ODSCC10

2011-04-05 17:13:58.682 00339 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:13:58.682 Requirement: ODSCC10

2011-04-05 17:13:58.682 00341 Stop()
2011-04-05 17:13:58.682 Requirement: ODSCC10
2011-04-05 17:13:58.682 RunCommand(ods-control stop)
2011-04-05 17:13:58.688 - runCommand: Process started, PID: 3479
2011-04-05 17:13:58.688 OUTPUT:	Stopping enforcer...
2011-04-05 17:13:58.688 OUTPUT:	Cannot find PID file
2011-04-05 17:13:58.688 OUTPUT:	Stopping signer engine..
2011-04-05 17:13:58.688 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:13:58.688 ERROR:	return code = 1
2011-04-05 17:13:58.688 RunCommand(ps -e | grep enforcer)
2011-04-05 17:13:58.705 - runCommand: Process started, PID: 3482
2011-04-05 17:13:58.705 ERROR:	return code = 1
2011-04-05 17:13:58.705 RunCommand(ps -e | grep signer)
2011-04-05 17:13:58.722 - runCommand: Process started, PID: 3485
2011-04-05 17:13:58.722 ERROR:	return code = 1

2011-04-05 17:13:58.722 00343 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:13:58.722 Requirement: ODSCC10

2011-04-05 17:13:58.723 00346 CheckLog()
2011-04-05 17:13:58.723 Requirement: ODSCC10
2011-04-05 17:14:00.297 FAILED:	(Check for Like) - Expected: all done! Found: 

2011-04-05 17:14:00.297 00348 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:14:00.297 Requirement: ODSCC10

2011-04-05 17:14:00.297 00350 Stop()
2011-04-05 17:14:00.297 Requirement: ODSCC10
2011-04-05 17:14:00.297 RunCommand(ods-control stop)
2011-04-05 17:14:00.301 - runCommand: Process started, PID: 3488
2011-04-05 17:14:00.301 OUTPUT:	Stopping enforcer...
2011-04-05 17:14:00.301 OUTPUT:	Cannot find PID file
2011-04-05 17:14:00.301 OUTPUT:	Stopping signer engine..
2011-04-05 17:14:00.301 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:14:00.301 ERROR:	return code = 1
2011-04-05 17:14:00.301 RunCommand(ps -e | grep enforcer)
2011-04-05 17:14:00.311 - runCommand: Process started, PID: 3491
2011-04-05 17:14:00.311 ERROR:	return code = 1
2011-04-05 17:14:00.311 RunCommand(ps -e | grep signer)
2011-04-05 17:14:00.322 - runCommand: Process started, PID: 3494
2011-04-05 17:14:00.322 ERROR:	return code = 1

2011-04-05 17:14:00.322 00352 Wait(10)

2011-04-05 17:14:00.322 Requirement: ODSCC10

2011-04-05 17:14:10.323 00354 Comment: Change the token to the previous label.

2011-04-05 17:14:10.323 Requirement: ODSCC10

2011-04-05 17:14:10.323 00356 InitRepo()
2011-04-05 17:14:10.323 Requirement: ODSCC10
2011-04-05 17:14:10.323 RunCommand(softhsm --init-token --slot  --label softhsm --init-token --slot 1 --label OpenDNSSEC2 --so-pin 4321 --pin 4321 --so-pin  --pin )
2011-04-05 17:14:10.334 - runCommand: Process started, PID: 3497
2011-04-05 17:14:10.334 ERROR:	Error: The given SO PIN does not match the one in the token.

2011-04-05 17:14:10.334 00358 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:14:10.334 Requirement: ODSCC10

-------------------------------------------------------------------------------
Testcase - ODSCC10T60: Use a Tokenlabel with 32 characters

2011-04-05 17:14:10.335 00368 Comment: According to ODS, tokenlabel should be max 32 characters.

2011-04-05 17:14:10.335 Requirement: ODSCC10

2011-04-05 17:14:10.335 00370 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:14:10.335 Requirement: ODSCC10

2011-04-05 17:14:10.336 00372 Stop()
2011-04-05 17:14:10.336 Requirement: ODSCC10
2011-04-05 17:14:10.336 RunCommand(ods-control stop)
2011-04-05 17:14:10.345 - runCommand: Process started, PID: 3499
2011-04-05 17:14:10.345 OUTPUT:	Stopping enforcer...
2011-04-05 17:14:10.345 OUTPUT:	Cannot find PID file
2011-04-05 17:14:10.345 OUTPUT:	Stopping signer engine..
2011-04-05 17:14:10.345 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:14:10.345 ERROR:	return code = 1
2011-04-05 17:14:10.345 RunCommand(ps -e | grep enforcer)
2011-04-05 17:14:10.361 - runCommand: Process started, PID: 3502
2011-04-05 17:14:10.361 ERROR:	return code = 1
2011-04-05 17:14:10.361 RunCommand(ps -e | grep signer)
2011-04-05 17:14:10.377 - runCommand: Process started, PID: 3505
2011-04-05 17:14:10.377 ERROR:	return code = 1

2011-04-05 17:14:10.377 00374 Wait(10)

2011-04-05 17:14:10.377 Requirement: ODSCC10

2011-04-05 17:14:20.378 00376 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:14:20.378 Requirement: ODSCC10

2011-04-05 17:14:20.378 00378 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:14:20.378 Requirement: ODSCC10
2011-04-05 17:14:20.378 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:14:20.384 - runCommand: Process started, PID: 3508
2011-04-05 17:14:20.384 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:14:20.384 ERROR:	return code = 1

2011-04-05 17:14:20.384 00380 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:14:20.384 Requirement: ODSCC10
2011-04-05 17:14:20.384 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:14:20.389 - runCommand: Process started, PID: 3510
2011-04-05 17:14:20.389 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:14:20.389 ERROR:	return code = 1

2011-04-05 17:14:20.389 00382 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:14:20.389 Requirement: ODSCC10

2011-04-05 17:14:20.390 00385 PurgeHSM()
2011-04-05 17:14:20.390 Requirement: ODSCC10
2011-04-05 17:14:20.390 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:14:20.401 - runCommand: Process started, PID: 3512
2011-04-05 17:14:20.401 ERROR:	hsm_get_slot_id(): could not find token with the name S
2011-04-05 17:14:20.401 ERROR:	return code = 255

2011-04-05 17:14:20.401 00388 Comment: Change the tokenlabel of slot1  to "SoftHSM123SoftHSM123SoftHSM123So"
(32 characters)

2011-04-05 17:14:20.401 Requirement: ODSCC10

2011-04-05 17:14:20.402 00390 InitRepo()
2011-04-05 17:14:20.402 Requirement: ODSCC10
2011-04-05 17:14:20.402 RunCommand(softhsm --init-token --slot  --label softhsm --init-token --slot 1 --label SoftHSM123SoftHSM123SoftHSM123So --so-pin 4321 --pin 4321 --so-pin  --pin )
2011-04-05 17:14:20.408 - runCommand: Process started, PID: 3516
2011-04-05 17:14:20.408 ERROR:	Error: The given SO PIN does not match the one in the token.

2011-04-05 17:14:20.408 00392 Wait(10)

2011-04-05 17:14:20.408 Requirement: ODSCC10

2011-04-05 17:14:30.409 00394 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:14:30.409 Requirement: ODSCC10

2011-04-05 17:14:30.409 00397 LoadConfig()
2011-04-05 17:14:30.409 Requirement: ODSCC10
2011-04-05 17:14:30.409 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T60_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:14:30.424 - runCommand: Process started, PID: 3518

2011-04-05 17:14:30.425 00400 LoadConfig()
2011-04-05 17:14:30.425 Requirement: ODSCC10
2011-04-05 17:14:30.425 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:14:30.429 - runCommand: Process started, PID: 3519

2011-04-05 17:14:30.429 00402 Comment: Update all the configs.

2011-04-05 17:14:30.429 Requirement: ODSCC10

2011-04-05 17:14:30.430 00404 ODSSetup()
2011-04-05 17:14:30.430 Requirement: ODSCC10
2011-04-05 17:14:30.430 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:14:42.202 - runCommand: Process started, PID: 3520
2011-04-05 17:14:42.202 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:14:42.202 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:14:42.203 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:14:42.203 OUTPUT:	Repository SoftHSM found
2011-04-05 17:14:42.203 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:14:42.203 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:14:42.203 OUTPUT:	Repository SoftHSM2 found
2011-04-05 17:14:42.203 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:14:42.203 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:14:42.203 OUTPUT:	Policy default2 found
2011-04-05 17:14:42.203 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:14:42.203 OUTPUT:	Policy default found
2011-04-05 17:14:42.203 OUTPUT:	Zone ods found
2011-04-05 17:14:42.203 OUTPUT:	Policy set to default.
2011-04-05 17:14:42.203 OUTPUT:	Added zone ods to database
2011-04-05 17:14:42.203 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:14:42.203 OUTPUT:	Policy set to default.
2011-04-05 17:14:42.203 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:14:42.203 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:14:42.203 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:14:42.203 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:14:42.203 00406 Wait(10)

2011-04-05 17:14:42.203 Requirement: ODSCC10

2011-04-05 17:14:52.204 00408 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:14:52.204 Requirement: ODSCC10

2011-04-05 17:14:52.204 00410 Start()
2011-04-05 17:14:52.204 Requirement: ODSCC10
2011-04-05 17:14:52.204 RunCommand(ods-control start)
2011-04-05 17:14:52.206 - runCommand: Background process started, PID: 3533
2011-04-05 17:14:57.238 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:14:57.254 - runCommand: Process started, PID: 3557
2011-04-05 17:14:57.254 ERROR:	return code = 1
2011-04-05 17:14:57.254 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:14:57.270 - runCommand: Process started, PID: 3562

2011-04-05 17:14:57.270 00412 Comment: Sign the ods zone with the new configs.

2011-04-05 17:14:57.270 Requirement: ODSCC10

2011-04-05 17:14:57.270 00416 Wait(15)

2011-04-05 17:14:57.270 Requirement: ODSCC10

2011-04-05 17:15:12.271 00419 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:15:12.271 Requirement: ODSCC10

2011-04-05 17:15:12.271 00421 Stop()
2011-04-05 17:15:12.271 Requirement: ODSCC10
2011-04-05 17:15:12.271 RunCommand(ods-control stop)
2011-04-05 17:15:12.277 - runCommand: Process started, PID: 3567
2011-04-05 17:15:12.277 OUTPUT:	Stopping enforcer...
2011-04-05 17:15:12.277 OUTPUT:	Cannot find PID file
2011-04-05 17:15:12.277 OUTPUT:	Stopping signer engine..
2011-04-05 17:15:12.277 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:15:12.277 ERROR:	return code = 1
2011-04-05 17:15:12.277 RunCommand(ps -e | grep enforcer)
2011-04-05 17:15:12.296 - runCommand: Process started, PID: 3570
2011-04-05 17:15:12.296 ERROR:	return code = 1
2011-04-05 17:15:12.296 RunCommand(ps -e | grep signer)
2011-04-05 17:15:12.311 - runCommand: Process started, PID: 3573
2011-04-05 17:15:12.311 ERROR:	return code = 1

2011-04-05 17:15:12.312 00424 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:15:12.312 Requirement: ODSCC10

2011-04-05 17:15:12.312 00428 CheckLog()
2011-04-05 17:15:12.312 Requirement: ODSCC10
2011-04-05 17:15:13.884 FAILED:	(Check for Like) - Expected: all done! Found: 

2011-04-05 17:15:13.884 00432 Wait(10)

2011-04-05 17:15:13.884 Requirement: ODSCC10

2011-04-05 17:15:23.885 00434 Stop()
2011-04-05 17:15:23.885 Requirement: ODSCC10
2011-04-05 17:15:23.885 RunCommand(ods-control stop)
2011-04-05 17:15:23.891 - runCommand: Process started, PID: 3576
2011-04-05 17:15:23.891 OUTPUT:	Stopping enforcer...
2011-04-05 17:15:23.891 OUTPUT:	Cannot find PID file
2011-04-05 17:15:23.891 OUTPUT:	Stopping signer engine..
2011-04-05 17:15:23.891 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:15:23.891 ERROR:	return code = 1
2011-04-05 17:15:23.891 RunCommand(ps -e | grep enforcer)
2011-04-05 17:15:23.907 - runCommand: Process started, PID: 3579
2011-04-05 17:15:23.907 ERROR:	return code = 1
2011-04-05 17:15:23.907 RunCommand(ps -e | grep signer)
2011-04-05 17:15:23.925 - runCommand: Process started, PID: 3582
2011-04-05 17:15:23.925 ERROR:	return code = 1

2011-04-05 17:15:23.925 00436 Comment: Change the token to the previous label.

2011-04-05 17:15:23.925 Requirement: ODSCC10

2011-04-05 17:15:23.925 00438 InitRepo()
2011-04-05 17:15:23.925 Requirement: ODSCC10
2011-04-05 17:15:23.925 RunCommand(softhsm --init-token --slot  --label softhsm --init-token --slot 1 --label OpenDNSSEC2 --so-pin 4321 --pin 4321 --so-pin  --pin )
2011-04-05 17:15:23.931 - runCommand: Process started, PID: 3585
2011-04-05 17:15:23.931 ERROR:	Error: The given SO PIN does not match the one in the token.

2011-04-05 17:15:23.932 00440 Wait(5)

2011-04-05 17:15:23.932 Requirement: ODSCC10

2011-04-05 17:15:28.932 00442 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:15:28.932 Requirement: ODSCC10

-------------------------------------------------------------------------------
Testcase - ODSCC10T70: Configure no PIN while PIN is needed

2011-04-05 17:15:28.933 00448 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:15:28.933 Requirement: ODSCC10

2011-04-05 17:15:28.933 00450 Stop()
2011-04-05 17:15:28.933 Requirement: ODSCC10
2011-04-05 17:15:28.933 RunCommand(ods-control stop)
2011-04-05 17:15:28.940 - runCommand: Process started, PID: 3587
2011-04-05 17:15:28.940 OUTPUT:	Stopping enforcer...
2011-04-05 17:15:28.940 OUTPUT:	Cannot find PID file
2011-04-05 17:15:28.940 OUTPUT:	Stopping signer engine..
2011-04-05 17:15:28.940 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:15:28.940 ERROR:	return code = 1
2011-04-05 17:15:28.940 RunCommand(ps -e | grep enforcer)
2011-04-05 17:15:28.960 - runCommand: Process started, PID: 3590
2011-04-05 17:15:28.960 ERROR:	return code = 1
2011-04-05 17:15:28.960 RunCommand(ps -e | grep signer)
2011-04-05 17:15:28.976 - runCommand: Process started, PID: 3593
2011-04-05 17:15:28.976 ERROR:	return code = 1

2011-04-05 17:15:28.976 00452 Wait(10)

2011-04-05 17:15:28.976 Requirement: ODSCC10

2011-04-05 17:15:38.977 00454 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:15:38.977 Requirement: ODSCC10

2011-04-05 17:15:38.977 00456 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:15:38.977 Requirement: ODSCC10
2011-04-05 17:15:38.977 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:15:38.983 - runCommand: Process started, PID: 3596
2011-04-05 17:15:38.983 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:15:38.983 ERROR:	return code = 1

2011-04-05 17:15:38.983 00458 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:15:38.983 Requirement: ODSCC10
2011-04-05 17:15:38.983 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:15:38.987 - runCommand: Process started, PID: 3598
2011-04-05 17:15:38.987 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:15:38.987 ERROR:	return code = 1

2011-04-05 17:15:38.987 00460 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:15:38.987 Requirement: ODSCC10

2011-04-05 17:15:38.987 00463 PurgeHSM()
2011-04-05 17:15:38.987 Requirement: ODSCC10
2011-04-05 17:15:38.987 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:15:38.996 - runCommand: Process started, PID: 3600
2011-04-05 17:15:38.996 ERROR:	hsm_get_slot_id(): could not find token with the name 
2011-04-05 17:15:38.996 ERROR:	SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM123SoftHSM
2011-04-05 17:15:38.996 ERROR:	return code = 255

2011-04-05 17:15:38.996 00465 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:15:38.996 Requirement: ODSCC10

2011-04-05 17:15:38.997 00468 LoadConfig()
2011-04-05 17:15:38.997 Requirement: ODSCC10
2011-04-05 17:15:38.997 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T70_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:15:39.147 - runCommand: Process started, PID: 3604

2011-04-05 17:15:39.152 00471 LoadConfig()
2011-04-05 17:15:39.152 Requirement: ODSCC10
2011-04-05 17:15:39.152 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:15:39.193 - runCommand: Process started, PID: 3605

2011-04-05 17:15:39.198 00473 Comment: Update all the configs.

2011-04-05 17:15:39.198 Requirement: ODSCC10

2011-04-05 17:15:39.202 00475 ODSSetup()
2011-04-05 17:15:39.202 Requirement: ODSCC10
2011-04-05 17:15:39.202 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:15:50.968 - runCommand: Process started, PID: 3606
2011-04-05 17:15:50.968 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:15:50.968 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:15:50.968 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:15:50.968 OUTPUT:	Repository SoftHSM found
2011-04-05 17:15:50.968 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:15:50.968 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:15:50.968 OUTPUT:	Policy default2 found
2011-04-05 17:15:50.968 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:15:50.968 OUTPUT:	Policy default found
2011-04-05 17:15:50.968 OUTPUT:	Zone ods found
2011-04-05 17:15:50.968 OUTPUT:	Policy set to default.
2011-04-05 17:15:50.968 OUTPUT:	Added zone ods to database
2011-04-05 17:15:50.968 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:15:50.968 OUTPUT:	Policy set to default.
2011-04-05 17:15:50.968 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:15:50.968 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:15:50.968 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:15:50.968 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:15:50.968 00477 Wait(10)

2011-04-05 17:15:50.968 Requirement: ODSCC10

2011-04-05 17:16:00.969 00479 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:16:00.969 Requirement: ODSCC10

2011-04-05 17:16:00.969 00481 Start()
2011-04-05 17:16:00.969 Requirement: ODSCC10
2011-04-05 17:16:00.969 RunCommand(ods-control start)
2011-04-05 17:16:00.971 - runCommand: Background process started, PID: 3619
2011-04-05 17:16:06.560 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:16:06.231 - runCommand: Process started, PID: 3643
2011-04-05 17:16:06.232 ERROR:	return code = 1
2011-04-05 17:16:06.232 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:16:06.413 - runCommand: Process started, PID: 3648

2011-04-05 17:16:06.416 00483 Comment: Sign the ods zone with the new configs.

2011-04-05 17:16:06.416 Requirement: ODSCC10

2011-04-05 17:16:06.418 00487 Wait(15)

2011-04-05 17:16:06.418 Requirement: ODSCC10

2011-04-05 17:16:21.423 00489 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:16:21.423 Requirement: ODSCC10

2011-04-05 17:16:21.427 00491 Stop()
2011-04-05 17:16:21.427 Requirement: ODSCC10
2011-04-05 17:16:21.427 RunCommand(ods-control stop)
2011-04-05 17:16:21.488 - runCommand: Process started, PID: 3653
2011-04-05 17:16:21.489 OUTPUT:	Stopping enforcer...
2011-04-05 17:16:21.489 OUTPUT:	Cannot find PID file
2011-04-05 17:16:21.489 OUTPUT:	Stopping signer engine..
2011-04-05 17:16:21.489 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:16:21.490 ERROR:	return code = 1
2011-04-05 17:16:21.490 RunCommand(ps -e | grep enforcer)
2011-04-05 17:16:21.650 - runCommand: Process started, PID: 3656
2011-04-05 17:16:21.651 ERROR:	return code = 1
2011-04-05 17:16:21.651 RunCommand(ps -e | grep signer)
2011-04-05 17:16:21.824 - runCommand: Process started, PID: 3659
2011-04-05 17:16:21.824 ERROR:	return code = 1

2011-04-05 17:16:21.828 00493 Comment: Check if the signing was unsuccesfull. If a "aborting operation" is in the logging, the signing was unsuccesful. 

2011-04-05 17:16:21.829 Requirement: ODSCC10

2011-04-05 17:16:21.832 00496 CheckLog()
2011-04-05 17:16:21.832 Requirement: ODSCC10
2011-04-05 17:16:22.653 FAILED:	(Check for Like) - Expected: Aborting operation Found: 

-------------------------------------------------------------------------------
Testcase - ODSCC10T80: Configure an Incorrect PIN and run signing

2011-04-05 17:16:22.654 00501 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:16:22.654 Requirement: ODSCC10

2011-04-05 17:16:22.654 00503 Stop()
2011-04-05 17:16:22.654 Requirement: ODSCC10
2011-04-05 17:16:22.654 RunCommand(ods-control stop)
2011-04-05 17:16:22.658 - runCommand: Process started, PID: 3662
2011-04-05 17:16:22.658 OUTPUT:	Stopping enforcer...
2011-04-05 17:16:22.658 OUTPUT:	Cannot find PID file
2011-04-05 17:16:22.658 OUTPUT:	Stopping signer engine..
2011-04-05 17:16:22.658 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:16:22.658 ERROR:	return code = 1
2011-04-05 17:16:22.658 RunCommand(ps -e | grep enforcer)
2011-04-05 17:16:22.668 - runCommand: Process started, PID: 3665
2011-04-05 17:16:22.668 ERROR:	return code = 1
2011-04-05 17:16:22.668 RunCommand(ps -e | grep signer)
2011-04-05 17:16:22.679 - runCommand: Process started, PID: 3668
2011-04-05 17:16:22.679 ERROR:	return code = 1

2011-04-05 17:16:22.679 00505 Wait(10)

2011-04-05 17:16:22.679 Requirement: ODSCC10

2011-04-05 17:16:32.680 00507 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:16:32.680 Requirement: ODSCC10

2011-04-05 17:16:32.680 00509 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:16:32.680 Requirement: ODSCC10
2011-04-05 17:16:32.680 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:16:32.686 - runCommand: Process started, PID: 3671
2011-04-05 17:16:32.686 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:16:32.686 ERROR:	return code = 1

2011-04-05 17:16:32.686 00511 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:16:32.686 Requirement: ODSCC10
2011-04-05 17:16:32.686 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:16:32.691 - runCommand: Process started, PID: 3673
2011-04-05 17:16:32.691 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:16:32.691 ERROR:	return code = 1

2011-04-05 17:16:32.691 00513 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:16:32.691 Requirement: ODSCC10

2011-04-05 17:16:32.692 00516 PurgeHSM()
2011-04-05 17:16:32.692 Requirement: ODSCC10
2011-04-05 17:16:32.692 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:16:32.708 - runCommand: Process started, PID: 3675
2011-04-05 17:16:32.708 ERROR:	hsm_session_init(): Incorrect PIN for repository SoftHSM
2011-04-05 17:16:32.708 ERROR:	return code = 255

2011-04-05 17:16:32.708 00518 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:16:32.708 Requirement: ODSCC10

2011-04-05 17:16:32.709 00521 LoadConfig()
2011-04-05 17:16:32.709 Requirement: ODSCC10
2011-04-05 17:16:32.709 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T80_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:16:32.720 - runCommand: Process started, PID: 3679

2011-04-05 17:16:32.721 00524 LoadConfig()
2011-04-05 17:16:32.721 Requirement: ODSCC10
2011-04-05 17:16:32.721 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:16:32.725 - runCommand: Process started, PID: 3680

2011-04-05 17:16:32.725 00526 Comment: Update all the configs.

2011-04-05 17:16:32.725 Requirement: ODSCC10

2011-04-05 17:16:32.725 00528 ODSSetup()
2011-04-05 17:16:32.725 Requirement: ODSCC10
2011-04-05 17:16:32.725 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:16:44.290 - runCommand: Process started, PID: 3681
2011-04-05 17:16:44.290 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:16:44.290 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:16:44.290 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:16:44.290 OUTPUT:	Repository SoftHSM found
2011-04-05 17:16:44.290 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:16:44.290 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:16:44.290 OUTPUT:	Policy default2 found
2011-04-05 17:16:44.290 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:16:44.291 OUTPUT:	Policy default found
2011-04-05 17:16:44.291 OUTPUT:	Zone ods found
2011-04-05 17:16:44.291 OUTPUT:	Policy set to default.
2011-04-05 17:16:44.291 OUTPUT:	Added zone ods to database
2011-04-05 17:16:44.291 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:16:44.291 OUTPUT:	Policy set to default.
2011-04-05 17:16:44.291 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:16:44.291 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:16:44.291 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:16:44.291 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:16:44.291 00530 Wait(10)

2011-04-05 17:16:44.291 Requirement: ODSCC10

2011-04-05 17:16:54.292 00532 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:16:54.292 Requirement: ODSCC10

2011-04-05 17:16:54.292 00534 Start()
2011-04-05 17:16:54.292 Requirement: ODSCC10
2011-04-05 17:16:54.292 RunCommand(ods-control start)
2011-04-05 17:16:54.294 - runCommand: Background process started, PID: 3694
2011-04-05 17:16:59.324 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:16:59.336 - runCommand: Process started, PID: 3717
2011-04-05 17:16:59.336 ERROR:	return code = 1
2011-04-05 17:16:59.336 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:16:59.352 - runCommand: Process started, PID: 3722

2011-04-05 17:16:59.352 00536 Comment: Sign the ods zone with the new configs.

2011-04-05 17:16:59.352 Requirement: ODSCC10

2011-04-05 17:16:59.352 00540 Wait(15)

2011-04-05 17:16:59.352 Requirement: ODSCC10

2011-04-05 17:17:14.353 00543 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:17:14.353 Requirement: ODSCC10

2011-04-05 17:17:14.353 00545 Stop()
2011-04-05 17:17:14.353 Requirement: ODSCC10
2011-04-05 17:17:14.353 RunCommand(ods-control stop)
2011-04-05 17:17:14.359 - runCommand: Process started, PID: 3730
2011-04-05 17:17:14.359 OUTPUT:	Stopping enforcer...
2011-04-05 17:17:14.359 OUTPUT:	Cannot find PID file
2011-04-05 17:17:14.359 OUTPUT:	Stopping signer engine..
2011-04-05 17:17:14.359 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:17:14.359 ERROR:	return code = 1
2011-04-05 17:17:14.359 RunCommand(ps -e | grep enforcer)
2011-04-05 17:17:14.375 - runCommand: Process started, PID: 3733
2011-04-05 17:17:14.375 ERROR:	return code = 1
2011-04-05 17:17:14.375 RunCommand(ps -e | grep signer)
2011-04-05 17:17:14.393 - runCommand: Process started, PID: 3736
2011-04-05 17:17:14.393 ERROR:	return code = 1

2011-04-05 17:17:14.394 00548 Comment: Check if the signing was unsuccesfull. If a "aborting operation" is in the logging, the signing was unsuccesful. 

2011-04-05 17:17:14.394 Requirement: ODSCC10

2011-04-05 17:17:14.394 00551 CheckLog()
2011-04-05 17:17:14.394 Requirement: ODSCC10

-------------------------------------------------------------------------------
Testcase - ODSCC10T90: Use correct PIN plus one additional character

2011-04-05 17:17:15.971 00556 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:17:15.971 Requirement: ODSCC10

2011-04-05 17:17:15.972 00558 Stop()
2011-04-05 17:17:15.972 Requirement: ODSCC10
2011-04-05 17:17:15.972 RunCommand(ods-control stop)
2011-04-05 17:17:15.976 - runCommand: Process started, PID: 3739
2011-04-05 17:17:15.976 OUTPUT:	Stopping enforcer...
2011-04-05 17:17:15.976 OUTPUT:	Cannot find PID file
2011-04-05 17:17:15.976 OUTPUT:	Stopping signer engine..
2011-04-05 17:17:15.976 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:17:15.976 ERROR:	return code = 1
2011-04-05 17:17:15.976 RunCommand(ps -e | grep enforcer)
2011-04-05 17:17:15.986 - runCommand: Process started, PID: 3742
2011-04-05 17:17:15.986 ERROR:	return code = 1
2011-04-05 17:17:15.986 RunCommand(ps -e | grep signer)
2011-04-05 17:17:15.996 - runCommand: Process started, PID: 3745
2011-04-05 17:17:15.996 ERROR:	return code = 1

2011-04-05 17:17:15.996 00560 Wait(10)

2011-04-05 17:17:15.996 Requirement: ODSCC10

2011-04-05 17:17:25.996 00562 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:17:25.996 Requirement: ODSCC10

2011-04-05 17:17:25.997 00564 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:17:25.997 Requirement: ODSCC10
2011-04-05 17:17:25.997 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:17:26.283 - runCommand: Process started, PID: 3748
2011-04-05 17:17:26.290 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:17:26.294 ERROR:	return code = 1

2011-04-05 17:17:26.332 00566 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:17:26.334 Requirement: ODSCC10
2011-04-05 17:17:26.336 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:17:26.808 - runCommand: Process started, PID: 3750
2011-04-05 17:17:26.814 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:17:26.817 ERROR:	return code = 1

2011-04-05 17:17:26.853 00568 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:17:26.855 Requirement: ODSCC10

2011-04-05 17:17:26.890 00571 PurgeHSM()
2011-04-05 17:17:26.892 Requirement: ODSCC10
2011-04-05 17:17:26.894 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:17:26.233 - runCommand: Process started, PID: 3752
2011-04-05 17:17:26.234 ERROR:	hsm_session_init(): Incorrect PIN for repository SoftHSM
2011-04-05 17:17:26.235 ERROR:	return code = 255

2011-04-05 17:17:26.238 00573 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:17:26.239 Requirement: ODSCC10

2011-04-05 17:17:26.242 00576 LoadConfig()
2011-04-05 17:17:26.242 Requirement: ODSCC10
2011-04-05 17:17:26.243 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T90_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:17:26.350 - runCommand: Process started, PID: 3756

2011-04-05 17:17:26.353 00579 LoadConfig()
2011-04-05 17:17:26.353 Requirement: ODSCC10
2011-04-05 17:17:26.353 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:17:26.378 - runCommand: Process started, PID: 3757

2011-04-05 17:17:26.380 00581 Comment: Update all the configs.

2011-04-05 17:17:26.381 Requirement: ODSCC10

2011-04-05 17:17:26.383 00583 ODSSetup()
2011-04-05 17:17:26.383 Requirement: ODSCC10
2011-04-05 17:17:26.383 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:17:37.805 - runCommand: Process started, PID: 3758
2011-04-05 17:17:37.805 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:17:37.805 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:17:37.805 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:17:37.805 OUTPUT:	Repository SoftHSM found
2011-04-05 17:17:37.805 OUTPUT:	No Maximum Capacity set.
2011-04-05 17:17:37.805 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:17:37.805 OUTPUT:	Policy default2 found
2011-04-05 17:17:37.805 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:17:37.805 OUTPUT:	Policy default found
2011-04-05 17:17:37.805 OUTPUT:	Zone ods found
2011-04-05 17:17:37.805 OUTPUT:	Policy set to default.
2011-04-05 17:17:37.805 OUTPUT:	Added zone ods to database
2011-04-05 17:17:37.805 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:17:37.805 OUTPUT:	Policy set to default.
2011-04-05 17:17:37.805 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:17:37.805 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:17:37.805 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:17:37.805 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:17:37.805 00585 Wait(10)

2011-04-05 17:17:37.805 Requirement: ODSCC10

2011-04-05 17:17:47.806 00587 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:17:47.806 Requirement: ODSCC10

2011-04-05 17:17:47.806 00589 Start()
2011-04-05 17:17:47.806 Requirement: ODSCC10
2011-04-05 17:17:47.806 RunCommand(ods-control start)
2011-04-05 17:17:47.808 - runCommand: Background process started, PID: 3771
2011-04-05 17:17:52.847 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:17:52.861 - runCommand: Process started, PID: 3795
2011-04-05 17:17:52.861 ERROR:	return code = 1
2011-04-05 17:17:52.861 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:17:52.877 - runCommand: Process started, PID: 3799

2011-04-05 17:17:52.877 00591 Comment: Sign the ods zone with the new configs.

2011-04-05 17:17:52.877 Requirement: ODSCC10

2011-04-05 17:17:52.877 00595 Wait(15)

2011-04-05 17:17:52.877 Requirement: ODSCC10

2011-04-05 17:18:07.878 00597 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:18:07.878 Requirement: ODSCC10

2011-04-05 17:18:07.878 00599 Stop()
2011-04-05 17:18:07.878 Requirement: ODSCC10
2011-04-05 17:18:07.878 RunCommand(ods-control stop)
2011-04-05 17:18:07.884 - runCommand: Process started, PID: 3804
2011-04-05 17:18:07.884 OUTPUT:	Stopping enforcer...
2011-04-05 17:18:07.884 OUTPUT:	Cannot find PID file
2011-04-05 17:18:07.884 OUTPUT:	Stopping signer engine..
2011-04-05 17:18:07.884 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:18:07.884 ERROR:	return code = 1
2011-04-05 17:18:07.884 RunCommand(ps -e | grep enforcer)
2011-04-05 17:18:07.901 - runCommand: Process started, PID: 3807
2011-04-05 17:18:07.901 ERROR:	return code = 1
2011-04-05 17:18:07.901 RunCommand(ps -e | grep signer)
2011-04-05 17:18:07.917 - runCommand: Process started, PID: 3810
2011-04-05 17:18:07.917 ERROR:	return code = 1

2011-04-05 17:18:07.917 00602 Comment: Check if the signing was unsuccesfull. If a "aborting operation" is in the logging, the signing was unsuccesful. 

2011-04-05 17:18:07.917 Requirement: ODSCC10

2011-04-05 17:18:07.918 00605 CheckLog()
2011-04-05 17:18:07.918 Requirement: ODSCC10

-------------------------------------------------------------------------------
Testcase - ODSCC10T100: Use a Repository Capacity of 0 and expect failure

2011-04-05 17:18:09.486 00612 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:18:09.486 Requirement: ODSCC10

2011-04-05 17:18:09.486 00614 Stop()
2011-04-05 17:18:09.486 Requirement: ODSCC10
2011-04-05 17:18:09.486 RunCommand(ods-control stop)
2011-04-05 17:18:09.490 - runCommand: Process started, PID: 3813
2011-04-05 17:18:09.490 OUTPUT:	Stopping enforcer...
2011-04-05 17:18:09.490 OUTPUT:	Cannot find PID file
2011-04-05 17:18:09.490 OUTPUT:	Stopping signer engine..
2011-04-05 17:18:09.490 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:18:09.490 ERROR:	return code = 1
2011-04-05 17:18:09.490 RunCommand(ps -e | grep enforcer)
2011-04-05 17:18:09.500 - runCommand: Process started, PID: 3816
2011-04-05 17:18:09.500 ERROR:	return code = 1
2011-04-05 17:18:09.500 RunCommand(ps -e | grep signer)
2011-04-05 17:18:09.510 - runCommand: Process started, PID: 3819
2011-04-05 17:18:09.510 ERROR:	return code = 1

2011-04-05 17:18:09.510 00616 Wait(10)

2011-04-05 17:18:09.510 Requirement: ODSCC10

2011-04-05 17:18:19.511 00618 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:18:19.511 Requirement: ODSCC10

2011-04-05 17:18:19.511 00620 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:18:19.511 Requirement: ODSCC10
2011-04-05 17:18:19.511 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:18:19.517 - runCommand: Process started, PID: 3822
2011-04-05 17:18:19.517 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:18:19.517 ERROR:	return code = 1

2011-04-05 17:18:19.517 00622 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:18:19.517 Requirement: ODSCC10
2011-04-05 17:18:19.517 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:18:19.522 - runCommand: Process started, PID: 3824
2011-04-05 17:18:19.522 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:18:19.522 ERROR:	return code = 1

2011-04-05 17:18:19.522 00624 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:18:19.523 Requirement: ODSCC10

2011-04-05 17:18:19.523 00627 PurgeHSM()
2011-04-05 17:18:19.523 Requirement: ODSCC10
2011-04-05 17:18:19.523 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:18:19.536 - runCommand: Process started, PID: 3826
2011-04-05 17:18:19.536 ERROR:	hsm_session_init(): Incorrect PIN for repository SoftHSM
2011-04-05 17:18:19.536 ERROR:	return code = 255

2011-04-05 17:18:19.537 00629 Wait(10)

2011-04-05 17:18:19.537 Requirement: ODSCC10

2011-04-05 17:18:29.537 00631 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:18:29.537 Requirement: ODSCC10

2011-04-05 17:18:29.538 00634 LoadConfig()
2011-04-05 17:18:29.538 Requirement: ODSCC10
2011-04-05 17:18:29.538 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T100_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:18:29.550 - runCommand: Process started, PID: 3830

2011-04-05 17:18:29.551 00637 LoadConfig()
2011-04-05 17:18:29.551 Requirement: ODSCC10
2011-04-05 17:18:29.551 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:18:29.555 - runCommand: Process started, PID: 3831

2011-04-05 17:18:29.556 00639 Comment: Update all the configs.

2011-04-05 17:18:29.556 Requirement: ODSCC10

2011-04-05 17:18:29.556 00641 ODSSetup()
2011-04-05 17:18:29.556 Requirement: ODSCC10
2011-04-05 17:18:29.556 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:18:29.562 - runCommand: Process started, PID: 3832
2011-04-05 17:18:29.562 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] Error validating file "/etc/opendnssec/conf.xml"
2011-04-05 17:18:29.562 ERROR:	/etc/opendnssec/conf.xml:10: element Capacity: Relax-NG validity error : Type positiveInteger doesn't allow value '0'
2011-04-05 17:18:29.562 ERROR:	/etc/opendnssec/conf.xml:10: element Capacity: Relax-NG validity error : Error validating datatype positiveInteger
2011-04-05 17:18:29.562 ERROR:	/etc/opendnssec/conf.xml:10: element Capacity: Relax-NG validity error : Element Capacity failed to validate content
2011-04-05 17:18:29.562 ERROR:	return code = 255

2011-04-05 17:18:29.563 00643 Wait(10)

2011-04-05 17:18:29.563 Requirement: ODSCC10

2011-04-05 17:18:39.563 00645 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:18:39.563 Requirement: ODSCC10

2011-04-05 17:18:39.564 00647 Start()
2011-04-05 17:18:39.564 Requirement: ODSCC10
2011-04-05 17:18:39.564 RunCommand(ods-control start)
2011-04-05 17:18:39.566 - runCommand: Background process started, PID: 3835
2011-04-05 17:18:49.609 ERROR:	return code = 1
2011-04-05 17:18:49.609 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:18:49.627 - runCommand: Process started, PID: 3863
2011-04-05 17:18:49.627 ERROR:	return code = 1
2011-04-05 17:18:49.627 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:18:49.640 - runCommand: Process started, PID: 3867

2011-04-05 17:18:49.641 00649 Comment: Sign the ods zone with the new configs.

2011-04-05 17:18:49.641 Requirement: ODSCC10

2011-04-05 17:18:49.641 00653 Wait(15)

2011-04-05 17:18:49.641 Requirement: ODSCC10

2011-04-05 17:19:04.641 00655 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:19:04.641 Requirement: ODSCC10

2011-04-05 17:19:04.642 00657 Stop()
2011-04-05 17:19:04.642 Requirement: ODSCC10
2011-04-05 17:19:04.642 RunCommand(ods-control stop)
2011-04-05 17:19:04.647 - runCommand: Process started, PID: 3872
2011-04-05 17:19:04.647 OUTPUT:	Stopping enforcer...
2011-04-05 17:19:04.647 OUTPUT:	Cannot find PID file
2011-04-05 17:19:04.647 OUTPUT:	Stopping signer engine..
2011-04-05 17:19:04.647 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:19:04.647 ERROR:	return code = 1
2011-04-05 17:19:04.647 RunCommand(ps -e | grep enforcer)
2011-04-05 17:19:04.666 - runCommand: Process started, PID: 3875
2011-04-05 17:19:04.667 ERROR:	return code = 1
2011-04-05 17:19:04.667 RunCommand(ps -e | grep signer)
2011-04-05 17:19:04.685 - runCommand: Process started, PID: 3878
2011-04-05 17:19:04.685 ERROR:	return code = 1

2011-04-05 17:19:04.686 00659 Comment: Check if the signing was unsuccesfull. If a "not enough keys" is in the logging, the signing was unsuccesful. Also check whether a signed zone is not present.

2011-04-05 17:19:04.686 Requirement: ODSCC10

2011-04-05 17:19:04.686 00662 CheckLog()
2011-04-05 17:19:04.686 Requirement: ODSCC10

2011-04-05 17:19:06.254 00664 ExecuteCommand(cd /var/opendnssec/signed)
2011-04-05 17:19:06.254 Requirement: ODSCC10
2011-04-05 17:19:06.254 RunCommand(cd /var/opendnssec/signed)
2011-04-05 17:19:06.258 - runCommand: Process started, PID: 3881
2011-04-05 17:19:06.258 ERROR:	open3: exec of cd /var/opendnssec/signed failed at ActionWords.pm line 227
2011-04-05 17:19:06.258 ERROR:	return code = 255

2011-04-05 17:19:06.258 00669 Comment: No signed zone should be present

2011-04-05 17:19:06.258 Requirement: ODSCC10

-------------------------------------------------------------------------------
Testcase - ODSCC10T110: Use a Repository Capacity of 1 and expect failure

2011-04-05 17:19:06.258 00673 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:19:06.258 Requirement: ODSCC10

2011-04-05 17:19:06.259 00675 Stop()
2011-04-05 17:19:06.259 Requirement: ODSCC10
2011-04-05 17:19:06.259 RunCommand(ods-control stop)
2011-04-05 17:19:06.262 - runCommand: Process started, PID: 3882
2011-04-05 17:19:06.262 OUTPUT:	Stopping enforcer...
2011-04-05 17:19:06.262 OUTPUT:	Cannot find PID file
2011-04-05 17:19:06.262 OUTPUT:	Stopping signer engine..
2011-04-05 17:19:06.262 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:19:06.262 ERROR:	return code = 1
2011-04-05 17:19:06.262 RunCommand(ps -e | grep enforcer)
2011-04-05 17:19:06.272 - runCommand: Process started, PID: 3885
2011-04-05 17:19:06.272 ERROR:	return code = 1
2011-04-05 17:19:06.272 RunCommand(ps -e | grep signer)
2011-04-05 17:19:06.282 - runCommand: Process started, PID: 3888
2011-04-05 17:19:06.282 ERROR:	return code = 1

2011-04-05 17:19:06.282 00677 Wait(10)

2011-04-05 17:19:06.282 Requirement: ODSCC10

2011-04-05 17:19:16.282 00679 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:19:16.282 Requirement: ODSCC10

2011-04-05 17:19:16.283 00681 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:19:16.283 Requirement: ODSCC10
2011-04-05 17:19:16.283 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:19:16.288 - runCommand: Process started, PID: 3891
2011-04-05 17:19:16.288 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:19:16.288 ERROR:	return code = 1

2011-04-05 17:19:16.289 00683 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:19:16.289 Requirement: ODSCC10
2011-04-05 17:19:16.289 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:19:16.293 - runCommand: Process started, PID: 3893
2011-04-05 17:19:16.293 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:19:16.293 ERROR:	return code = 1

2011-04-05 17:19:16.294 00685 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:19:16.294 Requirement: ODSCC10

2011-04-05 17:19:16.294 00688 PurgeHSM()
2011-04-05 17:19:16.294 Requirement: ODSCC10
2011-04-05 17:19:16.294 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:19:16.309 - runCommand: Process started, PID: 3895
2011-04-05 17:19:16.309 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:19:16.309 OUTPUT:	0 keys found.
2011-04-05 17:19:16.309 ERROR:	return code = 255

2011-04-05 17:19:16.309 00690 Wait(10)

2011-04-05 17:19:16.309 Requirement: ODSCC10

2011-04-05 17:19:26.310 00693 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:19:26.310 Requirement: ODSCC10

2011-04-05 17:19:26.310 00696 LoadConfig()
2011-04-05 17:19:26.310 Requirement: ODSCC10
2011-04-05 17:19:26.310 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T110_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:19:26.316 - runCommand: Process started, PID: 3899

2011-04-05 17:19:26.317 00699 LoadConfig()
2011-04-05 17:19:26.317 Requirement: ODSCC10
2011-04-05 17:19:26.317 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:19:26.321 - runCommand: Process started, PID: 3900

2011-04-05 17:19:26.321 00701 Comment: Update all the configs.

2011-04-05 17:19:26.321 Requirement: ODSCC10

2011-04-05 17:19:26.321 00703 ODSSetup()
2011-04-05 17:19:26.321 Requirement: ODSCC10
2011-04-05 17:19:26.321 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:19:37.876 - runCommand: Process started, PID: 3901
2011-04-05 17:19:37.876 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:19:37.876 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:19:37.876 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:19:37.876 OUTPUT:	Repository SoftHSM found
2011-04-05 17:19:37.876 OUTPUT:	Capacity set to 1.
2011-04-05 17:19:37.876 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:19:37.876 OUTPUT:	Policy default2 found
2011-04-05 17:19:37.876 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:19:37.876 OUTPUT:	Policy default found
2011-04-05 17:19:37.876 OUTPUT:	Zone ods found
2011-04-05 17:19:37.876 OUTPUT:	Policy set to default.
2011-04-05 17:19:37.876 OUTPUT:	Added zone ods to database
2011-04-05 17:19:37.876 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:19:37.876 OUTPUT:	Policy set to default.
2011-04-05 17:19:37.876 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:19:37.876 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:19:37.876 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:19:37.876 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:19:37.877 00705 Wait(10)

2011-04-05 17:19:37.877 Requirement: ODSCC10

2011-04-05 17:19:47.877 00707 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:19:47.877 Requirement: ODSCC10

2011-04-05 17:19:47.878 00709 Start()
2011-04-05 17:19:47.878 Requirement: ODSCC10
2011-04-05 17:19:47.878 RunCommand(ods-control start)
2011-04-05 17:19:47.880 - runCommand: Background process started, PID: 3914
2011-04-05 17:19:48.897 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:19:48.910 - runCommand: Process started, PID: 3930
2011-04-05 17:19:48.910 OUTPUT:	ods-enforcerd
2011-04-05 17:19:48.910 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:19:48.925 - runCommand: Process started, PID: 3935
2011-04-05 17:19:48.925 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:19:48.925 00711 Comment: Sign the ods zone with the new configs.

2011-04-05 17:19:48.925 Requirement: ODSCC10

2011-04-05 17:19:48.925 00715 Wait(15)

2011-04-05 17:19:48.925 Requirement: ODSCC10

2011-04-05 17:20:03.925 00717 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:20:03.926 Requirement: ODSCC10

2011-04-05 17:20:03.926 00719 Stop()
2011-04-05 17:20:03.926 Requirement: ODSCC10
2011-04-05 17:20:03.926 RunCommand(ods-control stop)
2011-04-05 17:20:04.935 - runCommand: Process started, PID: 3954
2011-04-05 17:20:04.935 OUTPUT:	Stopping enforcer...
2011-04-05 17:20:04.935 OUTPUT:	Stopping signer engine..
2011-04-05 17:20:04.935 OUTPUT:	Engine shut down.
2011-04-05 17:20:04.935 RunCommand(ps -e | grep enforcer)
2011-04-05 17:20:04.947 - runCommand: Process started, PID: 3960
2011-04-05 17:20:04.947 ERROR:	return code = 1
2011-04-05 17:20:04.947 RunCommand(ps -e | grep signer)
2011-04-05 17:20:04.957 - runCommand: Process started, PID: 3963
2011-04-05 17:20:04.958 ERROR:	return code = 1

2011-04-05 17:20:04.958 00721 Comment: Check if the signing was unsuccesfull. If a "aborting operation" is in the logging, the signing was unsuccesful. 

2011-04-05 17:20:04.958 Requirement: ODSCC10

2011-04-05 17:20:04.958 00724 CheckLog()
2011-04-05 17:20:04.958 Requirement: ODSCC10
2011-04-05 17:20:06.523 PASSED:	(Check for Like) - Expected: Not enough keys Found: Apr  5 17:19:49 DEVELOPER15 ods-enforcerd: Not enough keys to satisfy zsk policy for zone: ods

-------------------------------------------------------------------------------
Testcase - ODSCC10T120: Use a Repository Capacity of 4 and expect success

2011-04-05 17:20:06.524 00730 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:20:06.524 Requirement: ODSCC10

2011-04-05 17:20:06.524 00732 Stop()
2011-04-05 17:20:06.524 Requirement: ODSCC10
2011-04-05 17:20:06.524 RunCommand(ods-control stop)
2011-04-05 17:20:06.528 - runCommand: Process started, PID: 3966
2011-04-05 17:20:06.528 OUTPUT:	Stopping enforcer...
2011-04-05 17:20:06.528 OUTPUT:	Cannot find PID file
2011-04-05 17:20:06.528 OUTPUT:	Stopping signer engine..
2011-04-05 17:20:06.528 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:20:06.528 ERROR:	return code = 1
2011-04-05 17:20:06.528 RunCommand(ps -e | grep enforcer)
2011-04-05 17:20:06.538 - runCommand: Process started, PID: 3969
2011-04-05 17:20:06.538 ERROR:	return code = 1
2011-04-05 17:20:06.538 RunCommand(ps -e | grep signer)
2011-04-05 17:20:06.548 - runCommand: Process started, PID: 3972
2011-04-05 17:20:06.548 ERROR:	return code = 1

2011-04-05 17:20:06.548 00734 Wait(10)

2011-04-05 17:20:06.548 Requirement: ODSCC10

2011-04-05 17:20:16.549 00736 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:20:16.549 Requirement: ODSCC10

2011-04-05 17:20:16.549 00738 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:20:16.549 Requirement: ODSCC10
2011-04-05 17:20:16.549 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:20:16.554 - runCommand: Process started, PID: 3975

2011-04-05 17:20:16.555 00740 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:20:16.555 Requirement: ODSCC10
2011-04-05 17:20:16.555 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:20:16.558 - runCommand: Process started, PID: 3977
2011-04-05 17:20:16.558 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:20:16.558 ERROR:	return code = 1

2011-04-05 17:20:16.558 00742 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:20:16.558 Requirement: ODSCC10

2011-04-05 17:20:16.559 00745 PurgeHSM()
2011-04-05 17:20:16.559 Requirement: ODSCC10
2011-04-05 17:20:16.559 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:20:16.756 - runCommand: Process started, PID: 3979
2011-04-05 17:20:16.756 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:20:16.756 OUTPUT:	1 key found.
2011-04-05 17:20:16.756 OUTPUT:	
2011-04-05 17:20:16.756 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:20:16.756 OUTPUT:	Starting purge...
2011-04-05 17:20:16.756 OUTPUT:	Key remove successful: e55aee7894b405e5473552feef49da5d
2011-04-05 17:20:16.756 OUTPUT:	Purge done.

2011-04-05 17:20:16.757 00747 Wait(10)

2011-04-05 17:20:16.757 Requirement: ODSCC10

2011-04-05 17:20:26.757 00749 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:20:26.757 Requirement: ODSCC10

2011-04-05 17:20:26.758 00752 LoadConfig()
2011-04-05 17:20:26.758 Requirement: ODSCC10
2011-04-05 17:20:26.758 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T120_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:20:26.775 - runCommand: Process started, PID: 3983

2011-04-05 17:20:26.775 00755 LoadConfig()
2011-04-05 17:20:26.775 Requirement: ODSCC10
2011-04-05 17:20:26.776 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:20:26.780 - runCommand: Process started, PID: 3984

2011-04-05 17:20:26.780 00757 Comment: Update all the configs.

2011-04-05 17:20:26.780 Requirement: ODSCC10

2011-04-05 17:20:26.781 00759 ODSSetup()
2011-04-05 17:20:26.781 Requirement: ODSCC10
2011-04-05 17:20:26.781 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:20:38.637 - runCommand: Process started, PID: 3985
2011-04-05 17:20:38.637 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:20:38.637 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:20:38.637 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:20:38.637 OUTPUT:	Repository SoftHSM found
2011-04-05 17:20:38.637 OUTPUT:	Capacity set to 4.
2011-04-05 17:20:38.637 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:20:38.637 OUTPUT:	Policy default2 found
2011-04-05 17:20:38.637 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:20:38.637 OUTPUT:	Policy default found
2011-04-05 17:20:38.637 OUTPUT:	Zone ods found
2011-04-05 17:20:38.637 OUTPUT:	Policy set to default.
2011-04-05 17:20:38.637 OUTPUT:	Added zone ods to database
2011-04-05 17:20:38.637 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:20:38.637 OUTPUT:	Policy set to default.
2011-04-05 17:20:38.637 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:20:38.637 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:20:38.637 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:20:38.637 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:20:38.638 00761 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:20:38.638 Requirement: ODSCC10

2011-04-05 17:20:38.638 00763 Start()
2011-04-05 17:20:38.638 Requirement: ODSCC10
2011-04-05 17:20:38.638 RunCommand(ods-control start)
2011-04-05 17:20:38.640 - runCommand: Background process started, PID: 3998
2011-04-05 17:20:39.657 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:20:39.675 - runCommand: Process started, PID: 4014
2011-04-05 17:20:39.675 OUTPUT:	ods-enforcerd
2011-04-05 17:20:39.675 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:20:39.689 - runCommand: Process started, PID: 4030
2011-04-05 17:20:39.689 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:20:39.689 00765 Wait(10)

2011-04-05 17:20:39.689 Requirement: ODSCC10

2011-04-05 17:20:49.689 00767 Comment: Sign the ods zone with the new configs.

2011-04-05 17:20:49.689 Requirement: ODSCC10

2011-04-05 17:20:49.690 00771 Wait(15)

2011-04-05 17:20:49.690 Requirement: ODSCC10

2011-04-05 17:21:04.690 00773 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:21:04.690 Requirement: ODSCC10

2011-04-05 17:21:04.691 00775 Stop()
2011-04-05 17:21:04.691 Requirement: ODSCC10
2011-04-05 17:21:04.691 RunCommand(ods-control stop)
2011-04-05 17:21:05.701 - runCommand: Process started, PID: 4069
2011-04-05 17:21:05.701 OUTPUT:	Stopping enforcer...
2011-04-05 17:21:05.701 OUTPUT:	Stopping signer engine..
2011-04-05 17:21:05.702 OUTPUT:	Engine shut down.
2011-04-05 17:21:05.702 RunCommand(ps -e | grep enforcer)
2011-04-05 17:21:05.718 - runCommand: Process started, PID: 4075
2011-04-05 17:21:05.718 ERROR:	return code = 1
2011-04-05 17:21:05.718 RunCommand(ps -e | grep signer)
2011-04-05 17:21:05.729 - runCommand: Process started, PID: 4078
2011-04-05 17:21:05.729 ERROR:	return code = 1

2011-04-05 17:21:05.729 00777 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:21:05.729 Requirement: ODSCC10

2011-04-05 17:21:05.729 00780 CheckLog()
2011-04-05 17:21:05.729 Requirement: ODSCC10
2011-04-05 17:21:07.304 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:21:04 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0

-------------------------------------------------------------------------------
Testcase - ODSCC10T130: Use a Repository Capacity of 100000 and expect success

2011-04-05 17:21:07.304 00787 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:21:07.304 Requirement: ODSCC10

2011-04-05 17:21:07.304 00789 Stop()
2011-04-05 17:21:07.304 Requirement: ODSCC10
2011-04-05 17:21:07.304 RunCommand(ods-control stop)
2011-04-05 17:21:07.308 - runCommand: Process started, PID: 4081
2011-04-05 17:21:07.308 OUTPUT:	Stopping enforcer...
2011-04-05 17:21:07.308 OUTPUT:	Cannot find PID file
2011-04-05 17:21:07.308 OUTPUT:	Stopping signer engine..
2011-04-05 17:21:07.308 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:21:07.309 ERROR:	return code = 1
2011-04-05 17:21:07.309 RunCommand(ps -e | grep enforcer)
2011-04-05 17:21:07.318 - runCommand: Process started, PID: 4084
2011-04-05 17:21:07.318 ERROR:	return code = 1
2011-04-05 17:21:07.318 RunCommand(ps -e | grep signer)
2011-04-05 17:21:07.328 - runCommand: Process started, PID: 4087
2011-04-05 17:21:07.328 ERROR:	return code = 1

2011-04-05 17:21:07.328 00791 Wait(10)

2011-04-05 17:21:07.328 Requirement: ODSCC10

2011-04-05 17:21:17.329 00793 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:21:17.329 Requirement: ODSCC10

2011-04-05 17:21:17.329 00795 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:21:17.329 Requirement: ODSCC10
2011-04-05 17:21:17.329 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:21:17.335 - runCommand: Process started, PID: 4090

2011-04-05 17:21:17.336 00797 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:21:17.336 Requirement: ODSCC10
2011-04-05 17:21:17.336 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:21:17.340 - runCommand: Process started, PID: 4092

2011-04-05 17:21:17.340 00799 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:21:17.340 Requirement: ODSCC10

2011-04-05 17:21:17.341 00802 PurgeHSM()
2011-04-05 17:21:17.341 Requirement: ODSCC10
2011-04-05 17:21:17.341 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:21:18.862 - runCommand: Process started, PID: 4094
2011-04-05 17:21:18.871 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:21:18.873 OUTPUT:	4 keys found.
2011-04-05 17:21:18.875 OUTPUT:	
2011-04-05 17:21:18.877 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:21:18.878 OUTPUT:	Starting purge...
2011-04-05 17:21:18.880 OUTPUT:	Key remove successful: d4c418e024865ee3b780644d5f6e8587
2011-04-05 17:21:18.882 OUTPUT:	Key remove successful: 47ce1daddfc4c2177e1308e674153778
2011-04-05 17:21:18.883 OUTPUT:	Key remove successful: bd93e2832903eb759cbc12b16730d4f9
2011-04-05 17:21:18.885 OUTPUT:	Key remove successful: 7b4165a9bbe50e0b256a3878efca0eed
2011-04-05 17:21:18.887 OUTPUT:	Purge done.

2011-04-05 17:21:18.927 00804 Wait(10)

2011-04-05 17:21:18.929 Requirement: ODSCC10

2011-04-05 17:21:28.975 00807 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:21:28.980 Requirement: ODSCC10

2011-04-05 17:21:28.101 00810 LoadConfig()
2011-04-05 17:21:28.101 Requirement: ODSCC10
2011-04-05 17:21:28.101 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T130_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:21:28.274 - runCommand: Process started, PID: 4098

2011-04-05 17:21:28.280 00813 LoadConfig()
2011-04-05 17:21:28.280 Requirement: ODSCC10
2011-04-05 17:21:28.280 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:21:28.337 - runCommand: Process started, PID: 4099

2011-04-05 17:21:28.341 00815 Comment: Update all the configs.

2011-04-05 17:21:28.341 Requirement: ODSCC10

2011-04-05 17:21:28.345 00817 ODSSetup()
2011-04-05 17:21:28.345 Requirement: ODSCC10
2011-04-05 17:21:28.345 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:21:40.227 - runCommand: Process started, PID: 4100
2011-04-05 17:21:40.228 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:21:40.228 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:21:40.228 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:21:40.228 OUTPUT:	Repository SoftHSM found
2011-04-05 17:21:40.228 OUTPUT:	Capacity set to 100000.
2011-04-05 17:21:40.228 OUTPUT:	RequireBackup NOT set; please make sure that you know the potential problems of using keys which are not recoverable
2011-04-05 17:21:40.229 OUTPUT:	Policy default2 found
2011-04-05 17:21:40.229 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:21:40.229 OUTPUT:	Policy default found
2011-04-05 17:21:40.229 OUTPUT:	Zone ods found
2011-04-05 17:21:40.229 OUTPUT:	Policy set to default.
2011-04-05 17:21:40.229 OUTPUT:	Added zone ods to database
2011-04-05 17:21:40.230 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:21:40.230 OUTPUT:	Policy set to default.
2011-04-05 17:21:40.230 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:21:40.230 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:21:40.230 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:21:40.230 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:21:40.234 00819 Wait(10)

2011-04-05 17:21:40.235 Requirement: ODSCC10

2011-04-05 17:21:50.239 00821 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:21:50.240 Requirement: ODSCC10

2011-04-05 17:21:50.243 00823 Start()
2011-04-05 17:21:50.243 Requirement: ODSCC10
2011-04-05 17:21:50.244 RunCommand(ods-control start)
2011-04-05 17:21:50.264 - runCommand: Background process started, PID: 4113
2011-04-05 17:21:51.421 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:21:51.756 - runCommand: Process started, PID: 4129
2011-04-05 17:21:51.757 OUTPUT:	ods-enforcerd
2011-04-05 17:21:51.757 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:21:51.912 - runCommand: Process started, PID: 4145
2011-04-05 17:21:51.913 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:21:51.915 00825 Comment: Sign the ods zone with the new configs.

2011-04-05 17:21:51.916 Requirement: ODSCC10

2011-04-05 17:21:51.918 00829 Wait(15)

2011-04-05 17:21:51.918 Requirement: ODSCC10

2011-04-05 17:22:06.922 00831 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:22:06.923 Requirement: ODSCC10

2011-04-05 17:22:06.927 00833 Stop()
2011-04-05 17:22:06.927 Requirement: ODSCC10
2011-04-05 17:22:06.927 RunCommand(ods-control stop)
2011-04-05 17:22:07.102 - runCommand: Process started, PID: 4184
2011-04-05 17:22:07.102 OUTPUT:	Stopping enforcer...
2011-04-05 17:22:07.102 OUTPUT:	Stopping signer engine..
2011-04-05 17:22:07.102 OUTPUT:	Engine shut down.
2011-04-05 17:22:07.102 RunCommand(ps -e | grep enforcer)
2011-04-05 17:22:07.119 - runCommand: Process started, PID: 4190
2011-04-05 17:22:07.119 ERROR:	return code = 1
2011-04-05 17:22:07.119 RunCommand(ps -e | grep signer)
2011-04-05 17:22:07.134 - runCommand: Process started, PID: 4193
2011-04-05 17:22:07.134 ERROR:	return code = 1

2011-04-05 17:22:07.134 00835 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:22:07.134 Requirement: ODSCC10

2011-04-05 17:22:07.134 00838 CheckLog()
2011-04-05 17:22:07.134 Requirement: ODSCC10
2011-04-05 17:22:08.713 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:22:06 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0

-------------------------------------------------------------------------------
Testcase - ODSCC10T140: RequireBackup turned off and check if backup is not required to use a key

2011-04-05 17:22:08.714 00845 Comment: RequireBackup is an optional element that specifies that keys from this repository may not be used until they are backed up. If backup has been done, then use ods-ksmutil to notify OpenDNSSEC about this. The backup notification is needed for OpenDNSSEC to be able to complete a key rollover.

2011-04-05 17:22:08.714 Requirement: ODSCC10

2011-04-05 17:22:08.714 00846 Comment: This has been already tested in DSCC10T10

2011-04-05 17:22:08.714 Requirement: ODSCC10

-------------------------------------------------------------------------------
Testcase - ODSCC10T150: RequireBackup turned on and check if backup is required to use a key

2011-04-05 17:22:08.714 00856 Comment: RequireBackup is an optional element that specifies that keys from this repository may not be used until they are backed up. If backup has been done, then use ods-ksmutil to notify OpenDNSSEC about this. The backup notification is needed for OpenDNSSEC to be able to complete a key rollover.

2011-04-05 17:22:08.714 Requirement: ODSCC10

2011-04-05 17:22:08.715 00857 Comment: 

2011-04-05 17:22:08.715 Requirement: ODSCC10

2011-04-05 17:22:08.715 00859 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:22:08.715 Requirement: ODSCC10

2011-04-05 17:22:08.715 00861 Stop()
2011-04-05 17:22:08.715 Requirement: ODSCC10
2011-04-05 17:22:08.715 RunCommand(ods-control stop)
2011-04-05 17:22:08.719 - runCommand: Process started, PID: 4196
2011-04-05 17:22:08.719 OUTPUT:	Stopping enforcer...
2011-04-05 17:22:08.719 OUTPUT:	Cannot find PID file
2011-04-05 17:22:08.719 OUTPUT:	Stopping signer engine..
2011-04-05 17:22:08.719 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:22:08.719 ERROR:	return code = 1
2011-04-05 17:22:08.719 RunCommand(ps -e | grep enforcer)
2011-04-05 17:22:08.729 - runCommand: Process started, PID: 4199
2011-04-05 17:22:08.729 ERROR:	return code = 1
2011-04-05 17:22:08.729 RunCommand(ps -e | grep signer)
2011-04-05 17:22:08.739 - runCommand: Process started, PID: 4202
2011-04-05 17:22:08.739 ERROR:	return code = 1

2011-04-05 17:22:08.739 00863 Wait(10)

2011-04-05 17:22:08.739 Requirement: ODSCC10

2011-04-05 17:22:18.740 00865 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:22:18.740 Requirement: ODSCC10

2011-04-05 17:22:18.740 00867 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:22:18.740 Requirement: ODSCC10
2011-04-05 17:22:18.740 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:22:18.746 - runCommand: Process started, PID: 4205

2011-04-05 17:22:18.746 00869 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:22:18.746 Requirement: ODSCC10
2011-04-05 17:22:18.746 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:22:18.751 - runCommand: Process started, PID: 4207

2011-04-05 17:22:18.751 00871 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:22:18.751 Requirement: ODSCC10

2011-04-05 17:22:18.751 00874 PurgeHSM()
2011-04-05 17:22:18.751 Requirement: ODSCC10
2011-04-05 17:22:18.752 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:22:19.418 - runCommand: Process started, PID: 4209
2011-04-05 17:22:19.418 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:22:19.418 OUTPUT:	4 keys found.
2011-04-05 17:22:19.418 OUTPUT:	
2011-04-05 17:22:19.418 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:22:19.418 OUTPUT:	Starting purge...
2011-04-05 17:22:19.418 OUTPUT:	Key remove successful: c830b731e1c365a425782d296a6284dc
2011-04-05 17:22:19.418 OUTPUT:	Key remove successful: d89629f38d4f31653e1cc72069e7821e
2011-04-05 17:22:19.419 OUTPUT:	Key remove successful: 86442d628f606869643b481679b348d3
2011-04-05 17:22:19.419 OUTPUT:	Key remove successful: ad4daa7d9111d752de9c3d8416e475d9
2011-04-05 17:22:19.419 OUTPUT:	Purge done.

2011-04-05 17:22:19.419 00876 Wait(10)

2011-04-05 17:22:19.419 Requirement: ODSCC10

2011-04-05 17:22:29.419 00878 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:22:29.419 Requirement: ODSCC10

2011-04-05 17:22:29.420 00881 LoadConfig()
2011-04-05 17:22:29.420 Requirement: ODSCC10
2011-04-05 17:22:29.420 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T150_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:22:29.437 - runCommand: Process started, PID: 4213

2011-04-05 17:22:29.438 00884 LoadConfig()
2011-04-05 17:22:29.438 Requirement: ODSCC10
2011-04-05 17:22:29.438 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:22:29.442 - runCommand: Process started, PID: 4214

2011-04-05 17:22:29.442 00886 Comment: Update all the configs.

2011-04-05 17:22:29.442 Requirement: ODSCC10

2011-04-05 17:22:29.443 00888 ODSSetup()
2011-04-05 17:22:29.443 Requirement: ODSCC10
2011-04-05 17:22:29.443 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:22:41.333 - runCommand: Process started, PID: 4215
2011-04-05 17:22:41.333 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:22:41.333 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:22:41.333 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:22:41.333 OUTPUT:	Repository SoftHSM found
2011-04-05 17:22:41.333 OUTPUT:	Capacity set to 10.
2011-04-05 17:22:41.333 OUTPUT:	RequireBackup set.
2011-04-05 17:22:41.333 OUTPUT:	Policy default2 found
2011-04-05 17:22:41.333 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:22:41.333 OUTPUT:	Policy default found
2011-04-05 17:22:41.333 OUTPUT:	Zone ods found
2011-04-05 17:22:41.333 OUTPUT:	Policy set to default.
2011-04-05 17:22:41.333 OUTPUT:	Added zone ods to database
2011-04-05 17:22:41.333 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:22:41.333 OUTPUT:	Policy set to default.
2011-04-05 17:22:41.333 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:22:41.333 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:22:41.333 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:22:41.333 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:22:41.333 00890 Wait(10)

2011-04-05 17:22:41.333 Requirement: ODSCC10

2011-04-05 17:22:51.334 00892 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:22:51.334 Requirement: ODSCC10

2011-04-05 17:22:51.334 00894 Start()
2011-04-05 17:22:51.334 Requirement: ODSCC10
2011-04-05 17:22:51.334 RunCommand(ods-control start)
2011-04-05 17:22:51.336 - runCommand: Background process started, PID: 4228
2011-04-05 17:22:52.360 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:22:52.386 - runCommand: Process started, PID: 4256
2011-04-05 17:22:52.386 OUTPUT:	ods-enforcerd
2011-04-05 17:22:52.386 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:22:52.402 - runCommand: Process started, PID: 4260
2011-04-05 17:22:52.402 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:22:52.402 00896 Comment: Sign the ods zone with the new configs.

2011-04-05 17:22:52.402 Requirement: ODSCC10

2011-04-05 17:22:52.402 00900 Wait(15)

2011-04-05 17:22:52.402 Requirement: ODSCC10

2011-04-05 17:23:07.403 00902 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:23:07.403 Requirement: ODSCC10

2011-04-05 17:23:07.403 00904 Stop()
2011-04-05 17:23:07.403 Requirement: ODSCC10
2011-04-05 17:23:07.403 RunCommand(ods-control stop)
2011-04-05 17:23:08.413 - runCommand: Process started, PID: 4265
2011-04-05 17:23:08.413 OUTPUT:	Stopping enforcer...
2011-04-05 17:23:08.413 OUTPUT:	Stopping signer engine..
2011-04-05 17:23:08.413 OUTPUT:	Engine shut down.
2011-04-05 17:23:08.413 RunCommand(ps -e | grep enforcer)
2011-04-05 17:23:08.425 - runCommand: Process started, PID: 4271
2011-04-05 17:23:08.425 ERROR:	return code = 1
2011-04-05 17:23:08.425 RunCommand(ps -e | grep signer)
2011-04-05 17:23:08.438 - runCommand: Process started, PID: 4274
2011-04-05 17:23:08.439 ERROR:	return code = 1

2011-04-05 17:23:08.439 00906 Comment: Check if the signing was unsuccesfull. If a warning message is missing in the logging, the signing was succesful. 

2011-04-05 17:23:08.439 Requirement: ODSCC10

2011-04-05 17:23:08.439 00909 CheckLog()
2011-04-05 17:23:08.439 Requirement: ODSCC10
2011-04-05 17:23:10.801 FAILED:	(Check for Like) - Expected: Making non-backed up ZSK active, PLEASE make sure that you know the potential problems of using keys which are not recoverable Found: 

2011-04-05 17:23:10.836 00911 Comment: Message should NOT be in the logging.

2011-04-05 17:23:10.837 Requirement: ODSCC10

-------------------------------------------------------------------------------
Testcase - ODSCC10T160: RequireBackup turned on, backup keys, and sign zone

2011-04-05 17:23:10.888 00916 Comment: RequireBackup is an optional element that specifies that keys from this repository may not be used until they are backed up. If backup has been done, then use ods-ksmutil to notify OpenDNSSEC about this. The backup notification is needed for OpenDNSSEC to be able to complete a key rollover.

2011-04-05 17:23:10.890 Requirement: ODSCC10

2011-04-05 17:23:10.909 00917 Comment: 

2011-04-05 17:23:10.911 Requirement: ODSCC10

2011-04-05 17:23:10.931 00919 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:23:10.932 Requirement: ODSCC10

2011-04-05 17:23:10.953 00921 Stop()
2011-04-05 17:23:10.954 Requirement: ODSCC10
2011-04-05 17:23:10.955 RunCommand(ods-control stop)
2011-04-05 17:23:10.138 - runCommand: Process started, PID: 4277
2011-04-05 17:23:10.138 OUTPUT:	Stopping enforcer...
2011-04-05 17:23:10.139 OUTPUT:	Cannot find PID file
2011-04-05 17:23:10.139 OUTPUT:	Stopping signer engine..
2011-04-05 17:23:10.139 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:23:10.139 ERROR:	return code = 1
2011-04-05 17:23:10.139 RunCommand(ps -e | grep enforcer)
2011-04-05 17:23:10.236 - runCommand: Process started, PID: 4280
2011-04-05 17:23:10.237 ERROR:	return code = 1
2011-04-05 17:23:10.237 RunCommand(ps -e | grep signer)
2011-04-05 17:23:10.348 - runCommand: Process started, PID: 4283
2011-04-05 17:23:10.349 ERROR:	return code = 1

2011-04-05 17:23:10.351 00923 Wait(10)

2011-04-05 17:23:10.351 Requirement: ODSCC10

2011-04-05 17:23:20.356 00925 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:23:20.356 Requirement: ODSCC10

2011-04-05 17:23:20.360 00927 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:23:20.360 Requirement: ODSCC10
2011-04-05 17:23:20.360 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:23:20.415 - runCommand: Process started, PID: 4286

2011-04-05 17:23:20.419 00929 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:23:20.419 Requirement: ODSCC10
2011-04-05 17:23:20.419 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:23:20.465 - runCommand: Process started, PID: 4288
2011-04-05 17:23:20.466 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:23:20.466 ERROR:	return code = 1

2011-04-05 17:23:20.470 00931 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:23:20.470 Requirement: ODSCC10

2011-04-05 17:23:20.473 00934 PurgeHSM()
2011-04-05 17:23:20.474 Requirement: ODSCC10
2011-04-05 17:23:20.474 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:23:20.670 - runCommand: Process started, PID: 4290
2011-04-05 17:23:20.670 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:23:20.670 OUTPUT:	4 keys found.
2011-04-05 17:23:20.670 OUTPUT:	
2011-04-05 17:23:20.670 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:23:20.670 OUTPUT:	Starting purge...
2011-04-05 17:23:20.670 OUTPUT:	Key remove successful: 3a0ed85747cdfe68d4dc170f151df3b9
2011-04-05 17:23:20.670 OUTPUT:	Key remove successful: c4d10a4dcdcc3c172d4a6f03ed9b5ec1
2011-04-05 17:23:20.670 OUTPUT:	Key remove successful: ca54ff0feb48be44def98cfeaf4310b7
2011-04-05 17:23:20.670 OUTPUT:	Key remove successful: 5dc41cdc62bdcf1f9f14550fd634495c
2011-04-05 17:23:20.670 OUTPUT:	Purge done.

2011-04-05 17:23:20.671 00936 Wait(10)

2011-04-05 17:23:20.671 Requirement: ODSCC10

2011-04-05 17:23:30.671 00939 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:23:30.671 Requirement: ODSCC10

2011-04-05 17:23:30.672 00942 LoadConfig()
2011-04-05 17:23:30.672 Requirement: ODSCC10
2011-04-05 17:23:30.672 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC10T160_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:23:30.689 - runCommand: Process started, PID: 4297

2011-04-05 17:23:30.690 00945 LoadConfig()
2011-04-05 17:23:30.690 Requirement: ODSCC10
2011-04-05 17:23:30.690 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:23:30.694 - runCommand: Process started, PID: 4298

2011-04-05 17:23:30.694 00947 Comment: Update all the configs.

2011-04-05 17:23:30.694 Requirement: ODSCC10

2011-04-05 17:23:30.695 00949 ODSSetup()
2011-04-05 17:23:30.695 Requirement: ODSCC10
2011-04-05 17:23:30.695 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:23:42.410 - runCommand: Process started, PID: 4299
2011-04-05 17:23:42.410 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:23:42.410 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:23:42.410 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:23:42.410 OUTPUT:	Repository SoftHSM found
2011-04-05 17:23:42.410 OUTPUT:	Capacity set to 10.
2011-04-05 17:23:42.410 OUTPUT:	RequireBackup set.
2011-04-05 17:23:42.410 OUTPUT:	Policy default2 found
2011-04-05 17:23:42.410 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:23:42.410 OUTPUT:	Policy default found
2011-04-05 17:23:42.410 OUTPUT:	Zone ods found
2011-04-05 17:23:42.410 OUTPUT:	Policy set to default.
2011-04-05 17:23:42.410 OUTPUT:	Added zone ods to database
2011-04-05 17:23:42.410 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:23:42.410 OUTPUT:	Policy set to default.
2011-04-05 17:23:42.410 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:23:42.410 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:23:42.410 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:23:42.410 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:23:42.410 00951 Wait(10)

2011-04-05 17:23:42.410 Requirement: ODSCC10

2011-04-05 17:23:52.411 00953 Comment: Prepare the backup by telling the Enforcer that you want to do backup of the keys.

2011-04-05 17:23:52.411 Requirement: ODSCC10

2011-04-05 17:23:52.411 00955 ExecuteCommand(ods-ksmutil backup prepare)
2011-04-05 17:23:52.411 Requirement: ODSCC10
2011-04-05 17:23:52.411 RunCommand(ods-ksmutil backup prepare)
2011-04-05 17:23:52.457 - runCommand: Process started, PID: 4312
2011-04-05 17:23:52.457 OUTPUT:	There were no keys to mark
2011-04-05 17:23:52.457 ERROR:	SQLite database set to: /var/opendnssec/kasp.db

2011-04-05 17:23:52.457 00957 Wait(5)

2011-04-05 17:23:52.457 Requirement: ODSCC10

2011-04-05 17:23:57.458 00959 Comment: Backup keys is not a part of ODS (part of the HSM), and can therefor be skipped. Let the enforcer know that the backup step has been done.

2011-04-05 17:23:57.458 Requirement: ODSCC10

2011-04-05 17:23:57.458 00961 ExecuteCommand( ods-ksmutil backup commit)
2011-04-05 17:23:57.458 Requirement: ODSCC10
2011-04-05 17:23:57.458 RunCommand( ods-ksmutil backup commit)
2011-04-05 17:23:57.508 - runCommand: Process started, PID: 4314
2011-04-05 17:23:57.509 OUTPUT:	There were no keys to mark
2011-04-05 17:23:57.509 ERROR:	SQLite database set to: /var/opendnssec/kasp.db

2011-04-05 17:23:57.509 00963 Wait(5)

2011-04-05 17:23:57.509 Requirement: ODSCC10

2011-04-05 17:24:02.509 00965 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:24:02.509 Requirement: ODSCC10

2011-04-05 17:24:02.510 00967 Start()
2011-04-05 17:24:02.510 Requirement: ODSCC10
2011-04-05 17:24:02.510 RunCommand(ods-control start)
2011-04-05 17:24:02.512 - runCommand: Background process started, PID: 4316
2011-04-05 17:24:02.538 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:24:02.550 - runCommand: Process started, PID: 4330
2011-04-05 17:24:02.550 OUTPUT:	ods-enforcerd
2011-04-05 17:24:02.550 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:24:02.564 - runCommand: Process started, PID: 4346
2011-04-05 17:24:02.564 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:24:02.565 00969 Wait(10)

2011-04-05 17:24:02.565 Requirement: ODSCC10

2011-04-05 17:24:12.565 00971 Comment: Sign the ods zone with the new configs.

2011-04-05 17:24:12.565 Requirement: ODSCC10

2011-04-05 17:24:12.566 00975 Wait(15)

2011-04-05 17:24:12.566 Requirement: ODSCC10

2011-04-05 17:24:27.566 00977 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:24:27.566 Requirement: ODSCC10

2011-04-05 17:24:27.566 00979 Stop()
2011-04-05 17:24:27.566 Requirement: ODSCC10
2011-04-05 17:24:27.566 RunCommand(ods-control stop)
2011-04-05 17:24:28.576 - runCommand: Process started, PID: 4351
2011-04-05 17:24:28.576 OUTPUT:	Stopping enforcer...
2011-04-05 17:24:28.576 OUTPUT:	Stopping signer engine..
2011-04-05 17:24:28.576 OUTPUT:	Engine shut down.
2011-04-05 17:24:28.576 RunCommand(ps -e | grep enforcer)
2011-04-05 17:24:28.593 - runCommand: Process started, PID: 4357
2011-04-05 17:24:28.593 ERROR:	return code = 1
2011-04-05 17:24:28.593 RunCommand(ps -e | grep signer)
2011-04-05 17:24:28.609 - runCommand: Process started, PID: 4360
2011-04-05 17:24:28.609 ERROR:	return code = 1

2011-04-05 17:24:28.609 00981 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:24:28.609 Requirement: ODSCC10

2011-04-05 17:24:28.610 00984 CheckLog()
2011-04-05 17:24:28.610 Requirement: ODSCC10
2011-04-05 17:24:30.182 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:24:27 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0
Testcondition - ODSCC20: The configuration of common settings located in conf.xml should operate according to requirements and intentions
-------------------------------------------------------------------------------

-------------------------------------------------------------------------------
Testcase - ODSCC20T10: Set logging to a different channel and check if only the new channel receives ODS logging

2011-04-05 17:24:30.183 00992 Comment: Channel "local5" is used in the xml template instead of "local0".

2011-04-05 17:24:30.183 Requirement: ODSCC20

2011-04-05 17:24:30.183 00994 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:24:30.183 Requirement: ODSCC20

2011-04-05 17:24:30.183 00996 Stop()
2011-04-05 17:24:30.183 Requirement: ODSCC20
2011-04-05 17:24:30.183 RunCommand(ods-control stop)
2011-04-05 17:24:30.188 - runCommand: Process started, PID: 4363
2011-04-05 17:24:30.188 OUTPUT:	Stopping enforcer...
2011-04-05 17:24:30.188 OUTPUT:	Cannot find PID file
2011-04-05 17:24:30.188 OUTPUT:	Stopping signer engine..
2011-04-05 17:24:30.188 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:24:30.188 ERROR:	return code = 1
2011-04-05 17:24:30.188 RunCommand(ps -e | grep enforcer)
2011-04-05 17:24:30.197 - runCommand: Process started, PID: 4366
2011-04-05 17:24:30.197 ERROR:	return code = 1
2011-04-05 17:24:30.197 RunCommand(ps -e | grep signer)
2011-04-05 17:24:30.207 - runCommand: Process started, PID: 4369
2011-04-05 17:24:30.207 ERROR:	return code = 1

2011-04-05 17:24:30.208 00998 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:24:30.208 Requirement: ODSCC20

2011-04-05 17:24:30.208 01000 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:24:30.208 Requirement: ODSCC20
2011-04-05 17:24:30.208 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:24:30.214 - runCommand: Process started, PID: 4372

2011-04-05 17:24:30.214 01002 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:24:30.214 Requirement: ODSCC20
2011-04-05 17:24:30.214 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:24:30.217 - runCommand: Process started, PID: 4374
2011-04-05 17:24:30.217 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:24:30.217 ERROR:	return code = 1

2011-04-05 17:24:30.218 01004 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:24:30.218 Requirement: ODSCC20

2011-04-05 17:24:30.218 01007 PurgeHSM()
2011-04-05 17:24:30.218 Requirement: ODSCC20
2011-04-05 17:24:30.218 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:24:30.959 - runCommand: Process started, PID: 4376
2011-04-05 17:24:30.959 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:24:30.959 OUTPUT:	4 keys found.
2011-04-05 17:24:30.959 OUTPUT:	
2011-04-05 17:24:30.959 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:24:30.960 OUTPUT:	Starting purge...
2011-04-05 17:24:30.960 OUTPUT:	Key remove successful: bdf4eb2c66d8209e13e74a3ab3f8b079
2011-04-05 17:24:30.960 OUTPUT:	Key remove successful: 8c69d9741ce1ee4a3fc6f3cb4569ea93
2011-04-05 17:24:30.960 OUTPUT:	Key remove successful: 1db0c8ce1791865dbd047690049aa1c4
2011-04-05 17:24:30.960 OUTPUT:	Key remove successful: a162d751e9bb7a20c1b09351cbc3435f
2011-04-05 17:24:30.960 OUTPUT:	Purge done.

2011-04-05 17:24:30.960 01009 Wait(10)

2011-04-05 17:24:30.960 Requirement: ODSCC20

2011-04-05 17:24:40.960 01011 Wait(10)

2011-04-05 17:24:40.960 Requirement: ODSCC20

2011-04-05 17:24:50.961 01013 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:24:50.961 Requirement: ODSCC20

2011-04-05 17:24:50.961 01016 LoadConfig()
2011-04-05 17:24:50.961 Requirement: ODSCC20
2011-04-05 17:24:50.961 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC20T10_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:24:50.973 - runCommand: Process started, PID: 4380

2011-04-05 17:24:50.974 01019 LoadConfig()
2011-04-05 17:24:50.974 Requirement: ODSCC20
2011-04-05 17:24:50.974 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:24:50.978 - runCommand: Process started, PID: 4381

2011-04-05 17:24:50.979 01021 Comment: Syslog needs to be changed for this testcase. Ods.log is configured for local5 instead of local0

2011-04-05 17:24:50.979 Requirement: ODSCC20

2011-04-05 17:24:50.979 01023 Comment: Update all the configs.

2011-04-05 17:24:50.979 Requirement: ODSCC20

2011-04-05 17:24:50.980 01025 ODSSetup()
2011-04-05 17:24:50.980 Requirement: ODSCC20
2011-04-05 17:24:50.980 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:25:02.785 - runCommand: Process started, PID: 4382
2011-04-05 17:25:02.785 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:25:02.785 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:25:02.785 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:25:02.785 OUTPUT:	Repository SoftHSM found
2011-04-05 17:25:02.785 OUTPUT:	Capacity set to 10.
2011-04-05 17:25:02.785 OUTPUT:	RequireBackup set.
2011-04-05 17:25:02.785 OUTPUT:	Policy default2 found
2011-04-05 17:25:02.785 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:25:02.785 OUTPUT:	Policy default found
2011-04-05 17:25:02.785 OUTPUT:	Zone ods found
2011-04-05 17:25:02.785 OUTPUT:	Policy set to default.
2011-04-05 17:25:02.785 OUTPUT:	Added zone ods to database
2011-04-05 17:25:02.785 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:25:02.785 OUTPUT:	Policy set to default.
2011-04-05 17:25:02.785 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:25:02.785 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:25:02.785 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:25:02.785 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:25:02.786 01027 Wait(10)

2011-04-05 17:25:02.786 Requirement: ODSCC20

2011-04-05 17:25:12.786 01029 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:25:12.786 Requirement: ODSCC20

2011-04-05 17:25:12.787 01031 Start()
2011-04-05 17:25:12.787 Requirement: ODSCC20
2011-04-05 17:25:12.787 RunCommand(ods-control start)
2011-04-05 17:25:12.789 - runCommand: Background process started, PID: 4395
2011-04-05 17:25:13.805 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:25:13.839 - runCommand: Process started, PID: 4411
2011-04-05 17:25:13.839 OUTPUT:	ods-enforcerd
2011-04-05 17:25:13.839 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:25:13.857 - runCommand: Process started, PID: 4427
2011-04-05 17:25:13.857 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:25:13.858 01033 Comment: Sign the ods zone with the new configs.

2011-04-05 17:25:13.858 Requirement: ODSCC20

2011-04-05 17:25:13.858 01037 Wait(15)

2011-04-05 17:25:13.858 Requirement: ODSCC20

2011-04-05 17:25:28.858 01039 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:25:28.858 Requirement: ODSCC20

2011-04-05 17:25:28.858 01041 Stop()
2011-04-05 17:25:28.858 Requirement: ODSCC20
2011-04-05 17:25:28.858 RunCommand(ods-control stop)
2011-04-05 17:25:29.869 - runCommand: Process started, PID: 4433
2011-04-05 17:25:29.869 OUTPUT:	Stopping enforcer...
2011-04-05 17:25:29.869 OUTPUT:	Stopping signer engine..
2011-04-05 17:25:29.869 OUTPUT:	Engine shut down.
2011-04-05 17:25:29.869 RunCommand(ps -e | grep enforcer)
2011-04-05 17:25:29.885 - runCommand: Process started, PID: 4439
2011-04-05 17:25:29.885 ERROR:	return code = 1
2011-04-05 17:25:29.885 RunCommand(ps -e | grep signer)
2011-04-05 17:25:29.896 - runCommand: Process started, PID: 4442
2011-04-05 17:25:29.896 ERROR:	return code = 1

2011-04-05 17:25:29.896 01043 Comment: Check if the logging is succesfull. If a notify (new zonefile update) is available in, the signing & logging is succesful.

2011-04-05 17:25:29.896 Requirement: ODSCC20

2011-04-05 17:25:29.896 01046 CheckLog()
2011-04-05 17:25:29.896 Requirement: ODSCC20
2011-04-05 17:25:31.490 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:25:28 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0

-------------------------------------------------------------------------------
Testcase - ODSCC20T20: Set logging to a different channel and check if only the new channel receives ODS logging

2011-04-05 17:25:31.491 01051 Comment: Channel "local10" is used in the xml template instead of "local0". Local10 is not allowed according tot specs. Only a value between local0 & local7 is allowed.

2011-04-05 17:25:31.491 Requirement: ODSCC20

2011-04-05 17:25:31.491 01053 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:25:31.491 Requirement: ODSCC20

2011-04-05 17:25:31.491 01055 Stop()
2011-04-05 17:25:31.491 Requirement: ODSCC20
2011-04-05 17:25:31.491 RunCommand(ods-control stop)
2011-04-05 17:25:31.495 - runCommand: Process started, PID: 4445
2011-04-05 17:25:31.495 OUTPUT:	Stopping enforcer...
2011-04-05 17:25:31.495 OUTPUT:	Cannot find PID file
2011-04-05 17:25:31.495 OUTPUT:	Stopping signer engine..
2011-04-05 17:25:31.495 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:25:31.495 ERROR:	return code = 1
2011-04-05 17:25:31.495 RunCommand(ps -e | grep enforcer)
2011-04-05 17:25:31.505 - runCommand: Process started, PID: 4448
2011-04-05 17:25:31.505 ERROR:	return code = 1
2011-04-05 17:25:31.505 RunCommand(ps -e | grep signer)
2011-04-05 17:25:31.515 - runCommand: Process started, PID: 4451
2011-04-05 17:25:31.515 ERROR:	return code = 1

2011-04-05 17:25:31.515 01057 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:25:31.515 Requirement: ODSCC20

2011-04-05 17:25:31.515 01059 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:25:31.515 Requirement: ODSCC20
2011-04-05 17:25:31.515 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:25:31.519 - runCommand: Process started, PID: 4454

2011-04-05 17:25:31.520 01061 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:25:31.520 Requirement: ODSCC20
2011-04-05 17:25:31.520 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:25:31.523 - runCommand: Process started, PID: 4456
2011-04-05 17:25:31.523 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:25:31.523 ERROR:	return code = 1

2011-04-05 17:25:31.523 01063 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:25:31.523 Requirement: ODSCC20

2011-04-05 17:25:31.523 01066 PurgeHSM()
2011-04-05 17:25:31.523 Requirement: ODSCC20
2011-04-05 17:25:31.523 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:25:32.245 - runCommand: Process started, PID: 4458
2011-04-05 17:25:32.245 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:25:32.245 OUTPUT:	4 keys found.
2011-04-05 17:25:32.245 OUTPUT:	
2011-04-05 17:25:32.245 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:25:32.245 OUTPUT:	Starting purge...
2011-04-05 17:25:32.245 OUTPUT:	Key remove successful: 4f8f0dfb52468ff170c89eaa00434017
2011-04-05 17:25:32.245 OUTPUT:	Key remove successful: afba8f093862f5ebf5e73581f3eb680c
2011-04-05 17:25:32.245 OUTPUT:	Key remove successful: 9c1a91538263ed67a086742b46f9b4b4
2011-04-05 17:25:32.245 OUTPUT:	Key remove successful: 6e094257edaf9b358594b36f2dc43a1a
2011-04-05 17:25:32.245 OUTPUT:	Purge done.

2011-04-05 17:25:32.245 01068 Wait(10)

2011-04-05 17:25:32.245 Requirement: ODSCC20

2011-04-05 17:25:42.246 01070 Wait(10)

2011-04-05 17:25:42.246 Requirement: ODSCC20

2011-04-05 17:25:52.246 01072 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:25:52.246 Requirement: ODSCC20

2011-04-05 17:25:52.247 01075 LoadConfig()
2011-04-05 17:25:52.247 Requirement: ODSCC20
2011-04-05 17:25:52.247 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC20T10_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:25:52.252 - runCommand: Process started, PID: 4462

2011-04-05 17:25:52.252 01078 LoadConfig()
2011-04-05 17:25:52.252 Requirement: ODSCC20
2011-04-05 17:25:52.252 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:25:52.256 - runCommand: Process started, PID: 4463

2011-04-05 17:25:52.257 01080 Comment: Syslog needs to be changed for this testcase. Ods.log is configured for local10 instead of local0

2011-04-05 17:25:52.257 Requirement: ODSCC20

2011-04-05 17:25:52.257 01082 Comment: Update all the configs.

2011-04-05 17:25:52.257 Requirement: ODSCC20

2011-04-05 17:25:52.257 01084 ODSSetup()
2011-04-05 17:25:52.257 Requirement: ODSCC20
2011-04-05 17:25:52.257 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:26:04.112 - runCommand: Process started, PID: 4464
2011-04-05 17:26:04.112 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:26:04.112 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:26:04.112 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:26:04.112 OUTPUT:	Repository SoftHSM found
2011-04-05 17:26:04.112 OUTPUT:	Capacity set to 10.
2011-04-05 17:26:04.112 OUTPUT:	RequireBackup set.
2011-04-05 17:26:04.112 OUTPUT:	Policy default2 found
2011-04-05 17:26:04.112 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:26:04.112 OUTPUT:	Policy default found
2011-04-05 17:26:04.112 OUTPUT:	Zone ods found
2011-04-05 17:26:04.112 OUTPUT:	Policy set to default.
2011-04-05 17:26:04.112 OUTPUT:	Added zone ods to database
2011-04-05 17:26:04.112 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:26:04.112 OUTPUT:	Policy set to default.
2011-04-05 17:26:04.112 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:26:04.112 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:26:04.112 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:26:04.112 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:26:04.113 01086 Wait(10)

2011-04-05 17:26:04.113 Requirement: ODSCC20

2011-04-05 17:26:14.113 01088 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:26:14.113 Requirement: ODSCC20

2011-04-05 17:26:14.114 01090 Start()
2011-04-05 17:26:14.114 Requirement: ODSCC20
2011-04-05 17:26:14.114 RunCommand(ods-control start)
2011-04-05 17:26:14.116 - runCommand: Background process started, PID: 4477
2011-04-05 17:26:15.133 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:26:15.153 - runCommand: Process started, PID: 4492
2011-04-05 17:26:15.153 OUTPUT:	ods-enforcerd
2011-04-05 17:26:15.153 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:26:15.173 - runCommand: Process started, PID: 4497
2011-04-05 17:26:15.173 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:26:15.173 01092 Comment: Sign the ods zone with the new configs.

2011-04-05 17:26:15.173 Requirement: ODSCC20

2011-04-05 17:26:15.173 01096 Wait(15)

2011-04-05 17:26:15.173 Requirement: ODSCC20

2011-04-05 17:26:30.174 01098 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:26:30.174 Requirement: ODSCC20

2011-04-05 17:26:30.174 01100 Stop()
2011-04-05 17:26:30.174 Requirement: ODSCC20
2011-04-05 17:26:30.174 RunCommand(ods-control stop)
2011-04-05 17:26:31.185 - runCommand: Process started, PID: 4514
2011-04-05 17:26:31.185 OUTPUT:	Stopping enforcer...
2011-04-05 17:26:31.185 OUTPUT:	Stopping signer engine..
2011-04-05 17:26:31.185 OUTPUT:	Engine shut down.
2011-04-05 17:26:31.185 RunCommand(ps -e | grep enforcer)
2011-04-05 17:26:31.201 - runCommand: Process started, PID: 4520
2011-04-05 17:26:31.201 ERROR:	return code = 1
2011-04-05 17:26:31.201 RunCommand(ps -e | grep signer)
2011-04-05 17:26:31.217 - runCommand: Process started, PID: 4523
2011-04-05 17:26:31.217 ERROR:	return code = 1

2011-04-05 17:26:31.217 01102 Comment: Check if the logging is unsuccesfull. If a notify (new zonefile update) is not available in the logging, thelogging is not succesfull.

2011-04-05 17:26:31.217 Requirement: ODSCC20

2011-04-05 17:26:31.218 01105 CheckLog()
2011-04-05 17:26:31.218 Requirement: ODSCC20
2011-04-05 17:26:32.806 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:26:30 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0

-------------------------------------------------------------------------------
Testcase - ODSCC20T30: Change the kasp.xml location and change PolicyFile in conf.xml accordingly

2011-04-05 17:26:32.807 01110 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:26:32.807 Requirement: ODSCC20

2011-04-05 17:26:32.807 01112 Stop()
2011-04-05 17:26:32.807 Requirement: ODSCC20
2011-04-05 17:26:32.807 RunCommand(ods-control stop)
2011-04-05 17:26:32.811 - runCommand: Process started, PID: 4526
2011-04-05 17:26:32.811 OUTPUT:	Stopping enforcer...
2011-04-05 17:26:32.811 OUTPUT:	Cannot find PID file
2011-04-05 17:26:32.811 OUTPUT:	Stopping signer engine..
2011-04-05 17:26:32.811 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:26:32.811 ERROR:	return code = 1
2011-04-05 17:26:32.811 RunCommand(ps -e | grep enforcer)
2011-04-05 17:26:32.821 - runCommand: Process started, PID: 4529
2011-04-05 17:26:32.821 ERROR:	return code = 1
2011-04-05 17:26:32.821 RunCommand(ps -e | grep signer)
2011-04-05 17:26:32.831 - runCommand: Process started, PID: 4532
2011-04-05 17:26:32.831 ERROR:	return code = 1

2011-04-05 17:26:32.831 01114 Wait(10)

2011-04-05 17:26:32.831 Requirement: ODSCC20

2011-04-05 17:26:42.832 01116 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:26:42.832 Requirement: ODSCC20

2011-04-05 17:26:42.832 01118 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:26:42.832 Requirement: ODSCC20
2011-04-05 17:26:42.832 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:26:42.838 - runCommand: Process started, PID: 4535

2011-04-05 17:26:42.838 01120 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:26:42.838 Requirement: ODSCC20
2011-04-05 17:26:42.838 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:26:42.843 - runCommand: Process started, PID: 4537
2011-04-05 17:26:42.843 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:26:42.843 ERROR:	return code = 1

2011-04-05 17:26:42.843 01122 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:26:42.843 Requirement: ODSCC20

2011-04-05 17:26:42.844 01125 PurgeHSM()
2011-04-05 17:26:42.844 Requirement: ODSCC20
2011-04-05 17:26:42.844 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:26:43.483 - runCommand: Process started, PID: 4539
2011-04-05 17:26:43.483 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:26:43.483 OUTPUT:	4 keys found.
2011-04-05 17:26:43.483 OUTPUT:	
2011-04-05 17:26:43.483 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:26:43.483 OUTPUT:	Starting purge...
2011-04-05 17:26:43.483 OUTPUT:	Key remove successful: 4996f23199fc03ab5cba9aa8bc6e2730
2011-04-05 17:26:43.483 OUTPUT:	Key remove successful: 8851cd9dbaa9de857ee0ee3c9654579e
2011-04-05 17:26:43.483 OUTPUT:	Key remove successful: d8c76711ee1de144ac112e29bce2aaba
2011-04-05 17:26:43.483 OUTPUT:	Key remove successful: bcfbf845223dfe159a612ac6760337df
2011-04-05 17:26:43.483 OUTPUT:	Purge done.

2011-04-05 17:26:43.484 01127 Wait(10)

2011-04-05 17:26:43.484 Requirement: ODSCC20

2011-04-05 17:26:53.484 01130 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:26:53.484 Requirement: ODSCC20

2011-04-05 17:26:53.485 01133 LoadConfig()
2011-04-05 17:26:53.485 Requirement: ODSCC20
2011-04-05 17:26:53.485 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC20T30_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:26:53.498 - runCommand: Process started, PID: 4543

2011-04-05 17:26:53.498 01135 Comment: Make a new directory a copy the kasp.xml file to that new folder.

2011-04-05 17:26:53.498 Requirement: ODSCC20

2011-04-05 17:26:53.499 01137 ExecuteCommand(mkdir /etc/opendnssec/odscc20t30)
2011-04-05 17:26:53.499 Requirement: ODSCC20
2011-04-05 17:26:53.499 RunCommand(mkdir /etc/opendnssec/odscc20t30)
2011-04-05 17:26:53.503 - runCommand: Process started, PID: 4544
2011-04-05 17:26:53.503 ERROR:	mkdir: cannot create directory `/etc/opendnssec/odscc20t30': File exists
2011-04-05 17:26:53.503 ERROR:	return code = 1

2011-04-05 17:26:53.503 01139 ExecuteCommand(cp /etc/opendnssec/kasp.xml /etc/opendnssec/odscc20t30/kasp.xml)
2011-04-05 17:26:53.504 Requirement: ODSCC20
2011-04-05 17:26:53.504 RunCommand(cp /etc/opendnssec/kasp.xml /etc/opendnssec/odscc20t30/kasp.xml)
2011-04-05 17:26:53.521 - runCommand: Process started, PID: 4545

2011-04-05 17:26:53.522 01141 Comment: Update all the configs.

2011-04-05 17:26:53.522 Requirement: ODSCC20

2011-04-05 17:26:53.522 01143 ODSSetup()
2011-04-05 17:26:53.522 Requirement: ODSCC20
2011-04-05 17:26:53.522 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:27:05.281 - runCommand: Process started, PID: 4546
2011-04-05 17:27:05.281 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:27:05.281 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:27:05.281 OUTPUT:	kasp filename set to /etc/opendnssec/odscc20t30/kasp.xml.
2011-04-05 17:27:05.281 OUTPUT:	Repository SoftHSM found
2011-04-05 17:27:05.281 OUTPUT:	Capacity set to 10.
2011-04-05 17:27:05.281 OUTPUT:	RequireBackup set.
2011-04-05 17:27:05.281 OUTPUT:	Policy default2 found
2011-04-05 17:27:05.281 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:27:05.281 OUTPUT:	Policy default found
2011-04-05 17:27:05.281 OUTPUT:	Zone ods found
2011-04-05 17:27:05.281 OUTPUT:	Policy set to default.
2011-04-05 17:27:05.281 OUTPUT:	Added zone ods to database
2011-04-05 17:27:05.281 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:27:05.281 OUTPUT:	Policy set to default.
2011-04-05 17:27:05.281 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:27:05.281 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:27:05.281 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:27:05.281 ERROR:	/etc/opendnssec/odscc20t30/kasp.xml validates

2011-04-05 17:27:05.282 01145 Wait(10)

2011-04-05 17:27:05.282 Requirement: ODSCC20

2011-04-05 17:27:15.282 01147 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:27:15.282 Requirement: ODSCC20

2011-04-05 17:27:15.282 01149 Start()
2011-04-05 17:27:15.282 Requirement: ODSCC20
2011-04-05 17:27:15.282 RunCommand(ods-control start)
2011-04-05 17:27:15.284 - runCommand: Background process started, PID: 4559
2011-04-05 17:27:16.308 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:27:16.334 - runCommand: Process started, PID: 4587
2011-04-05 17:27:16.334 OUTPUT:	ods-enforcerd
2011-04-05 17:27:16.334 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:27:16.350 - runCommand: Process started, PID: 4591
2011-04-05 17:27:16.350 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:27:16.350 01151 Comment: Sign the ods zone with the new configs.

2011-04-05 17:27:16.350 Requirement: ODSCC20

2011-04-05 17:27:16.350 01155 Wait(15)

2011-04-05 17:27:16.350 Requirement: ODSCC20

2011-04-05 17:27:31.351 01157 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:27:31.351 Requirement: ODSCC20

2011-04-05 17:27:31.351 01159 Stop()
2011-04-05 17:27:31.351 Requirement: ODSCC20
2011-04-05 17:27:31.351 RunCommand(ods-control stop)
2011-04-05 17:27:32.361 - runCommand: Process started, PID: 4596
2011-04-05 17:27:32.362 OUTPUT:	Stopping enforcer...
2011-04-05 17:27:32.362 OUTPUT:	Stopping signer engine..
2011-04-05 17:27:32.362 OUTPUT:	Engine shut down.
2011-04-05 17:27:32.362 RunCommand(ps -e | grep enforcer)
2011-04-05 17:27:32.378 - runCommand: Process started, PID: 4602
2011-04-05 17:27:32.378 ERROR:	return code = 1
2011-04-05 17:27:32.378 RunCommand(ps -e | grep signer)
2011-04-05 17:27:32.393 - runCommand: Process started, PID: 4605
2011-04-05 17:27:32.393 ERROR:	return code = 1

2011-04-05 17:27:32.394 01161 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:27:32.394 Requirement: ODSCC20

2011-04-05 17:27:32.394 01164 CheckLog()
2011-04-05 17:27:32.394 Requirement: ODSCC20
2011-04-05 17:27:33.975 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:27:31 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0

-------------------------------------------------------------------------------
Testcase - ODSCC20T40: Change the zonelist.xml location and change ZoneListFile in conf.xml accordingly

2011-04-05 17:27:33.976 01169 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:27:33.976 Requirement: ODSCC20

2011-04-05 17:27:33.976 01171 Stop()
2011-04-05 17:27:33.976 Requirement: ODSCC20
2011-04-05 17:27:33.976 RunCommand(ods-control stop)
2011-04-05 17:27:33.980 - runCommand: Process started, PID: 4608
2011-04-05 17:27:33.980 OUTPUT:	Stopping enforcer...
2011-04-05 17:27:33.980 OUTPUT:	Cannot find PID file
2011-04-05 17:27:33.980 OUTPUT:	Stopping signer engine..
2011-04-05 17:27:33.980 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:27:33.980 ERROR:	return code = 1
2011-04-05 17:27:33.981 RunCommand(ps -e | grep enforcer)
2011-04-05 17:27:33.990 - runCommand: Process started, PID: 4611
2011-04-05 17:27:33.990 ERROR:	return code = 1
2011-04-05 17:27:33.990 RunCommand(ps -e | grep signer)
2011-04-05 17:27:34.544 - runCommand: Process started, PID: 4615
2011-04-05 17:27:34.599 ERROR:	return code = 1

2011-04-05 17:27:34.835 01173 Wait(10)

2011-04-05 17:27:34.849 Requirement: ODSCC20

2011-04-05 17:27:44.130 01175 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:27:44.134 Requirement: ODSCC20

2011-04-05 17:27:44.169 01177 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:27:44.171 Requirement: ODSCC20
2011-04-05 17:27:44.173 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:27:44.736 - runCommand: Process started, PID: 4618

2011-04-05 17:27:44.779 01179 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:27:44.782 Requirement: ODSCC20
2011-04-05 17:27:44.784 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:27:44.125 - runCommand: Process started, PID: 4620
2011-04-05 17:27:44.126 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:27:44.126 ERROR:	return code = 1

2011-04-05 17:27:44.130 01181 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:27:44.130 Requirement: ODSCC20

2011-04-05 17:27:44.134 01184 PurgeHSM()
2011-04-05 17:27:44.134 Requirement: ODSCC20
2011-04-05 17:27:44.134 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:27:44.702 - runCommand: Process started, PID: 4623
2011-04-05 17:27:44.702 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:27:44.702 OUTPUT:	4 keys found.
2011-04-05 17:27:44.702 OUTPUT:	
2011-04-05 17:27:44.702 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:27:44.702 OUTPUT:	Starting purge...
2011-04-05 17:27:44.702 OUTPUT:	Key remove successful: 6b72362b1f0dacd9593520d4d45efe92
2011-04-05 17:27:44.702 OUTPUT:	Key remove successful: 6bc6bfb7555746a51572d29ea62a8fca
2011-04-05 17:27:44.702 OUTPUT:	Key remove successful: e0da8a1e57f13afccf8fcc9d7023406b
2011-04-05 17:27:44.702 OUTPUT:	Key remove successful: b004a3d42a9ca99d77d2a9b0a19a067f
2011-04-05 17:27:44.702 OUTPUT:	Purge done.

2011-04-05 17:27:44.702 01186 Wait(10)

2011-04-05 17:27:44.702 Requirement: ODSCC20

2011-04-05 17:27:54.703 01188 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:27:54.703 Requirement: ODSCC20

2011-04-05 17:27:54.703 01191 LoadConfig()
2011-04-05 17:27:54.703 Requirement: ODSCC20
2011-04-05 17:27:54.703 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC20T40_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:27:54.716 - runCommand: Process started, PID: 4627

2011-04-05 17:27:54.717 01193 Comment: Make a new directory a copy the ZoneListFile to that new folder.

2011-04-05 17:27:54.717 Requirement: ODSCC20

2011-04-05 17:27:54.717 01195 ExecuteCommand(mkdir /etc/opendnssec/odscc20t40)
2011-04-05 17:27:54.717 Requirement: ODSCC20
2011-04-05 17:27:54.717 RunCommand(mkdir /etc/opendnssec/odscc20t40)
2011-04-05 17:27:54.730 - runCommand: Process started, PID: 4628

2011-04-05 17:27:54.731 01197 ExecuteCommand(cp /etc/opendnssec/zonelist.xml /etc/opendnssec/odscc20t40/zonelist.xml)
2011-04-05 17:27:54.731 Requirement: ODSCC20
2011-04-05 17:27:54.731 RunCommand(cp /etc/opendnssec/zonelist.xml /etc/opendnssec/odscc20t40/zonelist.xml)
2011-04-05 17:27:54.735 - runCommand: Process started, PID: 4629

2011-04-05 17:27:54.735 01200 LoadConfig()
2011-04-05 17:27:54.735 Requirement: ODSCC20
2011-04-05 17:27:54.736 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:27:54.740 - runCommand: Process started, PID: 4630

2011-04-05 17:27:54.740 01202 Comment: Update all the configs.

2011-04-05 17:27:54.740 Requirement: ODSCC20

2011-04-05 17:27:54.740 01204 ODSSetup()
2011-04-05 17:27:54.740 Requirement: ODSCC20
2011-04-05 17:27:54.740 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:28:06.641 - runCommand: Process started, PID: 4631
2011-04-05 17:28:06.641 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:28:06.641 OUTPUT:	zonelist filename set to /etc/opendnssec/odscc20t40/zonelist.xml.
2011-04-05 17:28:06.641 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:28:06.641 OUTPUT:	Repository SoftHSM found
2011-04-05 17:28:06.641 OUTPUT:	Capacity set to 10.
2011-04-05 17:28:06.641 OUTPUT:	RequireBackup set.
2011-04-05 17:28:06.641 OUTPUT:	Policy default2 found
2011-04-05 17:28:06.641 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:28:06.641 OUTPUT:	Policy default found
2011-04-05 17:28:06.641 OUTPUT:	Zone ods found
2011-04-05 17:28:06.641 OUTPUT:	Policy set to default.
2011-04-05 17:28:06.641 OUTPUT:	Added zone ods to database
2011-04-05 17:28:06.641 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:28:06.641 OUTPUT:	Policy set to default.
2011-04-05 17:28:06.641 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:28:06.641 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:28:06.641 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:28:06.641 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:28:06.642 01206 Wait(10)

2011-04-05 17:28:06.642 Requirement: ODSCC20

2011-04-05 17:28:16.642 01208 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:28:16.642 Requirement: ODSCC20

2011-04-05 17:28:16.643 01210 Start()
2011-04-05 17:28:16.643 Requirement: ODSCC20
2011-04-05 17:28:16.643 RunCommand(ods-control start)
2011-04-05 17:28:16.645 - runCommand: Background process started, PID: 4644
2011-04-05 17:28:17.668 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:28:17.694 - runCommand: Process started, PID: 4672
2011-04-05 17:28:17.694 OUTPUT:	ods-enforcerd
2011-04-05 17:28:17.694 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:28:17.709 - runCommand: Process started, PID: 4676
2011-04-05 17:28:17.710 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:28:17.710 01212 Wait(10)

2011-04-05 17:28:17.710 Requirement: ODSCC20

2011-04-05 17:28:27.710 01214 Comment: Sign the ods zone with the new configs.

2011-04-05 17:28:27.710 Requirement: ODSCC20

2011-04-05 17:28:27.711 01218 Wait(15)

2011-04-05 17:28:27.711 Requirement: ODSCC20

2011-04-05 17:28:42.711 01220 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:28:42.711 Requirement: ODSCC20

2011-04-05 17:28:42.712 01222 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:28:42.712 Requirement: ODSCC20

2011-04-05 17:28:42.712 01224 Stop()
2011-04-05 17:28:42.712 Requirement: ODSCC20
2011-04-05 17:28:42.712 RunCommand(ods-control stop)
2011-04-05 17:28:43.722 - runCommand: Process started, PID: 4681
2011-04-05 17:28:43.722 OUTPUT:	Stopping enforcer...
2011-04-05 17:28:43.722 OUTPUT:	Stopping signer engine..
2011-04-05 17:28:43.722 OUTPUT:	Engine shut down.
2011-04-05 17:28:43.722 RunCommand(ps -e | grep enforcer)
2011-04-05 17:28:43.740 - runCommand: Process started, PID: 4687
2011-04-05 17:28:43.740 ERROR:	return code = 1
2011-04-05 17:28:43.740 RunCommand(ps -e | grep signer)
2011-04-05 17:28:43.753 - runCommand: Process started, PID: 4690
2011-04-05 17:28:43.753 ERROR:	return code = 1

2011-04-05 17:28:43.753 01227 CheckLog()
2011-04-05 17:28:43.753 Requirement: ODSCC20
2011-04-05 17:28:45.338 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:28:42 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0

-------------------------------------------------------------------------------
Testcase - ODSCC20T50: Change the zonefetch.xml location and change ZoneFetchFile in conf.xml accordingly

2011-04-05 17:28:45.338 01233 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:28:45.338 Requirement: ODSCC20

2011-04-05 17:28:45.338 01235 Stop()
2011-04-05 17:28:45.338 Requirement: ODSCC20
2011-04-05 17:28:45.338 RunCommand(ods-control stop)
2011-04-05 17:28:45.342 - runCommand: Process started, PID: 4693
2011-04-05 17:28:45.342 OUTPUT:	Stopping enforcer...
2011-04-05 17:28:45.342 OUTPUT:	Cannot find PID file
2011-04-05 17:28:45.342 OUTPUT:	Stopping signer engine..
2011-04-05 17:28:45.342 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:28:45.342 ERROR:	return code = 1
2011-04-05 17:28:45.343 RunCommand(ps -e | grep enforcer)
2011-04-05 17:28:45.352 - runCommand: Process started, PID: 4696
2011-04-05 17:28:45.352 ERROR:	return code = 1
2011-04-05 17:28:45.352 RunCommand(ps -e | grep signer)
2011-04-05 17:28:45.362 - runCommand: Process started, PID: 4699
2011-04-05 17:28:45.362 ERROR:	return code = 1

2011-04-05 17:28:45.362 01237 Wait(10)

2011-04-05 17:28:45.362 Requirement: ODSCC20

2011-04-05 17:28:55.363 01239 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:28:55.363 Requirement: ODSCC20

2011-04-05 17:28:55.363 01241 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:28:55.363 Requirement: ODSCC20
2011-04-05 17:28:55.363 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:28:55.369 - runCommand: Process started, PID: 4702

2011-04-05 17:28:55.369 01243 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:28:55.369 Requirement: ODSCC20
2011-04-05 17:28:55.369 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:28:55.374 - runCommand: Process started, PID: 4704
2011-04-05 17:28:55.374 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:28:55.374 ERROR:	return code = 1

2011-04-05 17:28:55.374 01245 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:28:55.374 Requirement: ODSCC20

2011-04-05 17:28:55.375 01248 PurgeHSM()
2011-04-05 17:28:55.375 Requirement: ODSCC20
2011-04-05 17:28:55.375 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:28:56.491 - runCommand: Process started, PID: 4706
2011-04-05 17:28:56.492 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:28:56.492 OUTPUT:	4 keys found.
2011-04-05 17:28:56.492 OUTPUT:	
2011-04-05 17:28:56.492 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:28:56.492 OUTPUT:	Starting purge...
2011-04-05 17:28:56.493 OUTPUT:	Key remove successful: 6f9a515343dd28479c2bfb170ae17900
2011-04-05 17:28:56.493 OUTPUT:	Key remove successful: 348b88dc609171d5e383244e992fbcf7
2011-04-05 17:28:56.493 OUTPUT:	Key remove successful: 27e578ddb8d596bacf820e18a7eb307f
2011-04-05 17:28:56.493 OUTPUT:	Key remove successful: ed05ced09f7e1c48b8261905df081e95
2011-04-05 17:28:56.493 OUTPUT:	Purge done.

2011-04-05 17:28:56.497 01250 Wait(10)

2011-04-05 17:28:56.497 Requirement: ODSCC20

2011-04-05 17:29:06.502 01253 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:29:06.503 Requirement: ODSCC20

2011-04-05 17:29:06.506 01256 LoadConfig()
2011-04-05 17:29:06.506 Requirement: ODSCC20
2011-04-05 17:29:06.507 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC20T50_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:29:06.638 - runCommand: Process started, PID: 4710

2011-04-05 17:29:06.642 01258 Comment: Make a new directory a copy the ZoneListFile to that new folder.

2011-04-05 17:29:06.642 Requirement: ODSCC20

2011-04-05 17:29:06.646 01260 ExecuteCommand(mkdir /etc/opendnssec/odscc20t50)
2011-04-05 17:29:06.646 Requirement: ODSCC20
2011-04-05 17:29:06.646 RunCommand(mkdir /etc/opendnssec/odscc20t50)
2011-04-05 17:29:06.687 - runCommand: Process started, PID: 4711

2011-04-05 17:29:06.691 01262 ExecuteCommand(cp /etc/opendnssec/zonelist.xml /etc/opendnssec/odscc20t50/zonelist.xml)
2011-04-05 17:29:06.692 Requirement: ODSCC20
2011-04-05 17:29:06.692 RunCommand(cp /etc/opendnssec/zonelist.xml /etc/opendnssec/odscc20t50/zonelist.xml)
2011-04-05 17:29:06.730 - runCommand: Process started, PID: 4712

2011-04-05 17:29:06.734 01265 LoadConfig()
2011-04-05 17:29:06.734 Requirement: ODSCC20
2011-04-05 17:29:06.735 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:29:06.805 - runCommand: Process started, PID: 4713

2011-04-05 17:29:06.810 01267 Comment: Update all the configs.

2011-04-05 17:29:06.810 Requirement: ODSCC20

2011-04-05 17:29:06.814 01269 ODSSetup()
2011-04-05 17:29:06.814 Requirement: ODSCC20
2011-04-05 17:29:06.814 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:29:17.771 - runCommand: Process started, PID: 4714
2011-04-05 17:29:17.771 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:29:17.771 OUTPUT:	zonelist filename set to /etc/opendnssec/odscc20t40/zonelist.xml.
2011-04-05 17:29:17.771 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:29:17.771 OUTPUT:	Repository SoftHSM found
2011-04-05 17:29:17.771 OUTPUT:	Capacity set to 10.
2011-04-05 17:29:17.771 OUTPUT:	RequireBackup set.
2011-04-05 17:29:17.771 OUTPUT:	Policy default2 found
2011-04-05 17:29:17.771 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:29:17.772 OUTPUT:	Policy default found
2011-04-05 17:29:17.772 OUTPUT:	Zone ods found
2011-04-05 17:29:17.772 OUTPUT:	Policy set to default.
2011-04-05 17:29:17.772 OUTPUT:	Added zone ods to database
2011-04-05 17:29:17.772 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:29:17.772 OUTPUT:	Policy set to default.
2011-04-05 17:29:17.772 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:29:17.772 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:29:17.772 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:29:17.772 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:29:17.772 01271 Wait(10)

2011-04-05 17:29:17.772 Requirement: ODSCC20

2011-04-05 17:29:27.773 01273 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:29:27.773 Requirement: ODSCC20

2011-04-05 17:29:27.773 01275 Start()
2011-04-05 17:29:27.773 Requirement: ODSCC20
2011-04-05 17:29:27.773 RunCommand(ods-control start)
2011-04-05 17:29:27.775 - runCommand: Background process started, PID: 4727
2011-04-05 17:29:28.791 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:29:28.818 - runCommand: Process started, PID: 4744
2011-04-05 17:29:28.818 OUTPUT:	ods-enforcerd
2011-04-05 17:29:28.818 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:29:28.839 - runCommand: Process started, PID: 4756
2011-04-05 17:29:28.839 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:29:28.839 01277 Wait(10)

2011-04-05 17:29:28.839 Requirement: ODSCC20

2011-04-05 17:29:38.839 01279 Comment: Sign the ods zone with the new configs.

2011-04-05 17:29:38.840 Requirement: ODSCC20

2011-04-05 17:29:38.840 01283 Wait(15)

2011-04-05 17:29:38.840 Requirement: ODSCC20

2011-04-05 17:29:53.840 01285 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:29:53.840 Requirement: ODSCC20

2011-04-05 17:29:53.841 01287 Stop()
2011-04-05 17:29:53.841 Requirement: ODSCC20
2011-04-05 17:29:53.841 RunCommand(ods-control stop)
2011-04-05 17:29:54.851 - runCommand: Process started, PID: 4763
2011-04-05 17:29:54.851 OUTPUT:	Stopping enforcer...
2011-04-05 17:29:54.851 OUTPUT:	Stopping signer engine..
2011-04-05 17:29:54.851 OUTPUT:	Engine shut down.
2011-04-05 17:29:54.851 RunCommand(ps -e | grep enforcer)
2011-04-05 17:29:54.868 - runCommand: Process started, PID: 4769
2011-04-05 17:29:54.868 ERROR:	return code = 1
2011-04-05 17:29:54.868 RunCommand(ps -e | grep signer)
2011-04-05 17:29:54.881 - runCommand: Process started, PID: 4772
2011-04-05 17:29:54.881 ERROR:	return code = 1

2011-04-05 17:29:54.881 01289 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:29:54.881 Requirement: ODSCC20

2011-04-05 17:29:54.882 01292 CheckLog()
2011-04-05 17:29:54.882 Requirement: ODSCC20
2011-04-05 17:29:56.472 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:29:53 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0
Testcondition - ODSCC30: The configuration of enforcer settings located in conf.xml should operate according to requirements and intentions
-------------------------------------------------------------------------------

-------------------------------------------------------------------------------
Testcase - ODSCC30T10: Use privileges test: test for enforcer in config only and check if enforcers fails to run

2011-04-05 17:29:56.473 01301 Comment: Privileges have been adjusted in the conf.xml

2011-04-05 17:29:56.473 Requirement: ODSCC30

2011-04-05 17:29:56.473 01303 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:29:56.473 Requirement: ODSCC30

2011-04-05 17:29:56.473 01305 Stop()
2011-04-05 17:29:56.473 Requirement: ODSCC30
2011-04-05 17:29:56.473 RunCommand(ods-control stop)
2011-04-05 17:29:56.477 - runCommand: Process started, PID: 4775
2011-04-05 17:29:56.477 OUTPUT:	Stopping enforcer...
2011-04-05 17:29:56.477 OUTPUT:	Cannot find PID file
2011-04-05 17:29:56.477 OUTPUT:	Stopping signer engine..
2011-04-05 17:29:56.477 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:29:56.477 ERROR:	return code = 1
2011-04-05 17:29:56.477 RunCommand(ps -e | grep enforcer)
2011-04-05 17:29:56.487 - runCommand: Process started, PID: 4778
2011-04-05 17:29:56.487 ERROR:	return code = 1
2011-04-05 17:29:56.487 RunCommand(ps -e | grep signer)
2011-04-05 17:29:56.497 - runCommand: Process started, PID: 4781
2011-04-05 17:29:56.497 ERROR:	return code = 1

2011-04-05 17:29:56.497 01307 Wait(10)

2011-04-05 17:29:56.497 Requirement: ODSCC30

2011-04-05 17:30:06.498 01309 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:30:06.498 Requirement: ODSCC30

2011-04-05 17:30:06.498 01311 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:30:06.498 Requirement: ODSCC30
2011-04-05 17:30:06.498 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:30:06.503 - runCommand: Process started, PID: 4784

2011-04-05 17:30:06.504 01313 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:30:06.504 Requirement: ODSCC30
2011-04-05 17:30:06.504 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:30:06.508 - runCommand: Process started, PID: 4786
2011-04-05 17:30:06.508 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:30:06.508 ERROR:	return code = 1

2011-04-05 17:30:06.509 01315 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:30:06.509 Requirement: ODSCC30

2011-04-05 17:30:06.509 01318 PurgeHSM()
2011-04-05 17:30:06.509 Requirement: ODSCC30
2011-04-05 17:30:06.509 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:30:07.179 - runCommand: Process started, PID: 4788
2011-04-05 17:30:07.179 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:30:07.179 OUTPUT:	4 keys found.
2011-04-05 17:30:07.179 OUTPUT:	
2011-04-05 17:30:07.179 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:30:07.179 OUTPUT:	Starting purge...
2011-04-05 17:30:07.179 OUTPUT:	Key remove successful: f052f5b54e69b6d0c01e77ab23d343d6
2011-04-05 17:30:07.179 OUTPUT:	Key remove successful: 842dfacf70e93d5c3e5f1e50249fd4a5
2011-04-05 17:30:07.179 OUTPUT:	Key remove successful: 12e71d82a5aa57f4378a8af6563223e0
2011-04-05 17:30:07.179 OUTPUT:	Key remove successful: b9508574360acc02cc0a7b4b5787004f
2011-04-05 17:30:07.179 OUTPUT:	Purge done.

2011-04-05 17:30:07.180 01320 Wait(10)

2011-04-05 17:30:07.180 Requirement: ODSCC30

2011-04-05 17:30:17.180 01322 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:30:17.180 Requirement: ODSCC30

2011-04-05 17:30:17.180 01325 LoadConfig()
2011-04-05 17:30:17.180 Requirement: ODSCC30
2011-04-05 17:30:17.180 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC30T10_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:30:17.193 - runCommand: Process started, PID: 4792

2011-04-05 17:30:17.194 01328 LoadConfig()
2011-04-05 17:30:17.194 Requirement: ODSCC30
2011-04-05 17:30:17.194 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:30:17.198 - runCommand: Process started, PID: 4793

2011-04-05 17:30:17.199 01330 Comment: 

2011-04-05 17:30:17.199 Requirement: ODSCC30

2011-04-05 17:30:17.199 01332 Comment: Update all the configs.

2011-04-05 17:30:17.199 Requirement: ODSCC30

2011-04-05 17:30:17.199 01334 ODSSetup()
2011-04-05 17:30:17.199 Requirement: ODSCC30
2011-04-05 17:30:17.200 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:30:28.918 - runCommand: Process started, PID: 4794
2011-04-05 17:30:28.918 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:30:28.918 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:30:28.918 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:30:28.918 OUTPUT:	Repository SoftHSM found
2011-04-05 17:30:28.918 OUTPUT:	Capacity set to 10.
2011-04-05 17:30:28.918 OUTPUT:	RequireBackup set.
2011-04-05 17:30:28.918 OUTPUT:	Policy default2 found
2011-04-05 17:30:28.918 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:30:28.918 OUTPUT:	Policy default found
2011-04-05 17:30:28.918 OUTPUT:	Zone ods found
2011-04-05 17:30:28.918 OUTPUT:	Policy set to default.
2011-04-05 17:30:28.918 OUTPUT:	Added zone ods to database
2011-04-05 17:30:28.918 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:30:28.918 OUTPUT:	Policy set to default.
2011-04-05 17:30:28.919 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:30:28.919 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:30:28.919 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:30:28.919 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:30:28.919 01336 Wait(10)

2011-04-05 17:30:28.919 Requirement: ODSCC30

2011-04-05 17:30:38.919 01338 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:30:38.919 Requirement: ODSCC30

2011-04-05 17:30:38.920 01340 Start()
2011-04-05 17:30:38.920 Requirement: ODSCC30
2011-04-05 17:30:38.920 RunCommand(ods-control start)
2011-04-05 17:30:38.922 - runCommand: Background process started, PID: 4807
2011-04-05 17:30:39.940 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:30:39.958 - runCommand: Process started, PID: 4822
2011-04-05 17:30:39.958 OUTPUT:	ods-enforcerd
2011-04-05 17:30:39.958 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:30:39.974 - runCommand: Process started, PID: 4826
2011-04-05 17:30:39.974 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:30:39.974 01342 Wait(10)

2011-04-05 17:30:39.974 Requirement: ODSCC30

2011-04-05 17:30:49.975 01345 Wait(15)

2011-04-05 17:30:49.975 Requirement: ODSCC30

2011-04-05 17:31:04.975 01347 Comment: The Enforcer should fail to run when restarting ODS with the new conf.xml.

2011-04-05 17:31:04.975 Requirement: ODSCC30

2011-04-05 17:31:04.975 01349 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:31:04.975 Requirement: ODSCC30

2011-04-05 17:31:04.976 01351 Stop()
2011-04-05 17:31:04.976 Requirement: ODSCC30
2011-04-05 17:31:04.976 RunCommand(ods-control stop)
2011-04-05 17:31:05.986 - runCommand: Process started, PID: 4844
2011-04-05 17:31:05.986 OUTPUT:	Stopping enforcer...
2011-04-05 17:31:05.986 OUTPUT:	Stopping signer engine..
2011-04-05 17:31:05.986 OUTPUT:	Engine shut down.
2011-04-05 17:31:05.986 RunCommand(ps -e | grep enforcer)
2011-04-05 17:31:06.230 - runCommand: Process started, PID: 4850
2011-04-05 17:31:06.239 ERROR:	return code = 1
2011-04-05 17:31:06.242 RunCommand(ps -e | grep signer)
2011-04-05 17:31:06.149 - runCommand: Process started, PID: 4853
2011-04-05 17:31:06.149 ERROR:	return code = 1

2011-04-05 17:31:06.152 01354 CheckLog()
2011-04-05 17:31:06.152 Requirement: ODSCC30
2011-04-05 17:31:07.607 FAILED:	(Check for Like) - Expected: User opendnssec1 does not exist Found: 

2011-04-05 17:31:07.607 01357 CheckLog()
2011-04-05 17:31:07.607 Requirement: ODSCC30
2011-04-05 17:31:09.187 FAILED:	(Check for Like) - Expected: Can't change to opendnssec1, opendnssec to check DB write permissions Found: 

-------------------------------------------------------------------------------
Testcase - ODSCC30T20: Use privileges test: test for enforcer and kasp.db and check if enforcers runs without errors

2011-04-05 17:31:09.188 01363 Comment: Privileges have been adjusted in the conf.xml

2011-04-05 17:31:09.188 Requirement: ODSCC30

2011-04-05 17:31:09.188 01365 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:31:09.188 Requirement: ODSCC30

2011-04-05 17:31:09.188 01367 Stop()
2011-04-05 17:31:09.188 Requirement: ODSCC30
2011-04-05 17:31:09.188 RunCommand(ods-control stop)
2011-04-05 17:31:09.193 - runCommand: Process started, PID: 4856
2011-04-05 17:31:09.193 OUTPUT:	Stopping enforcer...
2011-04-05 17:31:09.193 OUTPUT:	Cannot find PID file
2011-04-05 17:31:09.193 OUTPUT:	Stopping signer engine..
2011-04-05 17:31:09.193 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:31:09.193 ERROR:	return code = 1
2011-04-05 17:31:09.193 RunCommand(ps -e | grep enforcer)
2011-04-05 17:31:09.204 - runCommand: Process started, PID: 4859
2011-04-05 17:31:09.204 ERROR:	return code = 1
2011-04-05 17:31:09.204 RunCommand(ps -e | grep signer)
2011-04-05 17:31:09.216 - runCommand: Process started, PID: 4862
2011-04-05 17:31:09.216 ERROR:	return code = 1

2011-04-05 17:31:09.216 01369 Wait(10)

2011-04-05 17:31:09.216 Requirement: ODSCC30

2011-04-05 17:31:19.217 01371 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:31:19.217 Requirement: ODSCC30

2011-04-05 17:31:19.217 01373 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:31:19.217 Requirement: ODSCC30
2011-04-05 17:31:19.217 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:31:19.222 - runCommand: Process started, PID: 4865

2011-04-05 17:31:19.223 01375 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:31:19.223 Requirement: ODSCC30
2011-04-05 17:31:19.223 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:31:19.228 - runCommand: Process started, PID: 4867
2011-04-05 17:31:19.228 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:31:19.228 ERROR:	return code = 1

2011-04-05 17:31:19.228 01377 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:31:19.228 Requirement: ODSCC30

2011-04-05 17:31:19.228 01380 PurgeHSM()
2011-04-05 17:31:19.228 Requirement: ODSCC30
2011-04-05 17:31:19.228 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:31:19.867 - runCommand: Process started, PID: 4869
2011-04-05 17:31:19.867 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:31:19.867 OUTPUT:	4 keys found.
2011-04-05 17:31:19.867 OUTPUT:	
2011-04-05 17:31:19.867 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:31:19.867 OUTPUT:	Starting purge...
2011-04-05 17:31:19.867 OUTPUT:	Key remove successful: 91c09d4e7f1f1bf62e3d04e3c7b5c1c4
2011-04-05 17:31:19.867 OUTPUT:	Key remove successful: 3d3464584e2da942d8b38b16d4382da8
2011-04-05 17:31:19.867 OUTPUT:	Key remove successful: c5ef6b09874d0d82d613b4926e30744e
2011-04-05 17:31:19.867 OUTPUT:	Key remove successful: c2c2dfba07f986cc2cf22d881d3aeea9
2011-04-05 17:31:19.867 OUTPUT:	Purge done.

2011-04-05 17:31:19.867 01382 Wait(10)

2011-04-05 17:31:19.867 Requirement: ODSCC30

2011-04-05 17:31:29.868 01384 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:31:29.868 Requirement: ODSCC30

2011-04-05 17:31:29.868 01387 LoadConfig()
2011-04-05 17:31:29.868 Requirement: ODSCC30
2011-04-05 17:31:29.868 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC30T20_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:31:29.881 - runCommand: Process started, PID: 4873

2011-04-05 17:31:29.882 01390 LoadConfig()
2011-04-05 17:31:29.882 Requirement: ODSCC30
2011-04-05 17:31:29.882 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:31:29.886 - runCommand: Process started, PID: 4874

2011-04-05 17:31:29.887 01392 Comment: 

2011-04-05 17:31:29.887 Requirement: ODSCC30

2011-04-05 17:31:29.887 01394 Comment: Update all the configs.

2011-04-05 17:31:29.887 Requirement: ODSCC30

2011-04-05 17:31:29.887 01396 ODSSetup()
2011-04-05 17:31:29.887 Requirement: ODSCC30
2011-04-05 17:31:29.887 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:31:41.656 - runCommand: Process started, PID: 4875
2011-04-05 17:31:41.656 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:31:41.656 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:31:41.656 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:31:41.656 OUTPUT:	Repository SoftHSM found
2011-04-05 17:31:41.656 OUTPUT:	Capacity set to 10.
2011-04-05 17:31:41.656 OUTPUT:	RequireBackup set.
2011-04-05 17:31:41.656 OUTPUT:	Policy default2 found
2011-04-05 17:31:41.656 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:31:41.656 OUTPUT:	Policy default found
2011-04-05 17:31:41.656 OUTPUT:	Zone ods found
2011-04-05 17:31:41.656 OUTPUT:	Policy set to default.
2011-04-05 17:31:41.656 OUTPUT:	Added zone ods to database
2011-04-05 17:31:41.656 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:31:41.656 OUTPUT:	Policy set to default.
2011-04-05 17:31:41.656 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:31:41.656 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:31:41.656 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:31:41.656 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:31:41.656 01398 Wait(10)

2011-04-05 17:31:41.656 Requirement: ODSCC30

2011-04-05 17:31:51.657 01400 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:31:51.657 Requirement: ODSCC30

2011-04-05 17:31:51.657 01402 Start()
2011-04-05 17:31:51.657 Requirement: ODSCC30
2011-04-05 17:31:51.657 RunCommand(ods-control start)
2011-04-05 17:31:51.659 - runCommand: Background process started, PID: 4889
2011-04-05 17:31:56.692 ERROR:	return code = 1
2011-04-05 17:31:56.692 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:31:56.710 - runCommand: Process started, PID: 4909
2011-04-05 17:31:56.710 ERROR:	return code = 1
2011-04-05 17:31:56.710 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:31:56.725 - runCommand: Process started, PID: 4913

2011-04-05 17:31:56.725 01404 Wait(10)

2011-04-05 17:31:56.725 Requirement: ODSCC30

2011-04-05 17:32:06.725 01407 Comment: The Enforcer should start up succesfully when restarting ODS with the new conf.xml.

2011-04-05 17:32:06.725 Requirement: ODSCC30

2011-04-05 17:32:06.726 01410 CheckLog()
2011-04-05 17:32:06.726 Requirement: ODSCC30
2011-04-05 17:32:08.323 FAILED:	(Check for Like) - Expected: enforcer started Found: 

2011-04-05 17:32:08.323 01413 CheckLog()
2011-04-05 17:32:08.323 Requirement: ODSCC30
2011-04-05 17:32:09.912 FAILED:	(Check for Like) - Expected: SQLite database set to: /var/lib/opendnssec/db/kasp.db Found: 

-------------------------------------------------------------------------------
Testcase - ODSCC30T30: Change the kasp.db location and change Datastore in conf.xml accordingly

2011-04-05 17:32:09.913 01420 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:32:09.913 Requirement: ODSCC30

2011-04-05 17:32:09.913 01422 Stop()
2011-04-05 17:32:09.913 Requirement: ODSCC30
2011-04-05 17:32:09.913 RunCommand(ods-control stop)
2011-04-05 17:32:09.917 - runCommand: Process started, PID: 4919
2011-04-05 17:32:09.917 OUTPUT:	Stopping enforcer...
2011-04-05 17:32:09.917 OUTPUT:	Cannot find PID file
2011-04-05 17:32:09.917 OUTPUT:	Stopping signer engine..
2011-04-05 17:32:09.917 ERROR:	Unable to connect to engine: connect() failed: No such file or directory
2011-04-05 17:32:09.917 ERROR:	return code = 1
2011-04-05 17:32:09.917 RunCommand(ps -e | grep enforcer)
2011-04-05 17:32:09.927 - runCommand: Process started, PID: 4922
2011-04-05 17:32:09.927 ERROR:	return code = 1
2011-04-05 17:32:09.927 RunCommand(ps -e | grep signer)
2011-04-05 17:32:09.937 - runCommand: Process started, PID: 4925
2011-04-05 17:32:09.937 ERROR:	return code = 1

2011-04-05 17:32:09.937 01424 Wait(10)

2011-04-05 17:32:09.937 Requirement: ODSCC30

2011-04-05 17:32:19.938 01426 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:32:19.938 Requirement: ODSCC30

2011-04-05 17:32:19.938 01428 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:32:19.938 Requirement: ODSCC30
2011-04-05 17:32:19.938 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:32:19.944 - runCommand: Process started, PID: 4928
2011-04-05 17:32:19.944 ERROR:	rm: cannot remove `/var/opendnssec/tmp/*': No such file or directory
2011-04-05 17:32:19.944 ERROR:	return code = 1

2011-04-05 17:32:19.944 01430 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:32:19.944 Requirement: ODSCC30
2011-04-05 17:32:19.944 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:32:19.949 - runCommand: Process started, PID: 4930
2011-04-05 17:32:19.949 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:32:19.949 ERROR:	return code = 1

2011-04-05 17:32:19.949 01432 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:32:19.949 Requirement: ODSCC30

2011-04-05 17:32:19.950 01435 PurgeHSM()
2011-04-05 17:32:19.950 Requirement: ODSCC30
2011-04-05 17:32:19.950 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:32:19.964 - runCommand: Process started, PID: 4932
2011-04-05 17:32:19.964 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:32:19.964 OUTPUT:	0 keys found.
2011-04-05 17:32:19.964 ERROR:	return code = 255

2011-04-05 17:32:19.965 01437 Wait(10)

2011-04-05 17:32:19.965 Requirement: ODSCC30

2011-04-05 17:32:29.965 01439 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:32:29.965 Requirement: ODSCC30

2011-04-05 17:32:29.965 01442 LoadConfig()
2011-04-05 17:32:29.965 Requirement: ODSCC30
2011-04-05 17:32:29.965 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC30T30_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:32:29.984 - runCommand: Process started, PID: 4936

2011-04-05 17:32:29.984 01444 Comment: Make a new directory a copy the kasp.db file to that new folder.

2011-04-05 17:32:29.984 Requirement: ODSCC30

2011-04-05 17:32:29.985 01446 ExecuteCommand(mkdir /var/opendnssec/odscc30t30)
2011-04-05 17:32:29.985 Requirement: ODSCC30
2011-04-05 17:32:29.985 RunCommand(mkdir /var/opendnssec/odscc30t30)
2011-04-05 17:32:29.989 - runCommand: Process started, PID: 4937

2011-04-05 17:32:29.989 01448 ExecuteCommand(cp /var/opendnssec/kasp.db /var/opendnssec/odscc30t30/kasp.db)
2011-04-05 17:32:29.989 Requirement: ODSCC30
2011-04-05 17:32:29.989 RunCommand(cp /var/opendnssec/kasp.db /var/opendnssec/odscc30t30/kasp.db)
2011-04-05 17:32:29.996 - runCommand: Process started, PID: 4938

2011-04-05 17:32:29.996 01451 LoadConfig()
2011-04-05 17:32:29.996 Requirement: ODSCC30
2011-04-05 17:32:29.996 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:32:29.999 - runCommand: Process started, PID: 4939

2011-04-05 17:32:29.999 01453 Comment: Update all the configs.

2011-04-05 17:32:29.999 Requirement: ODSCC30

2011-04-05 17:32:29.999 01455 ODSSetup()
2011-04-05 17:32:29.999 Requirement: ODSCC30
2011-04-05 17:32:29.999 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:32:40.598 - runCommand: Process started, PID: 4940
2011-04-05 17:32:40.598 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/odscc30t30/kasp.db
2011-04-05 17:32:40.598 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:32:40.598 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:32:40.598 OUTPUT:	Repository SoftHSM found
2011-04-05 17:32:40.599 OUTPUT:	Capacity set to 10.
2011-04-05 17:32:40.599 OUTPUT:	RequireBackup set.
2011-04-05 17:32:40.599 OUTPUT:	Policy default2 found
2011-04-05 17:32:40.599 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:32:40.599 OUTPUT:	Policy default found
2011-04-05 17:32:40.599 OUTPUT:	Zone ods found
2011-04-05 17:32:40.599 OUTPUT:	Policy set to default.
2011-04-05 17:32:40.599 OUTPUT:	Added zone ods to database
2011-04-05 17:32:40.599 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:32:40.599 OUTPUT:	Policy set to default.
2011-04-05 17:32:40.599 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:32:40.599 ERROR:	SQLite database set to: /var/opendnssec/odscc30t30/kasp.db
2011-04-05 17:32:40.599 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:32:40.599 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:32:40.599 01457 Wait(10)

2011-04-05 17:32:40.599 Requirement: ODSCC30

2011-04-05 17:32:50.600 01459 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:32:50.600 Requirement: ODSCC30

2011-04-05 17:32:50.600 01461 Start()
2011-04-05 17:32:50.600 Requirement: ODSCC30
2011-04-05 17:32:50.600 RunCommand(ods-control start)
2011-04-05 17:32:50.602 - runCommand: Background process started, PID: 4953
2011-04-05 17:32:51.619 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:32:51.637 - runCommand: Process started, PID: 4968
2011-04-05 17:32:51.637 OUTPUT:	ods-enforcerd
2011-04-05 17:32:51.637 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:32:51.658 - runCommand: Process started, PID: 4973
2011-04-05 17:32:51.658 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:32:51.658 01463 Wait(10)

2011-04-05 17:32:51.658 Requirement: ODSCC30

2011-04-05 17:33:01.659 01466 CheckLog()
2011-04-05 17:33:01.659 Requirement: ODSCC30
2011-04-05 17:33:03.259 FAILED:	(Check for Like) - Expected: SQLite database set to: /var/lib/opendnssec/odscc30t30/kasp.db Found: 

2011-04-05 17:33:03.259 01468 Comment: Sign the ods zone with the new configs.

2011-04-05 17:33:03.259 Requirement: ODSCC30

2011-04-05 17:33:03.259 01472 Wait(15)

2011-04-05 17:33:03.259 Requirement: ODSCC30

2011-04-05 17:33:18.260 01474 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:33:18.260 Requirement: ODSCC30

2011-04-05 17:33:18.260 01476 Stop()
2011-04-05 17:33:18.260 Requirement: ODSCC30
2011-04-05 17:33:18.260 RunCommand(ods-control stop)
2011-04-05 17:33:19.270 - runCommand: Process started, PID: 4990
2011-04-05 17:33:19.270 OUTPUT:	Stopping enforcer...
2011-04-05 17:33:19.270 OUTPUT:	Stopping signer engine..
2011-04-05 17:33:19.270 OUTPUT:	Engine shut down.
2011-04-05 17:33:19.270 RunCommand(ps -e | grep enforcer)
2011-04-05 17:33:19.282 - runCommand: Process started, PID: 4996
2011-04-05 17:33:19.282 ERROR:	return code = 1
2011-04-05 17:33:19.282 RunCommand(ps -e | grep signer)
2011-04-05 17:33:19.295 - runCommand: Process started, PID: 4999
2011-04-05 17:33:19.295 ERROR:	return code = 1

2011-04-05 17:33:19.296 01478 Comment: Check if the signing was succesfull. If a notify (new zonefile update) is available in the logging, the signing was succesful.

2011-04-05 17:33:19.296 Requirement: ODSCC30

2011-04-05 17:33:19.296 01481 CheckLog()
2011-04-05 17:33:19.296 Requirement: ODSCC30
2011-04-05 17:33:20.873 PASSED:	(Check for Like) - Expected: all done! Found: Apr  5 17:33:18 DEVELOPER15 ods-enforcerd: all done! hsm_close result: 0

-------------------------------------------------------------------------------
Testcase - ODSCC30T40: Change the Interval to 60 seconds and check if the enforcer runs every minute

2011-04-05 17:33:20.874 01486 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:33:20.874 Requirement: ODSCC30

2011-04-05 17:33:20.874 01488 Stop()
2011-04-05 17:33:20.874 Requirement: ODSCC30
2011-04-05 17:33:20.874 RunCommand(ods-control stop)
2011-04-05 17:33:20.878 - runCommand: Process started, PID: 5002
2011-04-05 17:33:20.878 OUTPUT:	Stopping enforcer...
2011-04-05 17:33:20.878 OUTPUT:	Cannot find PID file
2011-04-05 17:33:20.878 OUTPUT:	Stopping signer engine..
2011-04-05 17:33:20.878 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:33:20.878 ERROR:	return code = 1
2011-04-05 17:33:20.878 RunCommand(ps -e | grep enforcer)
2011-04-05 17:33:20.888 - runCommand: Process started, PID: 5005
2011-04-05 17:33:20.888 ERROR:	return code = 1
2011-04-05 17:33:20.888 RunCommand(ps -e | grep signer)
2011-04-05 17:33:20.899 - runCommand: Process started, PID: 5009
2011-04-05 17:33:20.899 ERROR:	return code = 1

2011-04-05 17:33:20.899 01490 Wait(10)

2011-04-05 17:33:20.899 Requirement: ODSCC30

2011-04-05 17:33:30.900 01492 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:33:30.900 Requirement: ODSCC30

2011-04-05 17:33:30.900 01494 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:33:30.900 Requirement: ODSCC30
2011-04-05 17:33:30.900 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:33:30.905 - runCommand: Process started, PID: 5012

2011-04-05 17:33:30.906 01496 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:33:30.906 Requirement: ODSCC30
2011-04-05 17:33:30.906 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:33:30.911 - runCommand: Process started, PID: 5014
2011-04-05 17:33:30.911 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:33:30.911 ERROR:	return code = 1

2011-04-05 17:33:30.911 01498 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:33:30.911 Requirement: ODSCC30

2011-04-05 17:33:30.911 01501 PurgeHSM()
2011-04-05 17:33:30.911 Requirement: ODSCC30
2011-04-05 17:33:30.911 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:33:31.549 - runCommand: Process started, PID: 5016
2011-04-05 17:33:31.549 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:33:31.549 OUTPUT:	4 keys found.
2011-04-05 17:33:31.549 OUTPUT:	
2011-04-05 17:33:31.549 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:33:31.549 OUTPUT:	Starting purge...
2011-04-05 17:33:31.549 OUTPUT:	Key remove successful: 22d5ca166a8f35ac322f4afbc78dcf96
2011-04-05 17:33:31.549 OUTPUT:	Key remove successful: 2115aecb5482025aeda050628b2bf30e
2011-04-05 17:33:31.549 OUTPUT:	Key remove successful: 5961405b6b99dcb4294e089d7d81d4f0
2011-04-05 17:33:31.549 OUTPUT:	Key remove successful: aee9d38c5e9700c977c0ddf0377c2587
2011-04-05 17:33:31.549 OUTPUT:	Purge done.

2011-04-05 17:33:31.550 01503 Wait(10)

2011-04-05 17:33:31.550 Requirement: ODSCC30

2011-04-05 17:33:41.550 01506 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:33:41.550 Requirement: ODSCC30

2011-04-05 17:33:41.551 01509 LoadConfig()
2011-04-05 17:33:41.551 Requirement: ODSCC30
2011-04-05 17:33:41.551 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC30T40_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:33:41.564 - runCommand: Process started, PID: 5020

2011-04-05 17:33:41.565 01511 Comment: Make a new directory a copy the ZoneListFile to that new folder.

2011-04-05 17:33:41.565 Requirement: ODSCC30

2011-04-05 17:33:41.565 01515 LoadConfig()
2011-04-05 17:33:41.565 Requirement: ODSCC30
2011-04-05 17:33:41.565 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:33:41.569 - runCommand: Process started, PID: 5021

2011-04-05 17:33:41.570 01517 Comment: Update all the configs.

2011-04-05 17:33:41.570 Requirement: ODSCC30

2011-04-05 17:33:41.570 01519 ODSSetup()
2011-04-05 17:33:41.570 Requirement: ODSCC30
2011-04-05 17:33:41.570 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:33:53.422 - runCommand: Process started, PID: 5022
2011-04-05 17:33:53.422 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] fixing permissions on file /var/opendnssec/kasp.db
2011-04-05 17:33:53.422 OUTPUT:	zonelist filename set to /etc/opendnssec/zonelist.xml.
2011-04-05 17:33:53.422 OUTPUT:	kasp filename set to /etc/opendnssec/kasp.xml.
2011-04-05 17:33:53.422 OUTPUT:	Repository SoftHSM found
2011-04-05 17:33:53.422 OUTPUT:	Capacity set to 10.
2011-04-05 17:33:53.422 OUTPUT:	RequireBackup set.
2011-04-05 17:33:53.422 OUTPUT:	Policy default2 found
2011-04-05 17:33:53.422 OUTPUT:	Info: converting P1Y to seconds; M interpreted as 31 days, Y interpreted as 365 days
2011-04-05 17:33:53.422 OUTPUT:	Policy default found
2011-04-05 17:33:53.422 OUTPUT:	Zone ods found
2011-04-05 17:33:53.422 OUTPUT:	Policy set to default.
2011-04-05 17:33:53.422 OUTPUT:	Added zone ods to database
2011-04-05 17:33:53.422 OUTPUT:	Zone odszc10t10.nl found
2011-04-05 17:33:53.422 OUTPUT:	Policy set to default.
2011-04-05 17:33:53.422 OUTPUT:	Added zone odszc10t10.nl to database
2011-04-05 17:33:53.422 ERROR:	SQLite database set to: /var/opendnssec/kasp.db
2011-04-05 17:33:53.422 ERROR:	/etc/opendnssec/conf.xml validates
2011-04-05 17:33:53.422 ERROR:	/etc/opendnssec/kasp.xml validates

2011-04-05 17:33:53.423 01521 Wait(10)

2011-04-05 17:33:53.423 Requirement: ODSCC30

2011-04-05 17:34:03.423 01523 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:34:03.423 Requirement: ODSCC30

2011-04-05 17:34:03.424 01525 Start()
2011-04-05 17:34:03.424 Requirement: ODSCC30
2011-04-05 17:34:03.424 RunCommand(ods-control start)
2011-04-05 17:34:03.426 - runCommand: Background process started, PID: 5037
2011-04-05 17:34:04.443 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:34:04.467 - runCommand: Process started, PID: 5052
2011-04-05 17:34:04.467 OUTPUT:	ods-enforcerd
2011-04-05 17:34:04.467 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:34:04.484 - runCommand: Process started, PID: 5069
2011-04-05 17:34:04.484 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:34:04.484 01527 Wait(10)

2011-04-05 17:34:04.484 Requirement: ODSCC30

2011-04-05 17:34:14.485 01529 Comment: Check each minute if the enforcer is running.

2011-04-05 17:34:14.485 Requirement: ODSCC30

2011-04-05 17:34:14.485 01532 CheckLog()
2011-04-05 17:34:14.485 Requirement: ODSCC30
2011-04-05 17:34:16.826 PASSED:	(Check for Like) - Expected: ods-enforcerd: Reading config "/etc/opendnssec/conf.xml" Found: Apr  5 17:34:03 DEVELOPER15 ods-enforcerd: Reading config "/etc/opendnssec/conf.xml"

2011-04-05 17:34:16.828 01534 Wait(60)

2011-04-05 17:34:16.828 Requirement: ODSCC30

2011-04-05 17:35:16.833 01537 CheckLog()
2011-04-05 17:35:16.833 Requirement: ODSCC30
2011-04-05 17:35:17.680 PASSED:	(Check for Like) - Expected: ods-enforcerd: Reading config "/etc/opendnssec/conf.xml" Found: Apr  5 17:35:06 DEVELOPER15 ods-enforcerd: Reading config "/etc/opendnssec/conf.xml"

2011-04-05 17:35:17.681 01539 Wait(60)

2011-04-05 17:35:17.681 Requirement: ODSCC30

2011-04-05 17:36:17.681 01542 CheckLog()
2011-04-05 17:36:17.681 Requirement: ODSCC30
2011-04-05 17:36:19.280 PASSED:	(Check for Like) - Expected: ods-enforcerd: Reading config "/etc/opendnssec/conf.xml" Found: Apr  5 17:36:06 DEVELOPER15 ods-enforcerd: Reading config "/etc/opendnssec/conf.xml"

2011-04-05 17:36:19.280 01544 Wait(60)

2011-04-05 17:36:19.280 Requirement: ODSCC30

2011-04-05 17:37:19.280 01547 CheckLog()
2011-04-05 17:37:19.280 Requirement: ODSCC30
2011-04-05 17:37:20.887 PASSED:	(Check for Like) - Expected: ods-enforcerd: Reading config "/etc/opendnssec/conf.xml" Found: Apr  5 17:37:06 DEVELOPER15 ods-enforcerd: Reading config "/etc/opendnssec/conf.xml"
Testcondition - ODSCC40: The datastore settings located in conf.xml should be configurable with different credentials
-------------------------------------------------------------------------------

-------------------------------------------------------------------------------
Testcase - ODSCC40T10: Change port of database and check if enforcer fails to connect

2011-04-05 17:37:20.888 01554 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:37:20.888 Requirement: ODSCC40

2011-04-05 17:37:20.888 01556 Stop()
2011-04-05 17:37:20.888 Requirement: ODSCC40
2011-04-05 17:37:20.888 RunCommand(ods-control stop)
2011-04-05 17:37:21.896 - runCommand: Process started, PID: 5078
2011-04-05 17:37:21.896 OUTPUT:	Stopping enforcer...
2011-04-05 17:37:21.896 OUTPUT:	Stopping signer engine..
2011-04-05 17:37:21.896 OUTPUT:	Engine shut down.
2011-04-05 17:37:21.896 RunCommand(ps -e | grep enforcer)
2011-04-05 17:37:21.914 - runCommand: Process started, PID: 5084
2011-04-05 17:37:21.914 ERROR:	return code = 1
2011-04-05 17:37:21.914 RunCommand(ps -e | grep signer)
2011-04-05 17:37:21.926 - runCommand: Process started, PID: 5087
2011-04-05 17:37:21.926 ERROR:	return code = 1

2011-04-05 17:37:21.926 01558 Wait(10)

2011-04-05 17:37:21.926 Requirement: ODSCC40

2011-04-05 17:37:31.927 01560 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:37:31.927 Requirement: ODSCC40

2011-04-05 17:37:31.927 01562 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:37:31.927 Requirement: ODSCC40
2011-04-05 17:37:31.927 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:37:31.933 - runCommand: Process started, PID: 5090

2011-04-05 17:37:31.933 01564 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:37:31.933 Requirement: ODSCC40
2011-04-05 17:37:31.933 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:37:31.938 - runCommand: Process started, PID: 5092
2011-04-05 17:37:31.938 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:37:31.938 ERROR:	return code = 1

2011-04-05 17:37:31.938 01566 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:37:31.938 Requirement: ODSCC40

2011-04-05 17:37:31.939 01569 PurgeHSM()
2011-04-05 17:37:31.939 Requirement: ODSCC40
2011-04-05 17:37:31.939 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:37:32.559 - runCommand: Process started, PID: 5094
2011-04-05 17:37:32.559 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:37:32.559 OUTPUT:	4 keys found.
2011-04-05 17:37:32.559 OUTPUT:	
2011-04-05 17:37:32.559 OUTPUT:	Are you sure you want to remove ALL keys from repository SoftHSM ? (YES/NO) 
2011-04-05 17:37:32.559 OUTPUT:	Starting purge...
2011-04-05 17:37:32.559 OUTPUT:	Key remove successful: f7b2914400964c053dc7a3bc1b23a90c
2011-04-05 17:37:32.559 OUTPUT:	Key remove successful: c9419bdacfe6dbc4f76916539b259128
2011-04-05 17:37:32.560 OUTPUT:	Key remove successful: ffa7a96697910c588d30be586e433df6
2011-04-05 17:37:32.560 OUTPUT:	Key remove successful: 17bc52dac832433d07f675dfeb95c369
2011-04-05 17:37:32.560 OUTPUT:	Purge done.

2011-04-05 17:37:32.560 01571 Wait(10)

2011-04-05 17:37:32.560 Requirement: ODSCC40

2011-04-05 17:37:42.560 01573 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:37:42.560 Requirement: ODSCC40

2011-04-05 17:37:42.561 01576 LoadConfig()
2011-04-05 17:37:42.561 Requirement: ODSCC40
2011-04-05 17:37:42.561 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC40T10_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:37:42.574 - runCommand: Process started, PID: 5098

2011-04-05 17:37:42.575 01579 LoadConfig()
2011-04-05 17:37:42.575 Requirement: ODSCC40
2011-04-05 17:37:42.575 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:37:42.579 - runCommand: Process started, PID: 5099

2011-04-05 17:37:42.579 01581 Comment: Update all the configs.

2011-04-05 17:37:42.579 Requirement: ODSCC40

2011-04-05 17:37:42.580 01583 ODSSetup()
2011-04-05 17:37:42.580 Requirement: ODSCC40
2011-04-05 17:37:42.580 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:37:42.586 - runCommand: Process started, PID: 5100
2011-04-05 17:37:42.586 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] Error: database in config file does not match libksm
2011-04-05 17:37:42.586 ERROR:	MySQL database host set to: dnssec-db
2011-04-05 17:37:42.586 ERROR:	MySQL database port set to: 3000
2011-04-05 17:37:42.586 ERROR:	MySQL database schema set to: KASP
2011-04-05 17:37:42.586 ERROR:	MySQL database user set to: kaspuser
2011-04-05 17:37:42.586 ERROR:	MySQL database password set
2011-04-05 17:37:42.586 ERROR:	return code = 255

2011-04-05 17:37:42.586 01585 Wait(10)

2011-04-05 17:37:42.587 Requirement: ODSCC40

2011-04-05 17:37:52.587 01587 Comment: Start the ODS-Enforcer and ODS-Signer

2011-04-05 17:37:52.587 Requirement: ODSCC40

2011-04-05 17:37:52.587 01589 Start()
2011-04-05 17:37:52.587 Requirement: ODSCC40
2011-04-05 17:37:52.587 RunCommand(ods-control start)
2011-04-05 17:37:52.589 - runCommand: Background process started, PID: 5103
2011-04-05 17:37:57.620 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:37:57.632 - runCommand: Process started, PID: 5125
2011-04-05 17:37:57.632 ERROR:	return code = 1
2011-04-05 17:37:57.632 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:37:57.649 - runCommand: Process started, PID: 5130
2011-04-05 17:37:57.649 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:37:57.649 01591 Wait(10)

2011-04-05 17:37:57.649 Requirement: ODSCC40

2011-04-05 17:38:07.649 01593 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:38:07.649 Requirement: ODSCC40

2011-04-05 17:38:07.650 01595 Stop()
2011-04-05 17:38:07.650 Requirement: ODSCC40
2011-04-05 17:38:07.650 RunCommand(ods-control stop)
2011-04-05 17:38:07.656 - runCommand: Process started, PID: 5147
2011-04-05 17:38:07.656 OUTPUT:	Stopping enforcer...
2011-04-05 17:38:07.656 OUTPUT:	Cannot find PID file
2011-04-05 17:38:07.656 OUTPUT:	Stopping signer engine..
2011-04-05 17:38:07.657 OUTPUT:	Engine shut down.
2011-04-05 17:38:07.657 RunCommand(ps -e | grep enforcer)
2011-04-05 17:38:07.672 - runCommand: Process started, PID: 5151
2011-04-05 17:38:07.672 ERROR:	return code = 1
2011-04-05 17:38:07.672 RunCommand(ps -e | grep signer)
2011-04-05 17:38:07.688 - runCommand: Process started, PID: 5154
2011-04-05 17:38:07.688 ERROR:	return code = 1

2011-04-05 17:38:07.688 01598 CheckLog()
2011-04-05 17:38:07.688 Requirement: ODSCC40
2011-04-05 17:38:09.282 FAILED:	(Check for Like) - Expected: all done! hsm_close results: 1 Found: 

2011-04-05 17:38:09.283 01601 CheckLog()
2011-04-05 17:38:09.283 Requirement: ODSCC40
2011-04-05 17:38:10.875 FAILED:	(Check for Like) - Expected: cfgfile /etc/opendnssec/conf.xml has errors Found: 

2011-04-05 17:38:10.875 01604 CheckLog()
2011-04-05 17:38:10.875 Requirement: ODSCC40
2011-04-05 17:38:12.457 FAILED:	(Check for Like) - Expected: Could not start signer Found: 

-------------------------------------------------------------------------------
Testcase - ODSCC40T20: Use default port (1213) for database and configure a false port and check if enforcer fails to connect

2011-04-05 17:38:12.458 01612 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:38:12.458 Requirement: ODSCC40

2011-04-05 17:38:12.458 01614 Stop()
2011-04-05 17:38:12.458 Requirement: ODSCC40
2011-04-05 17:38:12.458 RunCommand(ods-control stop)
2011-04-05 17:38:12.463 - runCommand: Process started, PID: 5157
2011-04-05 17:38:12.463 OUTPUT:	Stopping enforcer...
2011-04-05 17:38:12.463 OUTPUT:	Cannot find PID file
2011-04-05 17:38:12.463 OUTPUT:	Stopping signer engine..
2011-04-05 17:38:12.463 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:38:12.463 ERROR:	return code = 1
2011-04-05 17:38:12.463 RunCommand(ps -e | grep enforcer)
2011-04-05 17:38:12.474 - runCommand: Process started, PID: 5160
2011-04-05 17:38:12.474 ERROR:	return code = 1
2011-04-05 17:38:12.474 RunCommand(ps -e | grep signer)
2011-04-05 17:38:12.486 - runCommand: Process started, PID: 5163
2011-04-05 17:38:12.486 ERROR:	return code = 1

2011-04-05 17:38:12.486 01616 Wait(10)

2011-04-05 17:38:12.486 Requirement: ODSCC40

2011-04-05 17:38:22.486 01618 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:38:22.486 Requirement: ODSCC40

2011-04-05 17:38:22.487 01620 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:38:22.487 Requirement: ODSCC40
2011-04-05 17:38:22.487 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:38:22.492 - runCommand: Process started, PID: 5166

2011-04-05 17:38:22.493 01622 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:38:22.493 Requirement: ODSCC40
2011-04-05 17:38:22.493 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:38:22.497 - runCommand: Process started, PID: 5168
2011-04-05 17:38:22.497 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:38:22.497 ERROR:	return code = 1

2011-04-05 17:38:22.497 01624 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:38:22.497 Requirement: ODSCC40

2011-04-05 17:38:22.497 01627 PurgeHSM()
2011-04-05 17:38:22.497 Requirement: ODSCC40
2011-04-05 17:38:22.497 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:38:22.507 - runCommand: Process started, PID: 5170
2011-04-05 17:38:22.508 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:38:22.508 OUTPUT:	0 keys found.
2011-04-05 17:38:22.508 ERROR:	return code = 255

2011-04-05 17:38:22.508 01629 Wait(10)

2011-04-05 17:38:22.508 Requirement: ODSCC40

2011-04-05 17:38:32.508 01631 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:38:32.508 Requirement: ODSCC40

2011-04-05 17:38:32.509 01634 LoadConfig()
2011-04-05 17:38:32.509 Requirement: ODSCC40
2011-04-05 17:38:32.509 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC40T20_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:38:32.514 - runCommand: Process started, PID: 5174

2011-04-05 17:38:32.514 01637 LoadConfig()
2011-04-05 17:38:32.514 Requirement: ODSCC40
2011-04-05 17:38:32.514 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:38:32.518 - runCommand: Process started, PID: 5175

2011-04-05 17:38:32.519 01639 Comment: Update all the configs.

2011-04-05 17:38:32.519 Requirement: ODSCC40

2011-04-05 17:38:32.519 01641 ODSSetup()
2011-04-05 17:38:32.519 Requirement: ODSCC40
2011-04-05 17:38:32.519 RunCommand(echo 'y' | ods-ksmutil setup)
2011-04-05 17:38:32.525 - runCommand: Process started, PID: 5176
2011-04-05 17:38:32.525 OUTPUT:	*WARNING* This will erase all data in the database; are you sure? [y/N] Error: database in config file does not match libksm
2011-04-05 17:38:32.525 ERROR:	MySQL database host set to: dnssec-db
2011-04-05 17:38:32.525 ERROR:	MySQL database port set to: 1213
2011-04-05 17:38:32.525 ERROR:	MySQL database schema set to: KASP
2011-04-05 17:38:32.525 ERROR:	MySQL database user set to: kaspuser
2011-04-05 17:38:32.525 ERROR:	MySQL database password set
2011-04-05 17:38:32.525 ERROR:	return code = 255

2011-04-05 17:38:32.526 01643 Wait(10)

2011-04-05 17:38:32.526 Requirement: ODSCC40

2011-04-05 17:38:42.526 01645 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:38:42.526 Requirement: ODSCC40

2011-04-05 17:38:42.527 01647 Stop()
2011-04-05 17:38:42.527 Requirement: ODSCC40
2011-04-05 17:38:42.527 RunCommand(ods-control stop)
2011-04-05 17:38:42.533 - runCommand: Process started, PID: 5179
2011-04-05 17:38:42.533 OUTPUT:	Stopping enforcer...
2011-04-05 17:38:42.533 OUTPUT:	Cannot find PID file
2011-04-05 17:38:42.533 OUTPUT:	Stopping signer engine..
2011-04-05 17:38:42.533 ERROR:	Unable to connect to engine: connect() failed: Connection refused
2011-04-05 17:38:42.533 ERROR:	return code = 1
2011-04-05 17:38:42.533 RunCommand(ps -e | grep enforcer)
2011-04-05 17:38:42.548 - runCommand: Process started, PID: 5182
2011-04-05 17:38:42.548 ERROR:	return code = 1
2011-04-05 17:38:42.548 RunCommand(ps -e | grep signer)
2011-04-05 17:38:42.558 - runCommand: Process started, PID: 5185
2011-04-05 17:38:42.558 ERROR:	return code = 1

2011-04-05 17:38:42.558 01649 Comment: all done! hsm_close results: 1

2011-04-05 17:38:42.558 Requirement: ODSCC40

2011-04-05 17:38:42.559 01651 Start()
2011-04-05 17:38:42.559 Requirement: ODSCC40
2011-04-05 17:38:42.559 RunCommand(ods-control start)
2011-04-05 17:38:42.560 - runCommand: Background process started, PID: 5188
2011-04-05 17:38:47.588 RunCommand(ps -e | awk '{print $4}' | grep -x ods-enforcerd)
2011-04-05 17:38:47.601 - runCommand: Process started, PID: 5210
2011-04-05 17:38:47.601 ERROR:	return code = 1
2011-04-05 17:38:47.601 RunCommand(ps -ef | grep signer | grep -v grep | awk '{print $8 " " $9}')
2011-04-05 17:38:47.618 - runCommand: Process started, PID: 5227
2011-04-05 17:38:47.618 OUTPUT:	/usr/local/sbin/ods-signerd -vvv

2011-04-05 17:38:47.619 01653 Wait(10)

2011-04-05 17:38:47.619 Requirement: ODSCC40

2011-04-05 17:38:57.619 01656 CheckLog()
2011-04-05 17:38:57.619 Requirement: ODSCC40
2011-04-05 17:38:59.215 FAILED:	(Check for Like) - Expected: element Datastore: Relax-NG validity error : Did not expect element Datastore there Found: 

2011-04-05 17:38:59.216 01659 CheckLog()
2011-04-05 17:38:59.216 Requirement: ODSCC40
2011-04-05 17:39:00.808 FAILED:	(Check for Like) - Expected: cfgfile /etc/opendnssec/conf.xml has errors Found: 

2011-04-05 17:39:00.809 01662 CheckLog()
2011-04-05 17:39:00.809 Requirement: ODSCC40
2011-04-05 17:39:02.401 FAILED:	(Check for Like) - Expected: Could not start signer Found: 

-------------------------------------------------------------------------------
Testcase - ODSCC40T30: Use a different port for both database and config and check if enforcer successfully connects

2011-04-05 17:39:02.402 01668 Comment: MySQL port is 3307 instead of 3306. Changed in config.xml and my.cnf

2011-04-05 17:39:02.402 Requirement: ODSCC40

2011-04-05 17:39:02.402 01669 Comment: Stop the ODS-Enforcer and ODS-Signer

2011-04-05 17:39:02.402 Requirement: ODSCC40

2011-04-05 17:39:02.402 01671 Stop()
2011-04-05 17:39:02.402 Requirement: ODSCC40
2011-04-05 17:39:02.402 RunCommand(ods-control stop)
2011-04-05 17:39:02.407 - runCommand: Process started, PID: 5232
2011-04-05 17:39:02.407 OUTPUT:	Stopping enforcer...
2011-04-05 17:39:02.407 OUTPUT:	Cannot find PID file
2011-04-05 17:39:02.407 OUTPUT:	Stopping signer engine..
2011-04-05 17:39:02.407 OUTPUT:	Engine shut down.
2011-04-05 17:39:02.407 RunCommand(ps -e | grep enforcer)
2011-04-05 17:39:02.417 - runCommand: Process started, PID: 5236
2011-04-05 17:39:02.417 ERROR:	return code = 1
2011-04-05 17:39:02.417 RunCommand(ps -e | grep signer)
2011-04-05 17:39:02.427 - runCommand: Process started, PID: 5239
2011-04-05 17:39:02.427 ERROR:	return code = 1

2011-04-05 17:39:02.427 01673 Wait(10)

2011-04-05 17:39:02.427 Requirement: ODSCC40

2011-04-05 17:39:12.428 01675 Comment: Clear the tmp and signed folder with the next 2 commands.

2011-04-05 17:39:12.428 Requirement: ODSCC40

2011-04-05 17:39:12.428 01677 ExecuteCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:39:12.428 Requirement: ODSCC40
2011-04-05 17:39:12.428 RunCommand(rm -r /var/opendnssec/tmp/*)
2011-04-05 17:39:12.434 - runCommand: Process started, PID: 5242

2011-04-05 17:39:12.434 01679 ExecuteCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:39:12.434 Requirement: ODSCC40
2011-04-05 17:39:12.434 RunCommand(rm -r  /var/opendnssec/signed/*)
2011-04-05 17:39:12.439 - runCommand: Process started, PID: 5244
2011-04-05 17:39:12.439 ERROR:	rm: cannot remove `/var/opendnssec/signed/*': No such file or directory
2011-04-05 17:39:12.439 ERROR:	return code = 1

2011-04-05 17:39:12.439 01681 Comment: Purge the keys in the SoftHSM repositories.

2011-04-05 17:39:12.439 Requirement: ODSCC40

2011-04-05 17:39:12.440 01684 PurgeHSM()
2011-04-05 17:39:12.440 Requirement: ODSCC40
2011-04-05 17:39:12.440 RunCommand(echo 'YES' | ods-hsmutil purge SoftHSM)
2011-04-05 17:39:12.454 - runCommand: Process started, PID: 5246
2011-04-05 17:39:12.454 OUTPUT:	Purging all keys from repository: SoftHSM
2011-04-05 17:39:12.454 OUTPUT:	0 keys found.
2011-04-05 17:39:12.454 ERROR:	return code = 255

2011-04-05 17:39:12.454 01686 Wait(10)

2011-04-05 17:39:12.454 Requirement: ODSCC40

2011-04-05 17:39:22.455 01688 Comment: Rebuild ODS with MySQL database instead of SQLlite

2011-04-05 17:39:22.455 Requirement: ODSCC40

2011-04-05 17:39:22.455 01690 ExecuteCommand(cd /home/elmo/Downloads/opendnssec-1.2.1)
2011-04-05 17:39:22.455 Requirement: ODSCC40
2011-04-05 17:39:22.455 RunCommand(cd /home/elmo/Downloads/opendnssec-1.2.1)
2011-04-05 17:39:22.461 - runCommand: Process started, PID: 5250
2011-04-05 17:39:22.461 ERROR:	open3: exec of cd /home/elmo/Downloads/opendnssec-1.2.1 failed at ActionWords.pm line 227
2011-04-05 17:39:22.461 ERROR:	return code = 255

2011-04-05 17:39:22.461 01692 ExecuteCommand(./configure --with-database-backend=mysql)
2011-04-05 17:39:22.461 Requirement: ODSCC40
2011-04-05 17:39:22.462 RunCommand(./configure --with-database-backend=mysql)
2011-04-05 17:39:22.466 - runCommand: Process started, PID: 5251
2011-04-05 17:39:22.466 ERROR:	open3: exec of ./configure --with-database-backend=mysql failed at ActionWords.pm line 227
2011-04-05 17:39:22.466 ERROR:	return code = 255

2011-04-05 17:39:22.467 01694 Wait(60)

2011-04-05 17:39:22.467 Requirement: ODSCC40

2011-04-05 17:40:22.467 01696 ExecuteCommand(make clean)
2011-04-05 17:40:22.467 Requirement: ODSCC40
2011-04-05 17:40:22.467 RunCommand(make clean)
2011-04-05 17:40:22.473 - runCommand: Process started, PID: 5254
2011-04-05 17:40:22.473 ERROR:	make: *** No rule to make target `clean'.  Stop.
2011-04-05 17:40:22.473 ERROR:	return code = 2

2011-04-05 17:40:22.473 01698 Wait(60)

2011-04-05 17:40:22.473 Requirement: ODSCC40

2011-04-05 17:41:22.474 01700 ExecuteCommand(make install)
2011-04-05 17:41:22.474 Requirement: ODSCC40
2011-04-05 17:41:22.474 RunCommand(make install)
2011-04-05 17:41:22.481 - runCommand: Process started, PID: 5255
2011-04-05 17:41:22.481 ERROR:	make: *** No rule to make target `install'.  Stop.
2011-04-05 17:41:22.481 ERROR:	return code = 2

2011-04-05 17:41:22.481 01702 Wait(60)

2011-04-05 17:41:22.481 Requirement: ODSCC40

2011-04-05 17:42:22.482 01704 Comment: After installation replace the original mysql config file with the adjusted one. Port is 3307 instead of the standard 3306 port.

2011-04-05 17:42:22.482 Requirement: ODSCC40

2011-04-05 17:42:22.482 01706 ExecuteCommand(cp /home/ods/ods_testautomation/ods_sit_conf/mysql/ODSCC40T30_my.cnf /etc/my.cnf)
2011-04-05 17:42:22.482 Requirement: ODSCC40
2011-04-05 17:42:22.482 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/mysql/ODSCC40T30_my.cnf /etc/my.cnf)
2011-04-05 17:42:22.497 - runCommand: Process started, PID: 5256

2011-04-05 17:42:22.498 01708 Comment: Update the mySQL configuration

2011-04-05 17:42:22.498 Requirement: ODSCC40

2011-04-05 17:42:22.498 01710 ExecuteCommand(restart mysql)
2011-04-05 17:42:22.498 Requirement: ODSCC40
2011-04-05 17:42:22.498 RunCommand(restart mysql)
2011-04-05 17:42:25.861 - runCommand: Process started, PID: 5257
2011-04-05 17:42:25.861 OUTPUT:	mysql start/running, process 5266

2011-04-05 17:42:25.861 01712 Wait(10)

2011-04-05 17:42:25.861 Requirement: ODSCC40

2011-04-05 17:42:35.861 01715 Comment: Change the configuration with predefined xml config files.

2011-04-05 17:42:35.861 Requirement: ODSCC40

2011-04-05 17:42:35.862 01718 LoadConfig()
2011-04-05 17:42:35.862 Requirement: ODSCC40
2011-04-05 17:42:35.862 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/conf/ODSCC40T30_conf.xml /etc/opendnssec/conf.xml)
2011-04-05 17:42:35.866 - runCommand: Process started, PID: 5334

2011-04-05 17:42:35.866 01721 LoadConfig()
2011-04-05 17:42:35.866 Requirement: ODSCC40
2011-04-05 17:42:35.866 RunCommand(cp /home/ods/ods_testautomation/ods_sit_conf/kasp/kasp.xml /etc/opendnssec/kasp.xml)
2011-04-05 17:42:35.869 - runCommand: Process started, PID: 5335

2011-04-05 17:42:35.869 01723 Comment: Run setup for rebuild of database

2011-04-05 17:42:35.869 Requirement: ODSCC40

2011-04-05 17:42:35.869 01725 ExecuteCommand(ods-ksmutil setup)
2011-04-05 17:42:35.869 Requirement: ODSCC40
2011-04-05 17:42:35.869 RunCommand(ods-ksmutil setup)


