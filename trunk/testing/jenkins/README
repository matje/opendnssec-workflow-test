Overview
========

Using these scripts you will be able to manage and build dependencies into
different installations paths so you can have multiple versions of software
on the same machine and do all kinds of tests.


Coding note!
============

All scripts are made to run in bash and may not work in other shell scripts
engines.

All variables containing paths must be quoted correctly because they made
contain spaces or other characters.

ex: source "$WORKSPACE/testing/jenkins/functions.jenkins"

If the project name or anything else that WORKSPACE is built upon this
would have failed if it was not quoted.


Files
=====

functions.jenkins         The main file with all the functions for the build
                          and test system.
                          
versions.jenkins          Version numbers, URL's and checksums for each package installed
                          
Checkout_<code>.jenkins   Checkout job for <code> which also triggers the 
                          Build_X.jenkins script.

Build_<program>.jenkins   Build file for <program>.

Util_<action>.jenkins     Utility script to perform <action>.

Test_<program>.jenkins    Test file for <program>.


Job names
=========

All jenkins jobs run a single script and are named identically to the files as
above. 


Environment variables
=====================

See https://jenkins.opendnssec.org/env-vars.html for jenkins built in
variables.

HOME             Jenkins home directory. 

WORKSPACE        The workspace for the currect jenkins project.

WORKSPACE_ROOT   This is the root directory of the jenkins workspace, used
                 building INSTALL_ROOT.

NODE_NAME        The node name where this script is running, can be used for
                 individual configurations.

SVN_REVISION     The svn revision of the checked out code that is being built,
                 is used to check if there is need to rebuild. On projects
                 with multiple repositories you will need to construct
                 SVN_REVISION yourself, jenkins sets SVN_REVISION_# per
                 defined repository.

INSTALL_TAG      Simple tag of the installation, used for building
                 INSTALL_ROOT.

INSTALL_ROOT     Path to the install root, template is
                 WORKSPACE_ROOT/root/INSTALL_TAG.


Script functions
================

init_build      Used for initializing environment for building.

init_test       Used for initializing environment for testing.

check_if_built <program>
                Checks if the program is built and if the build is the same
                revision as in SVN_REVISION.
                Returns non-zero if its not built or not same revision.

start_build <program>
                Tell the build system you are starting the build, this will
                handle control files so depended scripts can check if the
                build it ok.

set_build_ok <program>
                Tag the build for the program ok, will use SVN_REVISION as
                revision.

require <program>
                Check so that the program has been built ok and setup the
                required environment.

fetch_src <url> <filename> <sha256>
                Fetch the source at the url and check it against the sha256
                checksum. The url needs to be the full url to the file and the
                filename should be the filename.
                ex with a redirect script:
                fetch_src http://download.php?id=1 A-File.tgz <sha256>
                ex with a file:
                fetch_src http://A-File.tgz A-File.tgz <sha256>
