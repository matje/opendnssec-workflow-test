This code should work but is not fully tested

Introduction
------------
libksm (Key and Signature Manager) is an interface for programs that need access to the KASP database. It contains the logic for creating keys, allocating keys, calculating key rollover times etc.

Pre-requisites
--------------
1) Install MySQL or sqlite3 (MySql has been tested more, but both should work)
    If you are using MySQL then an empty schema needs to be created, plus a 
    user with full access to that schema (assuming that you don't want to use 
    the root account).

2) Install libxml2
(http://xmlsoft.org/)

3) If you wish to run the unit tests, install "CUnit"
(http://cunit.sourceforge.net).

Building the Software
---------------------
You can build it with ./auto-build.sh
Remember to edit auto-build.sh to have your paths to mysql/sqlite and cunit.

The following options can be passed to configure; auto-build.sh has some set, with an attempt to guess defaults based on the OS

--prefix=<dir>      Installation directory. All files will be installed
                    relative to this path.
--with-cunit=<dir>  Path to your CUNIT installation
--with-mysql=<dir>  Path to your MySQL instalation; this also selects MySQL 
                    as your database
--with-dbname=      Name of DB schema
--with-dbhost=      Machine where DB is hosted
--with-dbpass=      Password for DB access
--with-dbuser=      Username for DB access

Unit tests
----------
Unit tests can be run using make check. 

At present one assert fails (as a reminder that we need more tests in that section).


Database Schemas
----------------
The unit tests will setup the database according to the options given to configure. To manually setup the schema then run one of:

utils/database_create.mysql
or
utils/database_create.sqlite3


Kaspimport
----------
The perl script utils/kaspimport.pl is created with settings determined by your flags to configure. It has the job of reading the xml configuration files from:

${prefix}/etc

and using them to build the database specified at configure time. It takes the following flags:

 -h <HOST>      db host
 -u <USER>      db user
 -s <SCHEMA>    db schema
 -p <PASSWORD>  db password
 -d             debug mode
 -f <FILE>      sqlite3 filename
 -i             install DB flag

The 1st 4 refer to a MySQL database.

If the -i flag is provided then the existing schema will be torn down and a new one put in its place. Without it then the script will assume that the schema exists.
